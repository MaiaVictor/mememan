<html><body><script>
(function(e,t,n){function r(n,i){if(!t[n]){if(!e[n]){var s=typeof require=="function"&&require;if(!i&&s)return s(n,!0);throw new Error("Cannot find module '"+n+"'")}var o=t[n]={exports:{}};e[n][0](function(t){var i=e[n][1][t];return r(i?i:t)},o,o.exports)}return t[n].exports}for(var i=0;i<n.length;i++)r(n[i]);return r})({1:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],2:[function(require,module,exports){require=function(e,t,n,r){function i(r){if(!n[r]){if(!t[r]){if(e)return e(r);throw new Error("Cannot find module '"+r+"'")}var s=n[r]={exports:{}};t[r][0](function(e){var n=t[r][1][e];return i(n?n:e)},s,s.exports)}return n[r].exports}for(var s=0;s<r.length;s++)i(r[s]);return i}(typeof require!=="undefined"&&require,{1:[function(require,module,exports){exports.readIEEE754=function(buffer,offset,isBE,mLen,nBytes){var e,m,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isBE?0:nBytes-1,d=isBE?1:-1,s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.writeIEEE754=function(buffer,value,offset,isBE,mLen,nBytes){var e,m,c,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=isBE?nBytes-1:0,d=isBE?-1:1,s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],2:[function(require,module,exports){(function(){var util=require("util");var Buffer=require("buffer").Buffer;var pSlice=Array.prototype.slice;function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];for(var name in object){if(Object.prototype.hasOwnProperty.call(object,name)){result.push(name)}}return result}var assert=module.exports=ok;assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.message=options.message;this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}};util.inherits(assert.AssertionError,Error);function replacer(key,value){if(value===undefined){return""+value}if(typeof value==="number"&&(isNaN(value)||!isFinite(value))){return value.toString()}if(typeof value==="function"||value instanceof RegExp){return value.toString()}return value}function truncate(s,n){if(typeof s=="string"){return s.length<n?s:s.slice(0,n)}else{return s}}assert.AssertionError.prototype.toString=function(){if(this.message){return[this.name+":",this.message].join(" ")}else{return[this.name+":",truncate(JSON.stringify(this.actual,replacer),128),this.operator,truncate(JSON.stringify(this.expected,replacer),128)].join(" ")}};assert.AssertionError.__proto__=Error.prototype;function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}assert.fail=fail;function ok(value,message){if(!!!value)fail(value,true,message,"==",assert.ok)}assert.ok=ok;assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};function _deepEqual(actual,expected){if(actual===expected){return true}else if(Buffer.isBuffer(actual)&&Buffer.isBuffer(expected)){if(actual.length!=expected.length)return false;for(var i=0;i<actual.length;i++){if(actual[i]!==expected[i])return false}return true}else if(actual instanceof Date&&expected instanceof Date){return actual.getTime()===expected.getTime()}else if(typeof actual!="object"&&typeof expected!="object"){return actual==expected}else{return objEquiv(actual,expected)}}function isUndefinedOrNull(value){return value===null||value===undefined}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b){if(isUndefinedOrNull(a)||isUndefinedOrNull(b))return false;if(a.prototype!==b.prototype)return false;if(isArguments(a)){if(!isArguments(b)){return false}a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b)}try{var ka=objectKeys(a),kb=objectKeys(b),key,i}catch(e){return false}if(ka.length!=kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!=kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key]))return false}return true}assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return false}if(expected instanceof RegExp){return expected.test(actual)}else if(actual instanceof expected){return true}else if(expected.call({},actual)===true){return true}return false}function _throws(shouldThrow,block,expected,message){var actual;if(typeof expected==="string"){message=expected;expected=null}try{block()}catch(e){actual=e}message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:".");if(shouldThrow&&!actual){fail("Missing expected exception"+message)}if(!shouldThrow&&expectedException(actual,expected)){fail("Got unwanted exception"+message)}if(shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual){throw actual}}assert.throws=function(block,error,message){_throws.apply(this,[true].concat(pSlice.call(arguments)))};assert.doesNotThrow=function(block,error,message){_throws.apply(this,[false].concat(pSlice.call(arguments)))};assert.ifError=function(err){if(err){throw err}}})()},{util:3,buffer:4}],"buffer-browserify":[function(require,module,exports){module.exports=require("q9TxCC")},{}],q9TxCC:[function(require,module,exports){(function(){function SlowBuffer(size){this.length=size}var assert=require("assert");exports.INSPECT_MAX_BYTES=50;function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)if(str.charCodeAt(i)<=127)byteArray.push(str.charCodeAt(i));else{var h=encodeURIComponent(str.charAt(i)).substr(1).split("%");for(var j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)byteArray.push(str.charCodeAt(i)&255);return byteArray}function base64ToBytes(str){return require("base64-js").toByteArray(str)}SlowBuffer.byteLength=function(str,encoding){switch(encoding||"utf8"){case"hex":return str.length/2;case"utf8":case"utf-8":return utf8ToBytes(str).length;case"ascii":case"binary":return str.length;case"base64":return base64ToBytes(str).length;default:throw new Error("Unknown encoding")}};function blitBuffer(src,dst,offset,length){var pos,i=0;while(i<length){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i];i++}return i}SlowBuffer.prototype.utf8Write=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(utf8ToBytes(string),this,offset,length)};SlowBuffer.prototype.asciiWrite=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(asciiToBytes(string),this,offset,length)};SlowBuffer.prototype.binaryWrite=SlowBuffer.prototype.asciiWrite;SlowBuffer.prototype.base64Write=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(base64ToBytes(string),this,offset,length)};SlowBuffer.prototype.base64Slice=function(start,end){var bytes=Array.prototype.slice.apply(this,arguments);return require("base64-js").fromByteArray(bytes)};function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}SlowBuffer.prototype.utf8Slice=function(){var bytes=Array.prototype.slice.apply(this,arguments);var res="";var tmp="";var i=0;while(i<bytes.length){if(bytes[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(bytes[i]);tmp=""}else tmp+="%"+bytes[i].toString(16);i++}return res+decodeUtf8Char(tmp)};SlowBuffer.prototype.asciiSlice=function(){var bytes=Array.prototype.slice.apply(this,arguments);var ret="";for(var i=0;i<bytes.length;i++)ret+=String.fromCharCode(bytes[i]);return ret};SlowBuffer.prototype.binarySlice=SlowBuffer.prototype.asciiSlice;SlowBuffer.prototype.inspect=function(){var out=[],len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this[i]);if(i==exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<SlowBuffer "+out.join(" ")+">"};SlowBuffer.prototype.hexSlice=function(start,end){var len=this.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(this[i])}return out};SlowBuffer.prototype.toString=function(encoding,start,end){encoding=String(encoding||"utf8").toLowerCase();start=+start||0;if(typeof end=="undefined")end=this.length;if(+end==start){return""}switch(encoding){case"hex":return this.hexSlice(start,end);case"utf8":case"utf-8":return this.utf8Slice(start,end);case"ascii":return this.asciiSlice(start,end);case"binary":return this.binarySlice(start,end);case"base64":return this.base64Slice(start,end);case"ucs2":case"ucs-2":return this.ucs2Slice(start,end);default:throw new Error("Unknown encoding")}};SlowBuffer.prototype.hexWrite=function(string,offset,length){offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2){throw new Error("Invalid hex string")}if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);if(isNaN(byte))throw new Error("Invalid hex string");this[offset+i]=byte}SlowBuffer._charsWritten=i*2;return i};SlowBuffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();switch(encoding){case"hex":return this.hexWrite(string,offset,length);case"utf8":case"utf-8":return this.utf8Write(string,offset,length);case"ascii":return this.asciiWrite(string,offset,length);case"binary":return this.binaryWrite(string,offset,length);case"base64":return this.base64Write(string,offset,length);case"ucs2":case"ucs-2":return this.ucs2Write(string,offset,length);default:throw new Error("Unknown encoding")}};SlowBuffer.prototype.slice=function(start,end){if(end===undefined)end=this.length;if(end>this.length){throw new Error("oob")}if(start>end){throw new Error("oob")}return new Buffer(this,end-start,+start)};SlowBuffer.prototype.copy=function(target,targetstart,sourcestart,sourceend){var temp=[];for(var i=sourcestart;i<sourceend;i++){assert.ok(typeof this[i]!=="undefined","copying undefined buffer bytes!");temp.push(this[i])}for(var i=targetstart;i<targetstart+temp.length;i++){target[i]=temp[i-targetstart]}};SlowBuffer.prototype.fill=function(value,start,end){if(end>this.length){throw new Error("oob")}if(start>end){throw new Error("oob")}for(var i=start;i<end;i++){this[i]=value}};function coerce(length){length=~~Math.ceil(+length);return length<0?0:length}function Buffer(subject,encoding,offset){if(!(this instanceof Buffer)){return new Buffer(subject,encoding,offset)}var type;if(typeof offset==="number"){this.length=coerce(encoding);this.parent=subject;this.offset=offset}else{switch(type=typeof subject){case"number":this.length=coerce(subject);break;case"string":this.length=Buffer.byteLength(subject,encoding);break;case"object":this.length=coerce(subject.length);break;default:throw new Error("First argument needs to be a number, "+"array or string.")}if(this.length>Buffer.poolSize){this.parent=new SlowBuffer(this.length);this.offset=0}else{if(!pool||pool.length-pool.used<this.length)allocPool();this.parent=pool;this.offset=pool.used;pool.used+=this.length}if(isArrayIsh(subject)){for(var i=0;i<this.length;i++){if(subject instanceof Buffer){this.parent[i+this.offset]=subject.readUInt8(i)}else{this.parent[i+this.offset]=subject[i]}}}else if(type=="string"){this.length=this.write(subject,0,encoding)}}}function isArrayIsh(subject){return Array.isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}exports.SlowBuffer=SlowBuffer;exports.Buffer=Buffer;Buffer.poolSize=8*1024;var pool;function allocPool(){pool=new SlowBuffer(Buffer.poolSize);pool.used=0}Buffer.isBuffer=function isBuffer(b){return b instanceof Buffer||b instanceof SlowBuffer};Buffer.concat=function(list,totalLength){if(!Array.isArray(list)){throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.")}if(list.length===0){return new Buffer(0)}else if(list.length===1){return list[0]}if(typeof totalLength!=="number"){totalLength=0;for(var i=0;i<list.length;i++){var buf=list[i];totalLength+=buf.length}}var buffer=new Buffer(totalLength);var pos=0;for(var i=0;i<list.length;i++){var buf=list[i];buf.copy(buffer,pos);pos+=buf.length}return buffer};Buffer.prototype.inspect=function inspect(){var out=[],len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this.parent[i+this.offset]);if(i==exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<Buffer "+out.join(" ")+">"};Buffer.prototype.get=function get(i){if(i<0||i>=this.length)throw new Error("oob");return this.parent[this.offset+i]};Buffer.prototype.set=function set(i,v){if(i<0||i>=this.length)throw new Error("oob");return this.parent[this.offset+i]=v};Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=this.parent.hexWrite(string,this.offset+offset,length);break;case"utf8":case"utf-8":ret=this.parent.utf8Write(string,this.offset+offset,length);break;case"ascii":ret=this.parent.asciiWrite(string,this.offset+offset,length);break;case"binary":ret=this.parent.binaryWrite(string,this.offset+offset,length);break;case"base64":ret=this.parent.base64Write(string,this.offset+offset,length);break;case"ucs2":case"ucs-2":ret=this.parent.ucs2Write(string,this.offset+offset,length);break;default:throw new Error("Unknown encoding")}Buffer._charsWritten=SlowBuffer._charsWritten;return ret};Buffer.prototype.toString=function(encoding,start,end){encoding=String(encoding||"utf8").toLowerCase();if(typeof start=="undefined"||start<0){start=0}else if(start>this.length){start=this.length}if(typeof end=="undefined"||end>this.length){end=this.length}else if(end<0){end=0}start=start+this.offset;end=end+this.offset;switch(encoding){case"hex":return this.parent.hexSlice(start,end);case"utf8":case"utf-8":return this.parent.utf8Slice(start,end);case"ascii":return this.parent.asciiSlice(start,end);case"binary":return this.parent.binarySlice(start,end);case"base64":return this.parent.base64Slice(start,end);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(start,end);default:throw new Error("Unknown encoding")}};Buffer.byteLength=SlowBuffer.byteLength;Buffer.prototype.fill=function fill(value,start,end){value||(value=0);start||(start=0);end||(end=this.length);if(typeof value==="string"){value=value.charCodeAt(0)}if(!(typeof value==="number")||isNaN(value)){throw new Error("value is not a number")}if(end<start)throw new Error("end < start");if(end===start)return 0;if(this.length==0)return 0;if(start<0||start>=this.length){throw new Error("start out of bounds")}if(end<0||end>this.length){throw new Error("end out of bounds")}return this.parent.fill(value,start+this.offset,end+this.offset)};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;start||(start=0);end||(end=this.length);target_start||(target_start=0);if(end<start)throw new Error("sourceEnd < sourceStart");if(end===start)return 0;if(target.length==0||source.length==0)return 0;if(target_start<0||target_start>=target.length){throw new Error("targetStart out of bounds")}if(start<0||start>=source.length){throw new Error("sourceStart out of bounds")}if(end<0||end>source.length){throw new Error("sourceEnd out of bounds")}if(end>this.length){end=this.length}if(target.length-target_start<end-start){end=target.length-target_start+start}return this.parent.copy(target.parent,target_start+target.offset,start+this.offset,end+this.offset)};Buffer.prototype.slice=function(start,end){if(end===undefined)end=this.length;if(end>this.length)throw new Error("oob");if(start>end)throw new Error("oob");return new Buffer(this.parent,end-start,+start+this.offset)};Buffer.prototype.utf8Slice=function(start,end){return this.toString("utf8",start,end)};Buffer.prototype.binarySlice=function(start,end){return this.toString("binary",start,end)};Buffer.prototype.asciiSlice=function(start,end){return this.toString("ascii",start,end)};Buffer.prototype.utf8Write=function(string,offset){return this.write(string,offset,"utf8")};Buffer.prototype.binaryWrite=function(string,offset){return this.write(string,offset,"binary")};Buffer.prototype.asciiWrite=function(string,offset){return this.write(string,offset,"ascii")};Buffer.prototype.readUInt8=function(offset,noAssert){var buffer=this;if(!noAssert){assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to read beyond buffer length")}if(offset>=buffer.length)return;return buffer.parent[buffer.offset+offset]};function readUInt16(buffer,offset,isBigEndian,noAssert){var val=0;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to read beyond buffer length")}if(offset>=buffer.length)return 0;if(isBigEndian){val=buffer.parent[buffer.offset+offset]<<8;if(offset+1<buffer.length){val|=buffer.parent[buffer.offset+offset+1]}}else{val=buffer.parent[buffer.offset+offset];if(offset+1<buffer.length){val|=buffer.parent[buffer.offset+offset+1]<<8}}return val}Buffer.prototype.readUInt16LE=function(offset,noAssert){return readUInt16(this,offset,false,noAssert)};Buffer.prototype.readUInt16BE=function(offset,noAssert){return readUInt16(this,offset,true,noAssert)};function readUInt32(buffer,offset,isBigEndian,noAssert){var val=0;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}if(offset>=buffer.length)return 0;if(isBigEndian){if(offset+1<buffer.length)val=buffer.parent[buffer.offset+offset+1]<<16;if(offset+2<buffer.length)val|=buffer.parent[buffer.offset+offset+2]<<8;if(offset+3<buffer.length)val|=buffer.parent[buffer.offset+offset+3];val=val+(buffer.parent[buffer.offset+offset]<<24>>>0)}else{if(offset+2<buffer.length)val=buffer.parent[buffer.offset+offset+2]<<16;if(offset+1<buffer.length)val|=buffer.parent[buffer.offset+offset+1]<<8;val|=buffer.parent[buffer.offset+offset];if(offset+3<buffer.length)val=val+(buffer.parent[buffer.offset+offset+3]<<24>>>0)}return val}Buffer.prototype.readUInt32LE=function(offset,noAssert){return readUInt32(this,offset,false,noAssert)};Buffer.prototype.readUInt32BE=function(offset,noAssert){return readUInt32(this,offset,true,noAssert)};Buffer.prototype.readInt8=function(offset,noAssert){var buffer=this;var neg;if(!noAssert){assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to read beyond buffer length")}if(offset>=buffer.length)return;neg=buffer.parent[buffer.offset+offset]&128;if(!neg){return buffer.parent[buffer.offset+offset]}return(255-buffer.parent[buffer.offset+offset]+1)*-1};function readInt16(buffer,offset,isBigEndian,noAssert){var neg,val;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to read beyond buffer length")}val=readUInt16(buffer,offset,isBigEndian,noAssert);neg=val&32768;if(!neg){return val}return(65535-val+1)*-1}Buffer.prototype.readInt16LE=function(offset,noAssert){return readInt16(this,offset,false,noAssert)};Buffer.prototype.readInt16BE=function(offset,noAssert){return readInt16(this,offset,true,noAssert)};function readInt32(buffer,offset,isBigEndian,noAssert){var neg,val;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}val=readUInt32(buffer,offset,isBigEndian,noAssert);neg=val&2147483648;if(!neg){return val}return(4294967295-val+1)*-1}Buffer.prototype.readInt32LE=function(offset,noAssert){return readInt32(this,offset,false,noAssert)};Buffer.prototype.readInt32BE=function(offset,noAssert){return readInt32(this,offset,true,noAssert)};function readFloat(buffer,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}return require("./buffer_ieee754").readIEEE754(buffer,offset,isBigEndian,23,4)}Buffer.prototype.readFloatLE=function(offset,noAssert){return readFloat(this,offset,false,noAssert)};Buffer.prototype.readFloatBE=function(offset,noAssert){return readFloat(this,offset,true,noAssert)};function readDouble(buffer,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset+7<buffer.length,"Trying to read beyond buffer length")}return require("./buffer_ieee754").readIEEE754(buffer,offset,isBigEndian,52,8)}Buffer.prototype.readDoubleLE=function(offset,noAssert){return readDouble(this,offset,false,noAssert)};Buffer.prototype.readDoubleBE=function(offset,noAssert){return readDouble(this,offset,true,noAssert)};function verifuint(value,max){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value>=0,"specified a negative value for writing an unsigned value");assert.ok(value<=max,"value is larger than maximum value for type");assert.ok(Math.floor(value)===value,"value has a fractional component")}Buffer.prototype.writeUInt8=function(value,offset,noAssert){var buffer=this;if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"trying to write beyond buffer length");verifuint(value,255)}if(offset<buffer.length){buffer.parent[buffer.offset+offset]=value}};function writeUInt16(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"trying to write beyond buffer length");verifuint(value,65535)}for(var i=0;i<Math.min(buffer.length-offset,2);i++){buffer.parent[buffer.offset+offset+i]=(value&255<<8*(isBigEndian?1-i:i))>>>(isBigEndian?1-i:i)*8}}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){writeUInt16(this,value,offset,false,noAssert)};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){writeUInt16(this,value,offset,true,noAssert)};function writeUInt32(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"trying to write beyond buffer length");verifuint(value,4294967295)}for(var i=0;i<Math.min(buffer.length-offset,4);i++){buffer.parent[buffer.offset+offset+i]=value>>>(isBigEndian?3-i:i)*8&255}}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){writeUInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){writeUInt32(this,value,offset,true,noAssert)};function verifsint(value,max,min){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value<=max,"value larger than maximum allowed value");assert.ok(value>=min,"value smaller than minimum allowed value");assert.ok(Math.floor(value)===value,"value has a fractional component")}function verifIEEE754(value,max,min){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value<=max,"value larger than maximum allowed value");assert.ok(value>=min,"value smaller than minimum allowed value")}Buffer.prototype.writeInt8=function(value,offset,noAssert){var buffer=this;if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to write beyond buffer length");verifsint(value,127,-128)}if(value>=0){buffer.writeUInt8(value,offset,noAssert)}else{buffer.writeUInt8(255+value+1,offset,noAssert)}};function writeInt16(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to write beyond buffer length");verifsint(value,32767,-32768)}if(value>=0){writeUInt16(buffer,value,offset,isBigEndian,noAssert)}else{writeUInt16(buffer,65535+value+1,offset,isBigEndian,noAssert)}}Buffer.prototype.writeInt16LE=function(value,offset,noAssert){writeInt16(this,value,offset,false,noAssert)};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){writeInt16(this,value,offset,true,noAssert)};function writeInt32(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to write beyond buffer length");verifsint(value,2147483647,-2147483648)}if(value>=0){writeUInt32(buffer,value,offset,isBigEndian,noAssert)}else{writeUInt32(buffer,4294967295+value+1,offset,isBigEndian,noAssert)}}Buffer.prototype.writeInt32LE=function(value,offset,noAssert){writeInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){writeInt32(this,value,offset,true,noAssert)};function writeFloat(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to write beyond buffer length");verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38)}require("./buffer_ieee754").writeIEEE754(buffer,value,offset,isBigEndian,23,4)}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){writeFloat(this,value,offset,false,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){writeFloat(this,value,offset,true,noAssert)};function writeDouble(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+7<buffer.length,"Trying to write beyond buffer length");verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308)}require("./buffer_ieee754").writeIEEE754(buffer,value,offset,isBigEndian,52,8)}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){writeDouble(this,value,offset,true,noAssert)};SlowBuffer.prototype.readUInt8=Buffer.prototype.readUInt8;SlowBuffer.prototype.readUInt16LE=Buffer.prototype.readUInt16LE;SlowBuffer.prototype.readUInt16BE=Buffer.prototype.readUInt16BE;SlowBuffer.prototype.readUInt32LE=Buffer.prototype.readUInt32LE;SlowBuffer.prototype.readUInt32BE=Buffer.prototype.readUInt32BE;SlowBuffer.prototype.readInt8=Buffer.prototype.readInt8;SlowBuffer.prototype.readInt16LE=Buffer.prototype.readInt16LE;SlowBuffer.prototype.readInt16BE=Buffer.prototype.readInt16BE;SlowBuffer.prototype.readInt32LE=Buffer.prototype.readInt32LE;SlowBuffer.prototype.readInt32BE=Buffer.prototype.readInt32BE;SlowBuffer.prototype.readFloatLE=Buffer.prototype.readFloatLE;SlowBuffer.prototype.readFloatBE=Buffer.prototype.readFloatBE;SlowBuffer.prototype.readDoubleLE=Buffer.prototype.readDoubleLE;SlowBuffer.prototype.readDoubleBE=Buffer.prototype.readDoubleBE;SlowBuffer.prototype.writeUInt8=Buffer.prototype.writeUInt8;SlowBuffer.prototype.writeUInt16LE=Buffer.prototype.writeUInt16LE;SlowBuffer.prototype.writeUInt16BE=Buffer.prototype.writeUInt16BE;SlowBuffer.prototype.writeUInt32LE=Buffer.prototype.writeUInt32LE;SlowBuffer.prototype.writeUInt32BE=Buffer.prototype.writeUInt32BE;SlowBuffer.prototype.writeInt8=Buffer.prototype.writeInt8;SlowBuffer.prototype.writeInt16LE=Buffer.prototype.writeInt16LE;SlowBuffer.prototype.writeInt16BE=Buffer.prototype.writeInt16BE;SlowBuffer.prototype.writeInt32LE=Buffer.prototype.writeInt32LE;SlowBuffer.prototype.writeInt32BE=Buffer.prototype.writeInt32BE;SlowBuffer.prototype.writeFloatLE=Buffer.prototype.writeFloatLE;SlowBuffer.prototype.writeFloatBE=Buffer.prototype.writeFloatBE;SlowBuffer.prototype.writeDoubleLE=Buffer.prototype.writeDoubleLE;SlowBuffer.prototype.writeDoubleBE=Buffer.prototype.writeDoubleBE
})()},{assert:2,"./buffer_ieee754":1,"base64-js":5}],3:[function(require,module,exports){var events=require("events");exports.isArray=isArray;exports.isDate=function(obj){return Object.prototype.toString.call(obj)==="[object Date]"};exports.isRegExp=function(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};exports.print=function(){};exports.puts=function(){};exports.debug=function(){};exports.inspect=function(obj,showHidden,depth,colors){var seen=[];var stylize=function(str,styleType){var styles={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};var style={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[styleType];if(style){return"["+styles[style][0]+"m"+str+"["+styles[style][1]+"m"}else{return str}};if(!colors){stylize=function(str,styleType){return str}}function format(value,recurseTimes){if(value&&typeof value.inspect==="function"&&value!==exports&&!(value.constructor&&value.constructor.prototype===value)){return value.inspect(recurseTimes)}switch(typeof value){case"undefined":return stylize("undefined","undefined");case"string":var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return stylize(simple,"string");case"number":return stylize(""+value,"number");case"boolean":return stylize(""+value,"boolean")}if(value===null){return stylize("null","null")}var visible_keys=Object_keys(value);var keys=showHidden?Object_getOwnPropertyNames(value):visible_keys;if(typeof value==="function"&&keys.length===0){if(isRegExp(value)){return stylize(""+value,"regexp")}else{var name=value.name?": "+value.name:"";return stylize("[Function"+name+"]","special")}}if(isDate(value)&&keys.length===0){return stylize(value.toUTCString(),"date")}var base,type,braces;if(isArray(value)){type="Array";braces=["[","]"]}else{type="Object";braces=["{","}"]}if(typeof value==="function"){var n=value.name?": "+value.name:"";base=isRegExp(value)?" "+value:" [Function"+n+"]"}else{base=""}if(isDate(value)){base=" "+value.toUTCString()}if(keys.length===0){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return stylize(""+value,"regexp")}else{return stylize("[Object]","special")}}seen.push(value);var output=keys.map(function(key){var name,str;if(value.__lookupGetter__){if(value.__lookupGetter__(key)){if(value.__lookupSetter__(key)){str=stylize("[Getter/Setter]","special")}else{str=stylize("[Getter]","special")}}else{if(value.__lookupSetter__(key)){str=stylize("[Setter]","special")}}}if(visible_keys.indexOf(key)<0){name="["+key+"]"}if(!str){if(seen.indexOf(value[key])<0){if(recurseTimes===null){str=format(value[key])}else{str=format(value[key],recurseTimes-1)}if(str.indexOf("\n")>-1){if(isArray(value)){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=stylize("[Circular]","special")}}if(typeof name==="undefined"){if(type==="Array"&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=stylize(name,"string")}}return name+": "+str});seen.pop();var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.length+1},0);if(length>50){output=braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}else{output=braces[0]+base+" "+output.join(", ")+" "+braces[1]}return output}return format(obj,typeof depth==="undefined"?2:depth)};function isArray(ar){return ar instanceof Array||Array.isArray(ar)||ar&&ar!==Object.prototype&&isArray(ar.__proto__)}function isRegExp(re){return re instanceof RegExp||typeof re==="object"&&Object.prototype.toString.call(re)==="[object RegExp]"}function isDate(d){if(d instanceof Date)return true;if(typeof d!=="object")return false;var properties=Date.prototype&&Object_getOwnPropertyNames(Date.prototype);var proto=d.__proto__&&Object_getOwnPropertyNames(d.__proto__);return JSON.stringify(proto)===JSON.stringify(properties)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(msg){};exports.pump=null;var Object_keys=Object.keys||function(obj){var res=[];for(var key in obj)res.push(key);return res};var Object_getOwnPropertyNames=Object.getOwnPropertyNames||function(obj){var res=[];for(var key in obj){if(Object.hasOwnProperty.call(obj,key))res.push(key)}return res};var Object_create=Object.create||function(prototype,properties){var object;if(prototype===null){object={__proto__:null}}else{if(typeof prototype!=="object"){throw new TypeError("typeof prototype["+typeof prototype+"] != 'object'")}var Type=function(){};Type.prototype=prototype;object=new Type;object.__proto__=prototype}if(typeof properties!=="undefined"&&Object.defineProperties){Object.defineProperties(object,properties)}return object};exports.inherits=function(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object_create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})};var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(typeof f!=="string"){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(exports.inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":return JSON.stringify(args[i++]);default:return x}});for(var x=args[i];i<len;x=args[++i]){if(x===null||typeof x!=="object"){str+=" "+x}else{str+=" "+exports.inspect(x)}}return str}},{events:6}],5:[function(require,module,exports){(function(exports){"use strict";var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw"Invalid string. Length must be a multiple of 4"}placeHolders=b64.indexOf("=");placeHolders=placeHolders>0?b64.length-placeHolders:0;arr=[];l=placeHolders>0?b64.length-4:b64.length;for(i=0,j=0;i<l;i+=4,j+=3){tmp=lookup.indexOf(b64[i])<<18|lookup.indexOf(b64[i+1])<<12|lookup.indexOf(b64[i+2])<<6|lookup.indexOf(b64[i+3]);arr.push((tmp&16711680)>>16);arr.push((tmp&65280)>>8);arr.push(tmp&255)}if(placeHolders===2){tmp=lookup.indexOf(b64[i])<<2|lookup.indexOf(b64[i+1])>>4;arr.push(tmp&255)}else if(placeHolders===1){tmp=lookup.indexOf(b64[i])<<10|lookup.indexOf(b64[i+1])<<4|lookup.indexOf(b64[i+2])>>2;arr.push(tmp>>8&255);arr.push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=lookup[temp>>2];output+=lookup[temp<<4&63];output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=lookup[temp>>10];output+=lookup[temp>>4&63];output+=lookup[temp<<2&63];output+="=";break}return output}module.exports.toByteArray=b64ToByteArray;module.exports.fromByteArray=uint8ToBase64})()},{}],7:[function(require,module,exports){exports.readIEEE754=function(buffer,offset,isBE,mLen,nBytes){var e,m,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isBE?0:nBytes-1,d=isBE?1:-1,s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.writeIEEE754=function(buffer,value,offset,isBE,mLen,nBytes){var e,m,c,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=isBE?nBytes-1:0,d=isBE?-1:1,s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],8:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],6:[function(require,module,exports){(function(process){if(!process.EventEmitter)process.EventEmitter=function(){};var EventEmitter=exports.EventEmitter=process.EventEmitter;var isArray=typeof Array.isArray==="function"?Array.isArray:function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function indexOf(xs,x){if(xs.indexOf)return xs.indexOf(x);for(var i=0;i<xs.length;i++){if(x===xs[i])return i}return-1}var defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!this._events)this._events={};this._events.maxListeners=n};EventEmitter.prototype.emit=function(type){if(type==="error"){if(!this._events||!this._events.error||isArray(this._events.error)&&!this._events.error.length){if(arguments[1]instanceof Error){throw arguments[1]}else{throw new Error("Uncaught, unspecified 'error' event.")}return false}}if(!this._events)return false;var handler=this._events[type];if(!handler)return false;if(typeof handler=="function"){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:var args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}return true}else if(isArray(handler)){var args=Array.prototype.slice.call(arguments,1);var listeners=handler.slice();for(var i=0,l=listeners.length;i<l;i++){listeners[i].apply(this,args)}return true}else{return false}};EventEmitter.prototype.addListener=function(type,listener){if("function"!==typeof listener){throw new Error("addListener only takes instances of Function")}if(!this._events)this._events={};this.emit("newListener",type,listener);if(!this._events[type]){this._events[type]=listener}else if(isArray(this._events[type])){if(!this._events[type].warned){var m;if(this._events.maxListeners!==undefined){m=this._events.maxListeners}else{m=defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);console.trace()}}this._events[type].push(listener)}else{this._events[type]=[this._events[type],listener]}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){var self=this;self.on(type,function g(){self.removeListener(type,g);listener.apply(this,arguments)});return this};EventEmitter.prototype.removeListener=function(type,listener){if("function"!==typeof listener){throw new Error("removeListener only takes instances of Function")}if(!this._events||!this._events[type])return this;var list=this._events[type];if(isArray(list)){var i=indexOf(list,listener);if(i<0)return this;list.splice(i,1);if(list.length==0)delete this._events[type]}else if(this._events[type]===listener){delete this._events[type]}return this};EventEmitter.prototype.removeAllListeners=function(type){if(arguments.length===0){this._events={};return this}if(type&&this._events&&this._events[type])this._events[type]=null;return this};EventEmitter.prototype.listeners=function(type){if(!this._events)this._events={};if(!this._events[type])this._events[type]=[];if(!isArray(this._events[type])){this._events[type]=[this._events[type]]}return this._events[type]}})(require("__browserify_process"))},{__browserify_process:8}],4:[function(require,module,exports){(function(){function SlowBuffer(size){this.length=size}var assert=require("assert");exports.INSPECT_MAX_BYTES=50;function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)if(str.charCodeAt(i)<=127)byteArray.push(str.charCodeAt(i));else{var h=encodeURIComponent(str.charAt(i)).substr(1).split("%");for(var j=0;j<h.length;j++)byteArray.push(parseInt(h[j],16))}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)byteArray.push(str.charCodeAt(i)&255);return byteArray}function base64ToBytes(str){return require("base64-js").toByteArray(str)}SlowBuffer.byteLength=function(str,encoding){switch(encoding||"utf8"){case"hex":return str.length/2;case"utf8":case"utf-8":return utf8ToBytes(str).length;case"ascii":return str.length;case"base64":return base64ToBytes(str).length;default:throw new Error("Unknown encoding")}};function blitBuffer(src,dst,offset,length){var pos,i=0;while(i<length){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i];i++}return i}SlowBuffer.prototype.utf8Write=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(utf8ToBytes(string),this,offset,length)};SlowBuffer.prototype.asciiWrite=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(asciiToBytes(string),this,offset,length)};SlowBuffer.prototype.base64Write=function(string,offset,length){var bytes,pos;return SlowBuffer._charsWritten=blitBuffer(base64ToBytes(string),this,offset,length)};SlowBuffer.prototype.base64Slice=function(start,end){var bytes=Array.prototype.slice.apply(this,arguments);return require("base64-js").fromByteArray(bytes)};function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}SlowBuffer.prototype.utf8Slice=function(){var bytes=Array.prototype.slice.apply(this,arguments);var res="";var tmp="";var i=0;while(i<bytes.length){if(bytes[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(bytes[i]);tmp=""}else tmp+="%"+bytes[i].toString(16);i++}return res+decodeUtf8Char(tmp)};SlowBuffer.prototype.asciiSlice=function(){var bytes=Array.prototype.slice.apply(this,arguments);var ret="";for(var i=0;i<bytes.length;i++)ret+=String.fromCharCode(bytes[i]);return ret};SlowBuffer.prototype.inspect=function(){var out=[],len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this[i]);if(i==exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<SlowBuffer "+out.join(" ")+">"};SlowBuffer.prototype.hexSlice=function(start,end){var len=this.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(this[i])}return out};SlowBuffer.prototype.toString=function(encoding,start,end){encoding=String(encoding||"utf8").toLowerCase();start=+start||0;if(typeof end=="undefined")end=this.length;if(+end==start){return""}switch(encoding){case"hex":return this.hexSlice(start,end);case"utf8":case"utf-8":return this.utf8Slice(start,end);case"ascii":return this.asciiSlice(start,end);case"binary":return this.binarySlice(start,end);case"base64":return this.base64Slice(start,end);case"ucs2":case"ucs-2":return this.ucs2Slice(start,end);default:throw new Error("Unknown encoding")}};SlowBuffer.prototype.hexWrite=function(string,offset,length){offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2){throw new Error("Invalid hex string")}if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);if(isNaN(byte))throw new Error("Invalid hex string");this[offset+i]=byte}SlowBuffer._charsWritten=i*2;return i};SlowBuffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();switch(encoding){case"hex":return this.hexWrite(string,offset,length);case"utf8":case"utf-8":return this.utf8Write(string,offset,length);case"ascii":return this.asciiWrite(string,offset,length);case"binary":return this.binaryWrite(string,offset,length);case"base64":return this.base64Write(string,offset,length);case"ucs2":case"ucs-2":return this.ucs2Write(string,offset,length);default:throw new Error("Unknown encoding")}};SlowBuffer.prototype.slice=function(start,end){if(end===undefined)end=this.length;if(end>this.length){throw new Error("oob")}if(start>end){throw new Error("oob")}return new Buffer(this,end-start,+start)};SlowBuffer.prototype.copy=function(target,targetstart,sourcestart,sourceend){var temp=[];for(var i=sourcestart;i<sourceend;i++){assert.ok(typeof this[i]!=="undefined","copying undefined buffer bytes!");temp.push(this[i])}for(var i=targetstart;i<targetstart+temp.length;i++){target[i]=temp[i-targetstart]}};function coerce(length){length=~~Math.ceil(+length);return length<0?0:length}function Buffer(subject,encoding,offset){if(!(this instanceof Buffer)){return new Buffer(subject,encoding,offset)}var type;if(typeof offset==="number"){this.length=coerce(encoding);this.parent=subject;this.offset=offset}else{switch(type=typeof subject){case"number":this.length=coerce(subject);break;case"string":this.length=Buffer.byteLength(subject,encoding);break;case"object":this.length=coerce(subject.length);break;default:throw new Error("First argument needs to be a number, "+"array or string.")}if(this.length>Buffer.poolSize){this.parent=new SlowBuffer(this.length);this.offset=0}else{if(!pool||pool.length-pool.used<this.length)allocPool();this.parent=pool;this.offset=pool.used;pool.used+=this.length}if(isArrayIsh(subject)){for(var i=0;i<this.length;i++){this.parent[i+this.offset]=subject[i]}}else if(type=="string"){this.length=this.write(subject,0,encoding)}}}function isArrayIsh(subject){return Array.isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}exports.SlowBuffer=SlowBuffer;exports.Buffer=Buffer;Buffer.poolSize=8*1024;var pool;function allocPool(){pool=new SlowBuffer(Buffer.poolSize);pool.used=0}Buffer.isBuffer=function isBuffer(b){return b instanceof Buffer||b instanceof SlowBuffer};Buffer.concat=function(list,totalLength){if(!Array.isArray(list)){throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.")}if(list.length===0){return new Buffer(0)}else if(list.length===1){return list[0]}if(typeof totalLength!=="number"){totalLength=0;for(var i=0;i<list.length;i++){var buf=list[i];totalLength+=buf.length}}var buffer=new Buffer(totalLength);var pos=0;for(var i=0;i<list.length;i++){var buf=list[i];buf.copy(buffer,pos);pos+=buf.length}return buffer};Buffer.prototype.inspect=function inspect(){var out=[],len=this.length;for(var i=0;i<len;i++){out[i]=toHex(this.parent[i+this.offset]);if(i==exports.INSPECT_MAX_BYTES){out[i+1]="...";break}}return"<Buffer "+out.join(" ")+">"};Buffer.prototype.get=function get(i){if(i<0||i>=this.length)throw new Error("oob");return this.parent[this.offset+i]};Buffer.prototype.set=function set(i,v){if(i<0||i>=this.length)throw new Error("oob");return this.parent[this.offset+i]=v};Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=+offset||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=+length;if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=this.parent.hexWrite(string,this.offset+offset,length);break;case"utf8":case"utf-8":ret=this.parent.utf8Write(string,this.offset+offset,length);break;case"ascii":ret=this.parent.asciiWrite(string,this.offset+offset,length);break;case"binary":ret=this.parent.binaryWrite(string,this.offset+offset,length);break;case"base64":ret=this.parent.base64Write(string,this.offset+offset,length);break;case"ucs2":case"ucs-2":ret=this.parent.ucs2Write(string,this.offset+offset,length);break;default:throw new Error("Unknown encoding")}Buffer._charsWritten=SlowBuffer._charsWritten;return ret};Buffer.prototype.toString=function(encoding,start,end){encoding=String(encoding||"utf8").toLowerCase();if(typeof start=="undefined"||start<0){start=0}else if(start>this.length){start=this.length}if(typeof end=="undefined"||end>this.length){end=this.length}else if(end<0){end=0}start=start+this.offset;end=end+this.offset;switch(encoding){case"hex":return this.parent.hexSlice(start,end);case"utf8":case"utf-8":return this.parent.utf8Slice(start,end);case"ascii":return this.parent.asciiSlice(start,end);case"binary":return this.parent.binarySlice(start,end);case"base64":return this.parent.base64Slice(start,end);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(start,end);default:throw new Error("Unknown encoding")}};Buffer.byteLength=SlowBuffer.byteLength;Buffer.prototype.fill=function fill(value,start,end){value||(value=0);start||(start=0);end||(end=this.length);if(typeof value==="string"){value=value.charCodeAt(0)}if(!(typeof value==="number")||isNaN(value)){throw new Error("value is not a number")}if(end<start)throw new Error("end < start");if(end===start)return 0;if(this.length==0)return 0;if(start<0||start>=this.length){throw new Error("start out of bounds")}if(end<0||end>this.length){throw new Error("end out of bounds")}return this.parent.fill(value,start+this.offset,end+this.offset)};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;start||(start=0);end||(end=this.length);target_start||(target_start=0);if(end<start)throw new Error("sourceEnd < sourceStart");if(end===start)return 0;if(target.length==0||source.length==0)return 0;if(target_start<0||target_start>=target.length){throw new Error("targetStart out of bounds")}if(start<0||start>=source.length){throw new Error("sourceStart out of bounds")}if(end<0||end>source.length){throw new Error("sourceEnd out of bounds")}if(end>this.length){end=this.length}if(target.length-target_start<end-start){end=target.length-target_start+start}return this.parent.copy(target.parent,target_start+target.offset,start+this.offset,end+this.offset)};Buffer.prototype.slice=function(start,end){if(end===undefined)end=this.length;if(end>this.length)throw new Error("oob");if(start>end)throw new Error("oob");return new Buffer(this.parent,end-start,+start+this.offset)};Buffer.prototype.utf8Slice=function(start,end){return this.toString("utf8",start,end)};Buffer.prototype.binarySlice=function(start,end){return this.toString("binary",start,end)};Buffer.prototype.asciiSlice=function(start,end){return this.toString("ascii",start,end)};Buffer.prototype.utf8Write=function(string,offset){return this.write(string,offset,"utf8")};Buffer.prototype.binaryWrite=function(string,offset){return this.write(string,offset,"binary")};Buffer.prototype.asciiWrite=function(string,offset){return this.write(string,offset,"ascii")};Buffer.prototype.readUInt8=function(offset,noAssert){var buffer=this;if(!noAssert){assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to read beyond buffer length")}return buffer.parent[buffer.offset+offset]};function readUInt16(buffer,offset,isBigEndian,noAssert){var val=0;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to read beyond buffer length")}if(isBigEndian){val=buffer.parent[buffer.offset+offset]<<8;val|=buffer.parent[buffer.offset+offset+1]}else{val=buffer.parent[buffer.offset+offset];val|=buffer.parent[buffer.offset+offset+1]<<8}return val}Buffer.prototype.readUInt16LE=function(offset,noAssert){return readUInt16(this,offset,false,noAssert)};Buffer.prototype.readUInt16BE=function(offset,noAssert){return readUInt16(this,offset,true,noAssert)};function readUInt32(buffer,offset,isBigEndian,noAssert){var val=0;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}if(isBigEndian){val=buffer.parent[buffer.offset+offset+1]<<16;val|=buffer.parent[buffer.offset+offset+2]<<8;val|=buffer.parent[buffer.offset+offset+3];val=val+(buffer.parent[buffer.offset+offset]<<24>>>0)}else{val=buffer.parent[buffer.offset+offset+2]<<16;val|=buffer.parent[buffer.offset+offset+1]<<8;val|=buffer.parent[buffer.offset+offset];val=val+(buffer.parent[buffer.offset+offset+3]<<24>>>0)}return val}Buffer.prototype.readUInt32LE=function(offset,noAssert){return readUInt32(this,offset,false,noAssert)};Buffer.prototype.readUInt32BE=function(offset,noAssert){return readUInt32(this,offset,true,noAssert)};Buffer.prototype.readInt8=function(offset,noAssert){var buffer=this;var neg;if(!noAssert){assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to read beyond buffer length")}neg=buffer.parent[buffer.offset+offset]&128;if(!neg){return buffer.parent[buffer.offset+offset]}return(255-buffer.parent[buffer.offset+offset]+1)*-1};function readInt16(buffer,offset,isBigEndian,noAssert){var neg,val;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to read beyond buffer length")}val=readUInt16(buffer,offset,isBigEndian,noAssert);neg=val&32768;if(!neg){return val}return(65535-val+1)*-1}Buffer.prototype.readInt16LE=function(offset,noAssert){return readInt16(this,offset,false,noAssert)};Buffer.prototype.readInt16BE=function(offset,noAssert){return readInt16(this,offset,true,noAssert)};function readInt32(buffer,offset,isBigEndian,noAssert){var neg,val;if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}val=readUInt32(buffer,offset,isBigEndian,noAssert);neg=val&2147483648;if(!neg){return val}return(4294967295-val+1)*-1}Buffer.prototype.readInt32LE=function(offset,noAssert){return readInt32(this,offset,false,noAssert)};Buffer.prototype.readInt32BE=function(offset,noAssert){return readInt32(this,offset,true,noAssert)};function readFloat(buffer,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset+3<buffer.length,"Trying to read beyond buffer length")}return require("./buffer_ieee754").readIEEE754(buffer,offset,isBigEndian,23,4)}Buffer.prototype.readFloatLE=function(offset,noAssert){return readFloat(this,offset,false,noAssert)};Buffer.prototype.readFloatBE=function(offset,noAssert){return readFloat(this,offset,true,noAssert)};function readDouble(buffer,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset+7<buffer.length,"Trying to read beyond buffer length")}return require("./buffer_ieee754").readIEEE754(buffer,offset,isBigEndian,52,8)}Buffer.prototype.readDoubleLE=function(offset,noAssert){return readDouble(this,offset,false,noAssert)};Buffer.prototype.readDoubleBE=function(offset,noAssert){return readDouble(this,offset,true,noAssert)};function verifuint(value,max){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value>=0,"specified a negative value for writing an unsigned value");assert.ok(value<=max,"value is larger than maximum value for type");assert.ok(Math.floor(value)===value,"value has a fractional component")}Buffer.prototype.writeUInt8=function(value,offset,noAssert){var buffer=this;if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"trying to write beyond buffer length");verifuint(value,255)}buffer.parent[buffer.offset+offset]=value};function writeUInt16(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"trying to write beyond buffer length");verifuint(value,65535)}if(isBigEndian){buffer.parent[buffer.offset+offset]=(value&65280)>>>8;buffer.parent[buffer.offset+offset+1]=value&255}else{buffer.parent[buffer.offset+offset+1]=(value&65280)>>>8;buffer.parent[buffer.offset+offset]=value&255}}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){writeUInt16(this,value,offset,false,noAssert)};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){writeUInt16(this,value,offset,true,noAssert)};function writeUInt32(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"trying to write beyond buffer length");verifuint(value,4294967295)}if(isBigEndian){buffer.parent[buffer.offset+offset]=value>>>24&255;buffer.parent[buffer.offset+offset+1]=value>>>16&255;buffer.parent[buffer.offset+offset+2]=value>>>8&255;buffer.parent[buffer.offset+offset+3]=value&255}else{buffer.parent[buffer.offset+offset+3]=value>>>24&255;buffer.parent[buffer.offset+offset+2]=value>>>16&255;buffer.parent[buffer.offset+offset+1]=value>>>8&255;buffer.parent[buffer.offset+offset]=value&255}}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){writeUInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){writeUInt32(this,value,offset,true,noAssert)};function verifsint(value,max,min){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value<=max,"value larger than maximum allowed value");assert.ok(value>=min,"value smaller than minimum allowed value");assert.ok(Math.floor(value)===value,"value has a fractional component")
}function verifIEEE754(value,max,min){assert.ok(typeof value=="number","cannot write a non-number as a number");assert.ok(value<=max,"value larger than maximum allowed value");assert.ok(value>=min,"value smaller than minimum allowed value")}Buffer.prototype.writeInt8=function(value,offset,noAssert){var buffer=this;if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset<buffer.length,"Trying to write beyond buffer length");verifsint(value,127,-128)}if(value>=0){buffer.writeUInt8(value,offset,noAssert)}else{buffer.writeUInt8(255+value+1,offset,noAssert)}};function writeInt16(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+1<buffer.length,"Trying to write beyond buffer length");verifsint(value,32767,-32768)}if(value>=0){writeUInt16(buffer,value,offset,isBigEndian,noAssert)}else{writeUInt16(buffer,65535+value+1,offset,isBigEndian,noAssert)}}Buffer.prototype.writeInt16LE=function(value,offset,noAssert){writeInt16(this,value,offset,false,noAssert)};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){writeInt16(this,value,offset,true,noAssert)};function writeInt32(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to write beyond buffer length");verifsint(value,2147483647,-2147483648)}if(value>=0){writeUInt32(buffer,value,offset,isBigEndian,noAssert)}else{writeUInt32(buffer,4294967295+value+1,offset,isBigEndian,noAssert)}}Buffer.prototype.writeInt32LE=function(value,offset,noAssert){writeInt32(this,value,offset,false,noAssert)};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){writeInt32(this,value,offset,true,noAssert)};function writeFloat(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+3<buffer.length,"Trying to write beyond buffer length");verifIEEE754(value,3.4028234663852886e38,-3.4028234663852886e38)}require("./buffer_ieee754").writeIEEE754(buffer,value,offset,isBigEndian,23,4)}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){writeFloat(this,value,offset,false,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){writeFloat(this,value,offset,true,noAssert)};function writeDouble(buffer,value,offset,isBigEndian,noAssert){if(!noAssert){assert.ok(value!==undefined&&value!==null,"missing value");assert.ok(typeof isBigEndian==="boolean","missing or invalid endian");assert.ok(offset!==undefined&&offset!==null,"missing offset");assert.ok(offset+7<buffer.length,"Trying to write beyond buffer length");verifIEEE754(value,1.7976931348623157e308,-1.7976931348623157e308)}require("./buffer_ieee754").writeIEEE754(buffer,value,offset,isBigEndian,52,8)}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){writeDouble(this,value,offset,true,noAssert)};SlowBuffer.prototype.readUInt8=Buffer.prototype.readUInt8;SlowBuffer.prototype.readUInt16LE=Buffer.prototype.readUInt16LE;SlowBuffer.prototype.readUInt16BE=Buffer.prototype.readUInt16BE;SlowBuffer.prototype.readUInt32LE=Buffer.prototype.readUInt32LE;SlowBuffer.prototype.readUInt32BE=Buffer.prototype.readUInt32BE;SlowBuffer.prototype.readInt8=Buffer.prototype.readInt8;SlowBuffer.prototype.readInt16LE=Buffer.prototype.readInt16LE;SlowBuffer.prototype.readInt16BE=Buffer.prototype.readInt16BE;SlowBuffer.prototype.readInt32LE=Buffer.prototype.readInt32LE;SlowBuffer.prototype.readInt32BE=Buffer.prototype.readInt32BE;SlowBuffer.prototype.readFloatLE=Buffer.prototype.readFloatLE;SlowBuffer.prototype.readFloatBE=Buffer.prototype.readFloatBE;SlowBuffer.prototype.readDoubleLE=Buffer.prototype.readDoubleLE;SlowBuffer.prototype.readDoubleBE=Buffer.prototype.readDoubleBE;SlowBuffer.prototype.writeUInt8=Buffer.prototype.writeUInt8;SlowBuffer.prototype.writeUInt16LE=Buffer.prototype.writeUInt16LE;SlowBuffer.prototype.writeUInt16BE=Buffer.prototype.writeUInt16BE;SlowBuffer.prototype.writeUInt32LE=Buffer.prototype.writeUInt32LE;SlowBuffer.prototype.writeUInt32BE=Buffer.prototype.writeUInt32BE;SlowBuffer.prototype.writeInt8=Buffer.prototype.writeInt8;SlowBuffer.prototype.writeInt16LE=Buffer.prototype.writeInt16LE;SlowBuffer.prototype.writeInt16BE=Buffer.prototype.writeInt16BE;SlowBuffer.prototype.writeInt32LE=Buffer.prototype.writeInt32LE;SlowBuffer.prototype.writeInt32BE=Buffer.prototype.writeInt32BE;SlowBuffer.prototype.writeFloatLE=Buffer.prototype.writeFloatLE;SlowBuffer.prototype.writeFloatBE=Buffer.prototype.writeFloatBE;SlowBuffer.prototype.writeDoubleLE=Buffer.prototype.writeDoubleLE;SlowBuffer.prototype.writeDoubleBE=Buffer.prototype.writeDoubleBE})()},{assert:2,"./buffer_ieee754":7,"base64-js":9}],9:[function(require,module,exports){(function(exports){"use strict";var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw"Invalid string. Length must be a multiple of 4"}placeHolders=b64.indexOf("=");placeHolders=placeHolders>0?b64.length-placeHolders:0;arr=[];l=placeHolders>0?b64.length-4:b64.length;for(i=0,j=0;i<l;i+=4,j+=3){tmp=lookup.indexOf(b64[i])<<18|lookup.indexOf(b64[i+1])<<12|lookup.indexOf(b64[i+2])<<6|lookup.indexOf(b64[i+3]);arr.push((tmp&16711680)>>16);arr.push((tmp&65280)>>8);arr.push(tmp&255)}if(placeHolders===2){tmp=lookup.indexOf(b64[i])<<2|lookup.indexOf(b64[i+1])>>4;arr.push(tmp&255)}else if(placeHolders===1){tmp=lookup.indexOf(b64[i])<<10|lookup.indexOf(b64[i+1])<<4|lookup.indexOf(b64[i+2])>>2;arr.push(tmp>>8&255);arr.push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=lookup[temp>>2];output+=lookup[temp<<4&63];output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=lookup[temp>>10];output+=lookup[temp>>4&63];output+=lookup[temp<<2&63];output+="=";break}return output}module.exports.toByteArray=b64ToByteArray;module.exports.fromByteArray=uint8ToBase64})()},{}]},{},[]);module.exports=require("buffer-browserify")},{}],3:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){var buzz={defaults:{autoplay:false,duration:5e3,formats:[],loop:false,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(src,options){options=options||{};var pid=0,events=[],eventsOnce={},supported=buzz.isSupported();this.load=function(){if(!supported){return this}this.sound.load();return this};this.play=function(){if(!supported){return this}this.sound.play();return this};this.togglePlay=function(){if(!supported){return this}if(this.sound.paused){this.sound.play()}else{this.sound.pause()}return this};this.pause=function(){if(!supported){return this}this.sound.pause();return this};this.isPaused=function(){if(!supported){return null}return this.sound.paused};this.stop=function(){if(!supported){return this}this.setTime(0);this.sound.pause();return this};this.isEnded=function(){if(!supported){return null}return this.sound.ended};this.loop=function(){if(!supported){return this}this.sound.loop="loop";this.bind("ended.buzzloop",function(){this.currentTime=0;this.play()});return this};this.unloop=function(){if(!supported){return this}this.sound.removeAttribute("loop");this.unbind("ended.buzzloop");return this};this.mute=function(){if(!supported){return this}this.sound.muted=true;return this};this.unmute=function(){if(!supported){return this}this.sound.muted=false;return this};this.toggleMute=function(){if(!supported){return this}this.sound.muted=!this.sound.muted;return this};this.isMuted=function(){if(!supported){return null}return this.sound.muted};this.setVolume=function(volume){if(!supported){return this}if(volume<0){volume=0}if(volume>100){volume=100}this.volume=volume;this.sound.volume=volume/100;return this};this.getVolume=function(){if(!supported){return this}return this.volume};this.increaseVolume=function(value){return this.setVolume(this.volume+(value||1))};this.decreaseVolume=function(value){return this.setVolume(this.volume-(value||1))};this.setTime=function(time){if(!supported){return this}this.whenReady(function(){this.sound.currentTime=time});return this};this.getTime=function(){if(!supported){return null}var time=Math.round(this.sound.currentTime*100)/100;return isNaN(time)?buzz.defaults.placeholder:time};this.setPercent=function(percent){if(!supported){return this}return this.setTime(buzz.fromPercent(percent,this.sound.duration))};this.getPercent=function(){if(!supported){return null}var percent=Math.round(buzz.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(percent)?buzz.defaults.placeholder:percent};this.setSpeed=function(duration){if(!supported){return this}this.sound.playbackRate=duration};this.getSpeed=function(){if(!supported){return null}return this.sound.playbackRate};this.getDuration=function(){if(!supported){return null}var duration=Math.round(this.sound.duration*100)/100;return isNaN(duration)?buzz.defaults.placeholder:duration};this.getPlayed=function(){if(!supported){return null}return timerangeToArray(this.sound.played)};this.getBuffered=function(){if(!supported){return null}return timerangeToArray(this.sound.buffered)};this.getSeekable=function(){if(!supported){return null}return timerangeToArray(this.sound.seekable)};this.getErrorCode=function(){if(supported&&this.sound.error){return this.sound.error.code}return 0};this.getErrorMessage=function(){if(!supported){return null}switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}};this.getStateCode=function(){if(!supported){return null}return this.sound.readyState};this.getStateMessage=function(){if(!supported){return null}switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}};this.getNetworkStateCode=function(){if(!supported){return null}return this.sound.networkState};this.getNetworkStateMessage=function(){if(!supported){return null}switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}};this.set=function(key,value){if(!supported){return this}this.sound[key]=value;return this};this.get=function(key){if(!supported){return null}return key?this.sound[key]:this.sound};this.bind=function(types,func){if(!supported){return this}types=types.split(" ");var that=this,efunc=function(e){func.call(that,e)};for(var t=0;t<types.length;t++){var type=types[t],idx=type;type=idx.split(".")[0];events.push({idx:idx,func:efunc});this.sound.addEventListener(type,efunc,true)}return this};this.unbind=function(types){if(!supported){return this}types=types.split(" ");for(var t=0;t<types.length;t++){var idx=types[t],type=idx.split(".")[0];for(var i=0;i<events.length;i++){var namespace=events[i].idx.split(".");if(events[i].idx==idx||namespace[1]&&namespace[1]==idx.replace(".","")){this.sound.removeEventListener(type,events[i].func,true);events.splice(i,1)}}}return this};this.bindOnce=function(type,func){if(!supported){return this}var that=this;eventsOnce[pid++]=false;this.bind(type+"."+pid,function(){if(!eventsOnce[pid]){eventsOnce[pid]=true;func.call(that)}that.unbind(type+"."+pid)})};this.trigger=function(types){if(!supported){return this}types=types.split(" ");for(var t=0;t<types.length;t++){var idx=types[t];for(var i=0;i<events.length;i++){var eventType=events[i].idx.split(".");if(events[i].idx==idx||eventType[0]&&eventType[0]==idx.replace(".","")){var evt=document.createEvent("HTMLEvents");evt.initEvent(eventType[0],false,true);this.sound.dispatchEvent(evt)}}}return this};this.fadeTo=function(to,duration,callback){if(!supported){return this}if(duration instanceof Function){callback=duration;duration=buzz.defaults.duration}else{duration=duration||buzz.defaults.duration}var from=this.volume,delay=duration/Math.abs(from-to),that=this;this.play();function doFade(){setTimeout(function(){if(from<to&&that.volume<to){that.setVolume(that.volume+=1);doFade()}else if(from>to&&that.volume>to){that.setVolume(that.volume-=1);doFade()}else if(callback instanceof Function){callback.apply(that)}},delay)}this.whenReady(function(){doFade()});return this};this.fadeIn=function(duration,callback){if(!supported){return this}return this.setVolume(0).fadeTo(100,duration,callback)};this.fadeOut=function(duration,callback){if(!supported){return this}return this.fadeTo(0,duration,callback)};this.fadeWith=function(sound,duration){if(!supported){return this}this.fadeOut(duration,function(){this.stop()});sound.play().fadeIn(duration);return this};this.whenReady=function(func){if(!supported){return null}var that=this;if(this.sound.readyState===0){this.bind("canplay.buzzwhenready",function(){func.call(that)})}else{func.call(that)}};function timerangeToArray(timeRange){var array=[],length=timeRange.length-1;for(var i=0;i<=length;i++){array.push({start:timeRange.start(length),end:timeRange.end(length)})}return array}function getExt(filename){return filename.split(".").pop()}function addSource(sound,src){var source=document.createElement("source");source.src=src;if(buzz.types[getExt(src)]){source.type=buzz.types[getExt(src)]}sound.appendChild(source)}if(supported&&src){for(var i in buzz.defaults){if(buzz.defaults.hasOwnProperty(i)){options[i]=options[i]||buzz.defaults[i]}}this.sound=document.createElement("audio");if(src instanceof Array){for(var j in src){if(src.hasOwnProperty(j)){addSource(this.sound,src[j])}}}else if(options.formats.length){for(var k in options.formats){if(options.formats.hasOwnProperty(k)){addSource(this.sound,src+"."+options.formats[k])}}}else{addSource(this.sound,src)}if(options.loop){this.loop()}if(options.autoplay){this.sound.autoplay="autoplay"}if(options.preload===true){this.sound.preload="auto"}else if(options.preload===false){this.sound.preload="none"}else{this.sound.preload=options.preload}this.setVolume(options.volume);buzz.sounds.push(this)}},group:function(sounds){sounds=argsToArray(sounds,arguments);this.getSounds=function(){return sounds};this.add=function(soundArray){soundArray=argsToArray(soundArray,arguments);for(var a=0;a<soundArray.length;a++){sounds.push(soundArray[a])}};this.remove=function(soundArray){soundArray=argsToArray(soundArray,arguments);for(var a=0;a<soundArray.length;a++){for(var i=0;i<sounds.length;i++){if(sounds[i]==soundArray[a]){sounds.splice(i,1);break}}}};this.load=function(){fn("load");return this};this.play=function(){fn("play");return this};this.togglePlay=function(){fn("togglePlay");return this};this.pause=function(time){fn("pause",time);return this};this.stop=function(){fn("stop");return this};this.mute=function(){fn("mute");return this};this.unmute=function(){fn("unmute");return this};this.toggleMute=function(){fn("toggleMute");return this};this.setVolume=function(volume){fn("setVolume",volume);return this};this.increaseVolume=function(value){fn("increaseVolume",value);return this};this.decreaseVolume=function(value){fn("decreaseVolume",value);return this};this.loop=function(){fn("loop");return this};this.unloop=function(){fn("unloop");return this};this.setTime=function(time){fn("setTime",time);return this};this.set=function(key,value){fn("set",key,value);return this};this.bind=function(type,func){fn("bind",type,func);return this};this.unbind=function(type){fn("unbind",type);return this};this.bindOnce=function(type,func){fn("bindOnce",type,func);return this};this.trigger=function(type){fn("trigger",type);return this};this.fade=function(from,to,duration,callback){fn("fade",from,to,duration,callback);return this};this.fadeIn=function(duration,callback){fn("fadeIn",duration,callback);return this};this.fadeOut=function(duration,callback){fn("fadeOut",duration,callback);return this};function fn(){var args=argsToArray(null,arguments),func=args.shift();for(var i=0;i<sounds.length;i++){sounds[i][func].apply(sounds[i],args)}}function argsToArray(array,args){return array instanceof Array?array:Array.prototype.slice.call(args)}},all:function(){return new buzz.group(buzz.sounds)},isSupported:function(){return!!buzz.el.canPlayType},isOGGSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!buzz.el.canPlayType&&(buzz.el.canPlayType("audio/x-m4a;")||buzz.el.canPlayType("audio/aac;"))},toTimer:function(time,withHours){var h,m,s;h=Math.floor(time/3600);h=isNaN(h)?"--":h>=10?h:"0"+h;m=withHours?Math.floor(time/60%60):Math.floor(time/60);m=isNaN(m)?"--":m>=10?m:"0"+m;s=Math.floor(time%60);s=isNaN(s)?"--":s>=10?s:"0"+s;return withHours?h+":"+m+":"+s:m+":"+s},fromTimer:function(time){var splits=time.toString().split(":");if(splits&&splits.length==3){time=parseInt(splits[0],10)*3600+parseInt(splits[1],10)*60+parseInt(splits[2],10)}if(splits&&splits.length==2){time=parseInt(splits[0],10)*60+parseInt(splits[1],10)}return time},toPercent:function(value,total,decimal){var r=Math.pow(10,decimal||0);return Math.round(value*100/total*r)/r},fromPercent:function(percent,total,decimal){var r=Math.pow(10,decimal||0);return Math.round(total/100*percent*r)/r}};if(typeof module!="undefined")module.exports=buzz})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/node_modules/buzz.js","/node_modules")},{__browserify_process:1,__browserify_buffer:2}],4:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var $,key,_,v3,buzz,this$=this;$=require("boxes");key=require("key");_=require("lodash");v3=require("three_vector3");buzz=require("buzz");global.B=16;global.G=84*B;global.key_left="a";global.key_down="s";global.key_right="d";global.key_up="w";global.key_a="j";global.key_b="k";global.key_start="l";global.now=function(){return Date.now()/1e3};global.last_tick=now();global.just=function(val){return function(){return val}};global.true_for=function(secs){var start;start=now();return function(){return now()-start<secs}};global.time_since=function(it){return now()-it};global.cycle=function(arr,interval){return arr[floor(now()%interval/interval*arr.length)]};global.chronometer=function(initial){initial==null&&(initial=now());return function(){return now()-initial}};global.blink=function(interval){return now()%interval<interval/2};require("./sound/sound");require("./objects/camera/camera");require("./objects/object");require("./objects/mememan/mememan");require("./objects/macer/macer");require("./objects/bee_queen/bee_queen");require("./objects/bee/bee");require("./objects/trapdoor/trapdoor");require("./objects/trapbite/trapbite");require("./objects/hardman/hardman");require("./objects/rock/rock");require("./objects/shot/shot");require("./objects/pokeball/pokeball");require("./objects/ground/ground");require("./objects/bar/bar");require("./objects/stair/stair");require("./objects/punch/punch");require("./stages/stage");require("./stages/hardstage/hardstage");require("./modes/stage_select_mode/stage_select_mode");require("./modes/game_mode/game_mode");require("./modes/title_mode/title_mode");global.canvas=processing(window.innerWidth,window.innerHeight,{setup:function(){var preload,i$,ref$,len$,wpn,spr,this$=this;global.sprite=_.memoize(function(url){return this$.loadImage(url)});global.draw_sprite=function(spr,x,y){return this$.image(spr,x-spr.width/2+camera.offset.x,y-spr.height/2+camera.offset.y)};global.draw_healthbar=function(hp,x,y,dir,col){var max,bar_w,bar_h,w,h,sx,sy,addx,addy,i$,to$,i,results$=[];dir==null&&(dir="down");col==null&&(col=[255,255,0]);max=24;switch(dir){case"down":bar_w=6;bar_h=1;w=bar_w+2;h=bar_h*max*2+1;sx=x+1;sy=y+h-2;addx=0;addy=-2;break;case"right":bar_w=1;bar_h=6;w=bar_w*max*2+1;h=bar_h+2;sx=x+1;sy=y+1;addx=2;addy=0}this$.fill(0,0,0);this$.rect(x,y,w,h);this$.fill(col[0],col[1],col[2]);for(i$=0,to$=floor(hp*max);i$<to$;++i$){i=i$;results$.push(this$.rect(sx+i*addx,sy+i*addy,bar_w,bar_h))}return results$};global.courier_new=this.loadFont("courier new");log("Loading sprites...");preload=map(function(it){return"modes/stage_select_mode/sprites/"+it},["look_00","look_01","look_02","look_10","look_11","look_12","look_20","look_21","look_22"]);for(i$=0,len$=(ref$=["normal","poke","punch"]).length;i$<len$;++i$){wpn=ref$[i$];preload=preload.concat(map(fn$,["climbed","climbing_shooting","climbing","hurt","jumping","jumping_shoot","sliding","standing_shoot","standing0","standing1","walking_shoot0","walking_shoot1","walking_shoot2","walking0","walking1","walking2"]))}preload=preload.concat(map(function(it){return"objects/trapbite/sprites/"+it},["closed","open"]));preload=preload.concat(map(function(it){return"objects/trapdoor/sprites/"+it},["trapdoor"]));preload=preload.concat(map(function(it){return"objects/ground/sprites/"+it},["Bottom0","Bottom1","BottomLeft","BottomRight","Center0","Center1","Center2","Center3","Left0","Left1","Right0","Right1","Top0","Top1","TopLeft","TopRight"]));preload=preload.concat(map(function(it){return"objects/bar/sprites/"+it},["bar"]));preload=preload.concat(map(function(it){return"objects/bee/sprites/"+it},["bee"]));preload=preload.concat(map(function(it){return"objects/bee/sprites/"+it},["free","holding"]));preload=preload.concat(map(function(it){return"objects/macer/sprites/"+it},["standing0","standing1","standing2","standing3","throwing"]));preload=preload.concat(map(function(it){return"objects/macer/sprites/"+it},["standing0","standing1","standing2","standing3","throwing"]));preload=preload.concat(map(function(it){return"objects/rock/sprites/"+it},["rock"]));preload=preload.concat(map(function(it){return"objects/punch/sprites/"+it},["punch"]));preload=preload.concat(map(function(it){return"objects/shot/sprites/"+it},["shot"]));preload=preload.concat(map(function(it){return"objects/stair/sprites/"+it},["stair"]));preload=preload.concat(map(function(it){return"modes/stage_select_mode/sprites/"+it},["background","look_00","look_01","look_02","look_10","look_11","look_12","look_20","look_21","look_22","geminiman","hardman","magnetman","needleman","shadowman","snakeman","sparkman","topman","wtfisdisguy"]));preload=preload.concat(map(function(it){return"objects/hardman/sprites/"+it},["buried0","buried1","diving","punch","shooting0","shooting1","shooting2","shooting3","shooting4","soaring","standing0","turining0","turning1"]));for(i$=0,len$=preload.length;i$<len$;++i$){spr=preload[i$];sprite(spr+".png");sprite(spr+"_r.png")}this.noStroke();this.scale(camera.scale);return title_mode();function fn$(it){return"objects/mememan/sprites/"+wpn+"/"+it}},draw:function(){global.screen=this;this.scale(camera.scale);return mode.draw(this)}});$("body").append(canvas)}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/index.js","/")},{viclib:5,buzz:3,"./sound/sound":6,"./objects/camera/camera":7,"./objects/object":8,"./objects/mememan/mememan":9,"./objects/macer/macer":10,"./objects/bee_queen/bee_queen":11,"./objects/bee/bee":12,"./objects/trapdoor/trapdoor":13,"./objects/trapbite/trapbite":14,"./objects/hardman/hardman":15,"./objects/rock/rock":16,"./objects/shot/shot":17,"./objects/pokeball/pokeball":18,"./objects/ground/ground":19,"./objects/bar/bar":20,"./objects/stair/stair":21,"./objects/punch/punch":22,"./stages/stage":23,"./stages/hardstage/hardstage":24,"./modes/stage_select_mode/stage_select_mode":25,"./modes/game_mode/game_mode":26,"./modes/title_mode/title_mode":27,boxes:28,key:29,three_vector3:30,"prelude-ls":31,lodash:32,__browserify_process:1,__browserify_buffer:2}],30:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){THREE={};THREE.extend=function(obj,source){if(Object.keys){var keys=Object.keys(source);for(var i=0,il=keys.length;i<il;i++){var prop=keys[i];Object.defineProperty(obj,prop,Object.getOwnPropertyDescriptor(source,prop))}}else{var safeHasOwnProperty={}.hasOwnProperty;for(var prop in source){if(safeHasOwnProperty.call(source,prop)){obj[prop]=source[prop]}}}return obj};THREE.Quaternion=function(x,y,z,w){this.x=x||0;this.y=y||0;this.z=z||0;this.w=w!==undefined?w:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(x,y,z,w){this.x=x;this.y=y;this.z=z;this.w=w;return this},copy:function(q){this.x=q.x;this.y=q.y;this.z=q.z;this.w=q.w;return this},setFromEuler:function(v,order){var c1=Math.cos(v.x/2);var c2=Math.cos(v.y/2);var c3=Math.cos(v.z/2);var s1=Math.sin(v.x/2);var s2=Math.sin(v.y/2);var s3=Math.sin(v.z/2);if(order===undefined||order==="XYZ"){this.x=s1*c2*c3+c1*s2*s3;this.y=c1*s2*c3-s1*c2*s3;this.z=c1*c2*s3+s1*s2*c3;this.w=c1*c2*c3-s1*s2*s3}else if(order==="YXZ"){this.x=s1*c2*c3+c1*s2*s3;this.y=c1*s2*c3-s1*c2*s3;this.z=c1*c2*s3-s1*s2*c3;this.w=c1*c2*c3+s1*s2*s3}else if(order==="ZXY"){this.x=s1*c2*c3-c1*s2*s3;this.y=c1*s2*c3+s1*c2*s3;this.z=c1*c2*s3+s1*s2*c3;this.w=c1*c2*c3-s1*s2*s3}else if(order==="ZYX"){this.x=s1*c2*c3-c1*s2*s3;this.y=c1*s2*c3+s1*c2*s3;this.z=c1*c2*s3-s1*s2*c3;this.w=c1*c2*c3+s1*s2*s3}else if(order==="YZX"){this.x=s1*c2*c3+c1*s2*s3;this.y=c1*s2*c3+s1*c2*s3;this.z=c1*c2*s3-s1*s2*c3;this.w=c1*c2*c3-s1*s2*s3}else if(order==="XZY"){this.x=s1*c2*c3-c1*s2*s3;this.y=c1*s2*c3-s1*c2*s3;this.z=c1*c2*s3+s1*s2*c3;this.w=c1*c2*c3+s1*s2*s3}return this},setFromAxisAngle:function(axis,angle){var halfAngle=angle/2,s=Math.sin(halfAngle);this.x=axis.x*s;this.y=axis.y*s;this.z=axis.z*s;this.w=Math.cos(halfAngle);return this},setFromRotationMatrix:function(m){var te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10],trace=m11+m22+m33,s;if(trace>0){s=.5/Math.sqrt(trace+1);this.w=.25/s;this.x=(m32-m23)*s;this.y=(m13-m31)*s;this.z=(m21-m12)*s}else if(m11>m22&&m11>m33){s=2*Math.sqrt(1+m11-m22-m33);this.w=(m32-m23)/s;this.x=.25*s;this.y=(m12+m21)/s;this.z=(m13+m31)/s}else if(m22>m33){s=2*Math.sqrt(1+m22-m11-m33);this.w=(m13-m31)/s;this.x=(m12+m21)/s;this.y=.25*s;this.z=(m23+m32)/s}else{s=2*Math.sqrt(1+m33-m11-m22);this.w=(m21-m12)/s;this.x=(m13+m31)/s;this.y=(m23+m32)/s;this.z=.25*s}return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var l=this.length();if(l===0){this.x=0;this.y=0;this.z=0;this.w=1}else{l=1/l;this.x=this.x*l;this.y=this.y*l;this.z=this.z*l;this.w=this.w*l}return this},multiply:function(q,p){if(p!==undefined){console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(q,p)}return this.multiplyQuaternions(this,q)},multiplyQuaternions:function(a,b){var qax=a.x,qay=a.y,qaz=a.z,qaw=a.w;var qbx=b.x,qby=b.y,qbz=b.z,qbw=b.w;this.x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby;this.y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz;this.z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx;this.w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz;return this},multiplyVector3:function(vector){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return vector.applyQuaternion(this)},slerp:function(qb,t){var x=this.x,y=this.y,z=this.z,w=this.w;var cosHalfTheta=w*qb.w+x*qb.x+y*qb.y+z*qb.z;if(cosHalfTheta<0){this.w=-qb.w;this.x=-qb.x;this.y=-qb.y;this.z=-qb.z;cosHalfTheta=-cosHalfTheta}else{this.copy(qb)}if(cosHalfTheta>=1){this.w=w;this.x=x;this.y=y;this.z=z;return this}var halfTheta=Math.acos(cosHalfTheta);var sinHalfTheta=Math.sqrt(1-cosHalfTheta*cosHalfTheta);if(Math.abs(sinHalfTheta)<.001){this.w=.5*(w+this.w);this.x=.5*(x+this.x);this.y=.5*(y+this.y);this.z=.5*(z+this.z);return this}var ratioA=Math.sin((1-t)*halfTheta)/sinHalfTheta,ratioB=Math.sin(t*halfTheta)/sinHalfTheta;this.w=w*ratioA+this.w*ratioB;this.x=x*ratioA+this.x*ratioB;this.y=y*ratioA+this.y*ratioB;this.z=z*ratioA+this.z*ratioB;return this},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w},fromArray:function(array){this.x=array[0];this.y=array[1];this.z=array[2];this.w=array[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}};THREE.Quaternion.slerp=function(qa,qb,qm,t){return qm.copy(qa).slerp(qb,t)};THREE.Vector3=function(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(x,y,z){this.x=x;this.y=y;this.z=z;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setZ:function(z){this.z=z;return this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;default:throw new Error("index is out of range: "+index)}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+index)}},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this},add:function(v,w){if(w!==undefined){console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(v,w)}this.x+=v.x;this.y+=v.y;this.z+=v.z;return this},addScalar:function(s){this.x+=s;this.y+=s;this.z+=s;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(v,w){if(w!==undefined){console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(v,w)}this.x-=v.x;this.y-=v.y;this.z-=v.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(v,w){if(w!==undefined){console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(v,w)}this.x*=v.x;this.y*=v.y;this.z*=v.z;return this},multiplyScalar:function(s){this.x*=s;this.y*=s;this.z*=s;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyMatrix3:function(m){var x=this.x;var y=this.y;var z=this.z;var e=m.elements;this.x=e[0]*x+e[3]*y+e[6]*z;this.y=e[1]*x+e[4]*y+e[7]*z;this.z=e[2]*x+e[5]*y+e[8]*z;return this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+e[8]*z+e[12];this.y=e[1]*x+e[5]*y+e[9]*z+e[13];this.z=e[2]*x+e[6]*y+e[10]*z+e[14];return this},applyProjection:function(m){var x=this.x,y=this.y,z=this.z;
var e=m.elements;var d=1/(e[3]*x+e[7]*y+e[11]*z+e[15]);this.x=(e[0]*x+e[4]*y+e[8]*z+e[12])*d;this.y=(e[1]*x+e[5]*y+e[9]*z+e[13])*d;this.z=(e[2]*x+e[6]*y+e[10]*z+e[14])*d;return this},applyQuaternion:function(q){var x=this.x;var y=this.y;var z=this.z;var qx=q.x;var qy=q.y;var qz=q.z;var qw=q.w;var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this},transformDirection:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+e[8]*z;this.y=e[1]*x+e[5]*y+e[9]*z;this.z=e[2]*x+e[6]*y+e[10]*z;this.normalize();return this},divide:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z;return this},divideScalar:function(s){if(s!==0){this.x/=s;this.y/=s;this.z/=s}else{this.x=0;this.y=0;this.z=0}return this},min:function(v){if(this.x>v.x){this.x=v.x}if(this.y>v.y){this.y=v.y}if(this.z>v.z){this.z=v.z}return this},max:function(v){if(this.x<v.x){this.x=v.x}if(this.y<v.y){this.y=v.y}if(this.z<v.z){this.z=v.z}return this},clamp:function(min,max){if(this.x<min.x){this.x=min.x}else if(this.x>max.x){this.x=max.x}if(this.y<min.y){this.y=min.y}else if(this.y>max.y){this.y=max.y}if(this.z<min.z){this.z=min.z}else if(this.z>max.z){this.z=max.z}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(l){var oldLength=this.length();if(oldLength!==0&&l!==oldLength){this.multiplyScalar(l/oldLength)}return this},lerp:function(v,alpha){this.x+=(v.x-this.x)*alpha;this.y+=(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;return this},cross:function(v,w){if(w!==undefined){console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(v,w)}var x=this.x,y=this.y,z=this.z;this.x=y*v.z-z*v.y;this.y=z*v.x-x*v.z;this.z=x*v.y-y*v.x;return this},crossVectors:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},angleTo:function(v){var theta=this.dot(v)/(this.length()*v.length());return Math.acos(THREE.Math.clamp(theta,-1,1))},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x;var dy=this.y-v.y;var dz=this.z-v.z;return dx*dx+dy*dy+dz*dz},setEulerFromRotationMatrix:function(m,order){function clamp(x){return Math.min(Math.max(x,-1),1)}var te=m.elements;var m11=te[0],m12=te[4],m13=te[8];var m21=te[1],m22=te[5],m23=te[9];var m31=te[2],m32=te[6],m33=te[10];if(order===undefined||order==="XYZ"){this.y=Math.asin(clamp(m13));if(Math.abs(m13)<.99999){this.x=Math.atan2(-m23,m33);this.z=Math.atan2(-m12,m11)}else{this.x=Math.atan2(m32,m22);this.z=0}}else if(order==="YXZ"){this.x=Math.asin(-clamp(m23));if(Math.abs(m23)<.99999){this.y=Math.atan2(m13,m33);this.z=Math.atan2(m21,m22)}else{this.y=Math.atan2(-m31,m11);this.z=0}}else if(order==="ZXY"){this.x=Math.asin(clamp(m32));if(Math.abs(m32)<.99999){this.y=Math.atan2(-m31,m33);this.z=Math.atan2(-m12,m22)}else{this.y=0;this.z=Math.atan2(m21,m11)}}else if(order==="ZYX"){this.y=Math.asin(-clamp(m31));if(Math.abs(m31)<.99999){this.x=Math.atan2(m32,m33);this.z=Math.atan2(m21,m11)}else{this.x=0;this.z=Math.atan2(-m12,m22)}}else if(order==="YZX"){this.z=Math.asin(clamp(m21));if(Math.abs(m21)<.99999){this.x=Math.atan2(-m23,m22);this.y=Math.atan2(-m31,m11)}else{this.x=0;this.y=Math.atan2(m13,m33)}}else if(order==="XZY"){this.z=Math.asin(-clamp(m12));if(Math.abs(m12)<.99999){this.x=Math.atan2(m32,m22);this.y=Math.atan2(m13,m11)}else{this.x=Math.atan2(-m23,m33);this.y=0}}return this},setEulerFromQuaternion:function(q,order){function clamp(x){return Math.min(Math.max(x,-1),1)}var sqx=q.x*q.x;var sqy=q.y*q.y;var sqz=q.z*q.z;var sqw=q.w*q.w;if(order===undefined||order==="XYZ"){this.x=Math.atan2(2*(q.x*q.w-q.y*q.z),sqw-sqx-sqy+sqz);this.y=Math.asin(clamp(2*(q.x*q.z+q.y*q.w)));this.z=Math.atan2(2*(q.z*q.w-q.x*q.y),sqw+sqx-sqy-sqz)}else if(order==="YXZ"){this.x=Math.asin(clamp(2*(q.x*q.w-q.y*q.z)));this.y=Math.atan2(2*(q.x*q.z+q.y*q.w),sqw-sqx-sqy+sqz);this.z=Math.atan2(2*(q.x*q.y+q.z*q.w),sqw-sqx+sqy-sqz)}else if(order==="ZXY"){this.x=Math.asin(clamp(2*(q.x*q.w+q.y*q.z)));this.y=Math.atan2(2*(q.y*q.w-q.z*q.x),sqw-sqx-sqy+sqz);this.z=Math.atan2(2*(q.z*q.w-q.x*q.y),sqw-sqx+sqy-sqz)}else if(order==="ZYX"){this.x=Math.atan2(2*(q.x*q.w+q.z*q.y),sqw-sqx-sqy+sqz);this.y=Math.asin(clamp(2*(q.y*q.w-q.x*q.z)));this.z=Math.atan2(2*(q.x*q.y+q.z*q.w),sqw+sqx-sqy-sqz)}else if(order==="YZX"){this.x=Math.atan2(2*(q.x*q.w-q.z*q.y),sqw-sqx+sqy-sqz);this.y=Math.atan2(2*(q.y*q.w-q.x*q.z),sqw+sqx-sqy-sqz);this.z=Math.asin(clamp(2*(q.x*q.y+q.z*q.w)))}else if(order==="XZY"){this.x=Math.atan2(2*(q.x*q.w+q.y*q.z),sqw-sqx+sqy-sqz);this.y=Math.atan2(2*(q.x*q.z+q.y*q.w),sqw+sqx-sqy-sqz);this.z=Math.asin(clamp(2*(q.z*q.w-q.x*q.y)))}return this},getPositionFromMatrix:function(m){this.x=m.elements[12];this.y=m.elements[13];this.z=m.elements[14];return this},getScaleFromMatrix:function(m){var sx=this.set(m.elements[0],m.elements[1],m.elements[2]).length();var sy=this.set(m.elements[4],m.elements[5],m.elements[6]).length();var sz=this.set(m.elements[8],m.elements[9],m.elements[10]).length();this.x=sx;this.y=sy;this.z=sz;return this},getColumnFromMatrix:function(index,matrix){var offset=index*4;var me=matrix.elements;this.x=me[offset];this.y=me[offset+1];this.z=me[offset+2];return this},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z},fromArray:function(array){this.x=array[0];this.y=array[1];this.z=array[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var q1=new THREE.Quaternion;return function(v,eulerOrder){var quaternion=q1.setFromEuler(v,eulerOrder);this.applyQuaternion(quaternion);return this}}(),applyAxisAngle:function(){var q1=new THREE.Quaternion;return function(axis,angle){var quaternion=q1.setFromAxisAngle(axis,angle);this.applyQuaternion(quaternion);return this}}(),projectOnVector:function(){var v1=new THREE.Vector3;return function(vector){v1.copy(vector).normalize();var d=this.dot(v1);return this.copy(v1).multiplyScalar(d)}}(),projectOnPlane:function(){var v1=new THREE.Vector3;return function(planeNormal){v1.copy(this).projectOnVector(planeNormal);return this.sub(v1)}}(),reflect:function(){var v1=new THREE.Vector3;return function(vector){v1.copy(this).projectOnVector(vector).multiplyScalar(2);return this.subVectors(v1,this)}}()});global.v3=function(x,y,z){if(typeof x.x!="undefined")return new THREE.Vector3(x.x,x.y,x.z);return new THREE.Vector3(x,y,z)};module.exports=THREE.Vector3})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../node_modules/three_vector3.js","/../node_modules")},{__browserify_process:1,__browserify_buffer:2}],31:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){var objToFunc,each,map,filter,reject,partition,find,first,head,tail,last,initial,empty,values,keys,length,cons,append,join,reverse,foldl,fold,foldl1,fold1,foldr,foldr1,unfoldr,andList,orList,any,all,unique,sort,sortBy,compare,sum,product,average,mean,concat,concatMap,listToObj,maximum,minimum,scanl,scan,scanl1,scan1,scanr,scanr1,replicate,take,drop,splitAt,takeWhile,dropWhile,span,breakIt,zip,zipWith,zipAll,zipAllWith,compose,curry,id,flip,fix,lines,unlines,words,unwords,max,min,negate,abs,signum,quot,rem,div,mod,recip,pi,tau,exp,sqrt,ln,pow,sin,tan,cos,asin,acos,atan,atan2,truncate,round,ceiling,floor,isItNaN,even,odd,gcd,lcm,toString$={}.toString,slice$=[].slice;exports.objToFunc=objToFunc=function(obj){return function(key){return obj[key]}};exports.each=each=curry$(function(f,xs){var i$,x,len$;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];f(x)}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];f(x)}}return xs});exports.map=map=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];results$[key]=f(x)}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];res$.push(f(x))}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.filter=filter=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];if(f(x)){results$[key]=x}}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(f(x)){res$.push(x)}}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.reject=reject=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];if(!f(x)){results$[key]=x}}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!f(x)){res$.push(x)}}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.partition=partition=curry$(function(f,xs){var type,passed,failed,key,x,i$,len$;if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){passed={};failed={};for(key in xs){x=xs[key];(f(x)?passed:failed)[key]=x}}else{passed=[];failed=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];(f(x)?passed:failed).push(x)}if(type==="String"){passed=passed.join("");failed=failed.join("")}}return[passed,failed]});exports.find=find=curry$(function(f,xs){var i$,x,len$;if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];if(f(x)){return x}}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(f(x)){return x}}}});exports.head=head=exports.first=first=function(xs){if(!xs.length){return}return xs[0]};exports.tail=tail=function(xs){if(!xs.length){return}return xs.slice(1)};exports.last=last=function(xs){if(!xs.length){return}return xs[xs.length-1]};exports.initial=initial=function(xs){if(!xs.length){return}return xs.slice(0,xs.length-1)};exports.empty=empty=function(xs){var x;if(toString$.call(xs).slice(8,-1)==="Object"){for(x in xs){return false}return true}return!xs.length};exports.values=values=function(obj){var i$,x,results$=[];for(i$ in obj){x=obj[i$];results$.push(x)}return results$};exports.keys=keys=function(obj){var x,results$=[];for(x in obj){results$.push(x)}return results$};exports.length=length=function(xs){if(toString$.call(xs).slice(8,-1)==="Object"){xs=values(xs)}return xs.length};exports.cons=cons=curry$(function(x,xs){if(toString$.call(xs).slice(8,-1)==="String"){return x+xs}else{return[x].concat(xs)}});exports.append=append=curry$(function(xs,ys){if(toString$.call(ys).slice(8,-1)==="String"){return xs+ys}else{return xs.concat(ys)}});exports.join=join=curry$(function(sep,xs){if(toString$.call(xs).slice(8,-1)==="Object"){xs=values(xs)}return xs.join(sep)});exports.reverse=reverse=function(xs){if(toString$.call(xs).slice(8,-1)==="String"){return xs.split("").reverse().join("")}else{return xs.slice().reverse()}};exports.fold=fold=exports.foldl=foldl=curry$(function(f,memo,xs){var i$,x,len$;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];memo=f(memo,x)}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];memo=f(memo,x)}}return memo});exports.fold1=fold1=exports.foldl1=foldl1=curry$(function(f,xs){return fold(f,xs[0],xs.slice(1))});exports.foldr=foldr=curry$(function(f,memo,xs){return fold(f,memo,xs.reverse())});exports.foldr1=foldr1=curry$(function(f,xs){xs.reverse();return fold(f,xs[0],xs.slice(1))});exports.unfoldr=exports.unfold=unfoldr=curry$(function(f,b){var that;if((that=f(b))!=null){return[that[0]].concat(unfoldr(f,that[1]))}else{return[]}});exports.andList=andList=function(xs){return fold(function(memo,x){return memo&&x},true,xs)};exports.orList=orList=function(xs){return fold(function(memo,x){return memo||x},false,xs)};exports.any=any=curry$(function(f,xs){if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}return fold(function(memo,x){return memo||f(x)},false,xs)});exports.all=all=curry$(function(f,xs){if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}return fold(function(memo,x){return memo&&f(x)},true,xs)});exports.unique=unique=function(xs){var result,i$,x,len$;result=[];if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];if(!in$(x,result)){result.push(x)}}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!in$(x,result)){result.push(x)}}}if(toString$.call(xs).slice(8,-1)==="String"){return result.join("")}else{return result}};exports.sort=sort=function(xs){return xs.concat().sort(function(x,y){switch(false){case!(x>y):return 1;case!(x<y):return-1;default:return 0}})};exports.sortBy=sortBy=curry$(function(f,xs){if(!xs.length){return[]}return xs.concat().sort(f)});exports.compare=compare=curry$(function(f,x,y){switch(false){case!(f(x)>f(y)):return 1;case!(f(x)<f(y)):return-1;default:return 0}});exports.sum=sum=function(xs){var result,i$,x,len$;result=0;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];result+=x}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result+=x}}return result};exports.product=product=function(xs){var result,i$,x,len$;result=1;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];result*=x}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result*=x}}return result};exports.mean=mean=exports.average=average=function(xs){return sum(xs)/length(xs)};exports.concat=concat=function(xss){return fold(append,[],xss)};exports.concatMap=concatMap=curry$(function(f,xs){return concat(map(f,xs))});exports.listToObj=listToObj=function(xs){var result,i$,len$,x;result={};for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result[x[0]]=x[1]}return result};exports.maximum=maximum=function(xs){return fold1(max,xs)};exports.minimum=minimum=function(xs){return fold1(min,xs)};exports.scan=scan=exports.scanl=scanl=curry$(function(f,memo,xs){var last,x;last=memo;if(toString$.call(xs).slice(8,-1)==="Object"){return[memo].concat(function(){var i$,ref$,results$=[];for(i$ in ref$=xs){x=ref$[i$];results$.push(last=f(last,x))}return results$}())}else{return[memo].concat(function(){var i$,ref$,len$,results$=[];for(i$=0,len$=(ref$=xs).length;i$<len$;++i$){x=ref$[i$];results$.push(last=f(last,x))}return results$}())}});exports.scan1=scan1=exports.scanl1=scanl1=curry$(function(f,xs){return scan(f,xs[0],xs.slice(1))});exports.scanr=scanr=curry$(function(f,memo,xs){xs.reverse();return scan(f,memo,xs).reverse()});exports.scanr1=scanr1=curry$(function(f,xs){xs.reverse();return scan(f,xs[0],xs.slice(1)).reverse()});exports.replicate=replicate=curry$(function(n,x){var result,i;result=[];i=0;for(;i<n;++i){result.push(x)}return result});exports.take=take=curry$(function(n,xs){switch(false){case!(n<=0):if(toString$.call(xs).slice(8,-1)==="String"){return""}else{return[]}break;case!!xs.length:return xs;default:return xs.slice(0,n)}});exports.drop=drop=curry$(function(n,xs){switch(false){case!(n<=0):return xs;case!!xs.length:return xs;default:return xs.slice(n)}});exports.splitAt=splitAt=curry$(function(n,xs){return[take(n,xs),drop(n,xs)]});exports.takeWhile=takeWhile=curry$(function(p,xs){var result,i$,len$,x;if(!xs.length){return xs}if(toString$.call(p).slice(8,-1)!=="Function"){p=objToFunc(p)}result=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!p(x)){break}result.push(x)}if(toString$.call(xs).slice(8,-1)==="String"){return result.join("")}else{return result}});exports.dropWhile=dropWhile=curry$(function(p,xs){var i,i$,len$,x;if(!xs.length){return xs}if(toString$.call(p).slice(8,-1)!=="Function"){p=objToFunc(p)}i=0;for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!p(x)){break}++i}return drop(i,xs)});exports.span=span=curry$(function(p,xs){return[takeWhile(p,xs),dropWhile(p,xs)]});exports.breakIt=breakIt=curry$(function(p,xs){return span(compose$([not$,p]),xs)});exports.zip=zip=curry$(function(xs,ys){var result,i,ref$,len$,zs,j,len1$,z,ref1$;result=[];for(i=0,len$=(ref$=[xs,ys]).length;i<len$;++i){zs=ref$[i];for(j=0,len1$=zs.length;j<len1$;++j){z=zs[j];if(i===0){result.push([])}if((ref1$=result[j])!=null){ref1$.push(z)}}}return result});exports.zipWith=zipWith=curry$(function(f,xs,ys){var i$,ref$,len$,zs,results$=[];if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(!xs.length||!ys.length){return[]}else{for(i$=0,len$=(ref$=zip.call(this,xs,ys)).length;i$<len$;++i$){zs=ref$[i$];results$.push(f.apply(this,zs))}return results$}});exports.zipAll=zipAll=function(){var xss,result,i,len$,xs,j,len1$,x,ref$;xss=slice$.call(arguments);result=[];for(i=0,len$=xss.length;i<len$;++i){xs=xss[i];for(j=0,len1$=xs.length;j<len1$;++j){x=xs[j];if(i===0){result.push([])}if((ref$=result[j])!=null){ref$.push(x)}}}return result};exports.zipAllWith=zipAllWith=function(f){var xss,i$,ref$,len$,xs,results$=[];xss=slice$.call(arguments,1);if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(!xss[0].length||!xss[1].length){return[]}else{for(i$=0,len$=(ref$=zipAll.apply(this,xss)).length;i$<len$;++i$){xs=ref$[i$];results$.push(f.apply(this,xs))}return results$}};exports.compose=compose=function(){var funcs;funcs=slice$.call(arguments);return function(){var args,i$,ref$,len$,f;args=arguments;for(i$=0,len$=(ref$=funcs).length;i$<len$;++i$){f=ref$[i$];args=[f.apply(this,args)]}return args[0]}};exports.curry=curry=function(f){return curry$(f)};exports.id=id=function(x){return x};exports.flip=flip=curry$(function(f,x,y){return f(y,x)});exports.fix=fix=function(f){return function(g,x){return function(){return f(g(g)).apply(null,arguments)}}(function(g,x){return function(){return f(g(g)).apply(null,arguments)}})};exports.lines=lines=function(str){if(!str.length){return[]}return str.split("\n")};exports.unlines=unlines=function(strs){return strs.join("\n")};exports.words=words=function(str){if(!str.length){return[]}return str.split(/[ ]+/)};exports.unwords=unwords=function(strs){return strs.join(" ")};exports.max=max=curry$(function(x,y){if(x>y){return x}else{return y}});exports.min=min=curry$(function(x,y){if(x>y){return y}else{return x}});exports.negate=negate=function(x){return-x};exports.abs=abs=Math.abs;exports.signum=signum=function(x){switch(false){case!(x<0):return-1;case!(x>0):return 1;default:return 0}};exports.quot=quot=curry$(function(x,y){return~~(x/y)});exports.rem=rem=curry$(function(x,y){return x%y});exports.div=div=curry$(function(x,y){return Math.floor(x/y)});exports.mod=mod=curry$(function(x,y){var ref$;return(x%(ref$=y)+ref$)%ref$});exports.recip=recip=function(x){return 1/x};exports.pi=pi=Math.PI;exports.tau=tau=pi*2;exports.exp=exp=Math.exp;exports.sqrt=sqrt=Math.sqrt;exports.ln=ln=Math.log;exports.pow=pow=curry$(function(x,y){return Math.pow(x,y)});exports.sin=sin=Math.sin;exports.tan=tan=Math.tan;exports.cos=cos=Math.cos;exports.asin=asin=Math.asin;exports.acos=acos=Math.acos;exports.atan=atan=Math.atan;exports.atan2=atan2=curry$(function(x,y){return Math.atan2(x,y)});exports.truncate=truncate=function(x){return~~x};exports.round=round=Math.round;exports.ceiling=ceiling=Math.ceil;exports.floor=floor=Math.floor;exports.isItNaN=isItNaN=function(x){return x!==x};exports.even=even=function(x){return x%2===0};exports.odd=odd=function(x){return x%2!==0};exports.gcd=gcd=curry$(function(x,y){var z;x=Math.abs(x);y=Math.abs(y);while(y!==0){z=x%y;x=y;y=z}return x});exports.lcm=lcm=curry$(function(x,y){return Math.abs(Math.floor(x/gcd(x,y)*y))});exports.installPrelude=function(target){var ref$;if(!((ref$=target.prelude)!=null&&ref$.isInstalled)){import$(target,exports);target.prelude.isInstalled=true}};exports.prelude=exports;function curry$(f,args){return f.length>1?function(){var params=args?args.concat():[];return params.push.apply(params,arguments)<f.length&&arguments.length?curry$.call(this,f,params):f.apply(this,params)}:f}function in$(x,arr){var i=0,l=arr.length>>>0;while(i<l)if(x===arr[i++])return true;return false}function compose$(fs){return function(){var i,args=arguments;for(i=fs.length;i>0;--i){args=[fs[i-1].apply(this,args)]}return args[0]}}function not$(x){return!x}function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/node_modules/prelude-ls/prelude.js","/node_modules/prelude-ls")},{__browserify_process:1,__browserify_buffer:2}],32:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){(function(window){var undefined;var freeExports=typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){window=freeGlobal}var idCounter=0;var indicatorObject={};var keyPrefix=+new Date+"";var largeArraySize=200;var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reInterpolate=/<%=([\s\S]+?)%>/g;var whitespace=" 	\f ﻿"+"\n\r\u2028\u2029"+" ᠎             　";var reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)");var reNoMatch=/($^)/;var reUnescapedHtml=/[&<>"']/g;var reUnescapedString=/['\n\r\t\u2028\u2029\\]/g;var contextProps=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"];var templateCounter=0;var argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]";var cloneableClasses={};cloneableClasses[funcClass]=false;cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=true;var objectTypes={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};function runInContext(context){context=context?_.defaults(window.Object(),context,_.pick(window,contextProps)):window;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayRef=Array(),objectRef=Object();var oldDash=context._;var reNative=RegExp("^"+String(objectRef.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$");var ceil=Math.ceil,clearTimeout=context.clearTimeout,concat=arrayRef.concat,floor=Math.floor,getPrototypeOf=reNative.test(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectRef.hasOwnProperty,push=arrayRef.push,setImmediate=context.setImmediate,setTimeout=context.setTimeout,toString=objectRef.toString;var nativeBind=reNative.test(nativeBind=toString.bind)&&nativeBind,nativeIsArray=reNative.test(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=reNative.test(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeSlice=arrayRef.slice;var isIeOpera=reNative.test(context.attachEvent),isV8=nativeBind&&!/\n|true/.test(nativeBind+isIeOpera);var ctorByClass={};ctorByClass[arrayClass]=Array;ctorByClass[boolClass]=Boolean;ctorByClass[dateClass]=Date;ctorByClass[objectClass]=Object;ctorByClass[numberClass]=Number;ctorByClass[regexpClass]=RegExp;ctorByClass[stringClass]=String;function lodash(value){return value&&typeof value=="object"&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)}var support=lodash.support={};support.fastBind=nativeBind&&!isV8;lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};function cachedContains(array){var length=array.length,isLarge=length>=largeArraySize;if(isLarge){var cache={},index=-1;while(++index<length){var key=keyPrefix+array[index];(cache[key]||(cache[key]=[])).push(array[index])}}return function(value){if(isLarge){var key=keyPrefix+value;return cache[key]&&indexOf(cache[key],value)>-1}return indexOf(array,value)>-1}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){var ai=a.index,bi=b.index;a=a.criteria;b=b.criteria;if(a!==b){if(a>b||typeof a=="undefined"){return 1}if(a<b||typeof b=="undefined"){return-1}}return ai<bi?-1:1}function createBound(func,thisArg,partialArgs,indicator){var isFunc=isFunction(func),isPartial=!partialArgs,key=thisArg;if(isPartial){var rightIndicator=indicator;partialArgs=thisArg}else if(!isFunc){if(!indicator){throw new TypeError}thisArg=func}function bound(){var args=arguments,thisBinding=isPartial?this:thisArg;if(!isFunc){func=thisArg[key]}if(partialArgs.length){args=args.length?(args=nativeSlice.call(args),rightIndicator?args.concat(partialArgs):partialArgs.concat(args)):partialArgs}if(this instanceof bound){noop.prototype=func.prototype;thisBinding=new noop;noop.prototype=null;var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}return bound}function escapeStringChar(match){return"\\"+stringEscapes[match]}function escapeHtmlChar(match){return htmlEscapes[match]}function lodashWrapper(value){this.__wrapped__=value}lodashWrapper.prototype=lodash.prototype;function noop(){}function shimIsPlainObject(value){var result=false;if(!(value&&toString.call(value)==objectClass)){return result}var ctor=value.constructor;if(isFunction(ctor)?ctor instanceof ctor:true){forIn(value,function(value,key){result=key});return result===false||hasOwnProperty.call(value,result)}return result}function slice(array,start,end){start||(start=0);if(typeof end=="undefined"){end=array?array.length:0}var index=-1,length=end-start||0,result=Array(length<0?0:length);while(++index<length){result[index]=array[start+index]}return result}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return toString.call(value)==argsClass}var isArray=nativeIsArray;var shimKeys=function(object){var index,iterable=object,result=[];if(!iterable)return result;if(!objectTypes[typeof object])return result;for(index in iterable){if(hasOwnProperty.call(iterable,index)){result.push(index)}}return result};var keys=!nativeKeys?shimKeys:function(object){if(!isObject(object)){return[]}return nativeKeys(object)};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var htmlUnescapes=invert(htmlEscapes);var assign=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;if(argsLength>3&&typeof args[argsLength-2]=="function"){var callback=lodash.createCallback(args[--argsLength-1],args[argsLength--],2)}else if(argsLength>2&&typeof args[argsLength-1]=="function"){callback=args[--argsLength]}while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var length=iterable.length;index=-1;if(isArray(iterable)){while(++index<length){result[index]=callback?callback(result[index],iterable[index]):iterable[index]}}else{var ownIndex=-1,ownProps=objectTypes[typeof iterable]?keys(iterable):[],length=ownProps.length;while(++ownIndex<length){index=ownProps[ownIndex];result[index]=callback?callback(result[index],iterable[index]):iterable[index]}}}}return result};function clone(value,deep,callback,thisArg,stackA,stackB){var result=value;if(typeof deep=="function"){thisArg=callback;callback=deep;deep=false}if(typeof callback=="function"){callback=typeof thisArg=="undefined"?callback:lodash.createCallback(callback,thisArg,1);result=callback(result);if(typeof result!="undefined"){return result}result=value}var isObj=isObject(result);if(isObj){var className=toString.call(result);if(!cloneableClasses[className]){return result}var isArr=isArray(result)}if(!isObj||!deep){return isObj?isArr?slice(result):assign({},result):result}var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+result);case numberClass:case stringClass:return new ctor(result);case regexpClass:return ctor(result.source,reFlags.exec(result))}stackA||(stackA=[]);stackB||(stackB=[]);var length=stackA.length;while(length--){if(stackA[length]==value){return stackB[length]}}result=isArr?ctor(result.length):{};if(isArr){if(hasOwnProperty.call(value,"index")){result.index=value.index}if(hasOwnProperty.call(value,"input")){result.input=value.input}}stackA.push(value);stackB.push(result);(isArr?forEach:forOwn)(value,function(objValue,key){result[key]=clone(objValue,deep,callback,undefined,stackA,stackB)});return result}function cloneDeep(value,callback,thisArg){return clone(value,true,callback,thisArg)}var defaults=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var length=iterable.length;index=-1;if(isArray(iterable)){while(++index<length){if(typeof result[index]=="undefined")result[index]=iterable[index]}}else{var ownIndex=-1,ownProps=objectTypes[typeof iterable]?keys(iterable):[],length=ownProps.length;while(++ownIndex<length){index=ownProps[ownIndex];if(typeof result[index]=="undefined")result[index]=iterable[index]}}}}return result};function findKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg);forOwn(object,function(value,key,object){if(callback(value,key,object)){result=key;return false}});return result}var forIn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:lodash.createCallback(callback,thisArg);for(index in iterable){if(callback(iterable[index],index,collection)===false)return result}return result};var forOwn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:lodash.createCallback(callback,thisArg);var ownIndex=-1,ownProps=objectTypes[typeof iterable]?keys(iterable):[],length=ownProps.length;while(++ownIndex<length){index=ownProps[ownIndex];if(callback(iterable[index],index,collection)===false)return result}return result};function functions(object){var result=[];forIn(object,function(value,key){if(isFunction(value)){result.push(key)}});return result.sort()}function has(object,property){return object?hasOwnProperty.call(object,property):false}function invert(object){var index=-1,props=keys(object),length=props.length,result={};while(++index<length){var key=props[index];
result[object[key]]=key}return result}function isBoolean(value){return value===true||value===false||toString.call(value)==boolClass}function isDate(value){return value?typeof value=="object"&&toString.call(value)==dateClass:false}function isElement(value){return value?value.nodeType===1:false}function isEmpty(value){var result=true;if(!value){return result}var className=toString.call(value),length=value.length;if(className==arrayClass||className==stringClass||className==argsClass||className==objectClass&&typeof length=="number"&&isFunction(value.splice)){return!length}forOwn(value,function(){return result=false});return result}function isEqual(a,b,callback,thisArg,stackA,stackB){var whereIndicator=callback===indicatorObject;if(typeof callback=="function"&&!whereIndicator){callback=lodash.createCallback(callback,thisArg,2);var result=callback(a,b);if(typeof result!="undefined"){return!!result}}if(a===b){return a!==0||1/a==1/b}var type=typeof a,otherType=typeof b;if(a===a&&(!a||type!="function"&&type!="object")&&(!b||otherType!="function"&&otherType!="object")){return false}if(a==null||b==null){return a===b}var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass){className=objectClass}if(otherClass==argsClass){otherClass=objectClass}if(className!=otherClass){return false}switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){if(hasOwnProperty.call(a,"__wrapped__ ")||hasOwnProperty.call(b,"__wrapped__")){return isEqual(a.__wrapped__||a,b.__wrapped__||b,callback,thisArg,stackA,stackB)}if(className!=objectClass){return false}var ctorA=a.constructor,ctorB=b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)){return false}}stackA||(stackA=[]);stackB||(stackB=[]);var length=stackA.length;while(length--){if(stackA[length]==a){return stackB[length]==b}}var size=0;result=true;stackA.push(a);stackB.push(b);if(isArr){length=a.length;size=b.length;result=size==a.length;if(!result&&!whereIndicator){return result}while(size--){var index=length,value=b[size];if(whereIndicator){while(index--){if(result=isEqual(a[index],value,callback,thisArg,stackA,stackB)){break}}}else if(!(result=isEqual(a[size],value,callback,thisArg,stackA,stackB))){break}}return result}forIn(b,function(value,key,b){if(hasOwnProperty.call(b,key)){size++;return result=hasOwnProperty.call(a,key)&&isEqual(a[key],value,callback,thisArg,stackA,stackB)}});if(result&&!whereIndicator){forIn(a,function(value,key,a){if(hasOwnProperty.call(a,key)){return result=--size>-1}})}return result}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return typeof value=="function"}function isObject(value){return value?objectTypes[typeof value]:false}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return value===null}function isNumber(value){return typeof value=="number"||toString.call(value)==numberClass}var isPlainObject=function(value){if(!(value&&toString.call(value)==objectClass)){return false}var valueOf=value.valueOf,objProto=typeof valueOf=="function"&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)};function isRegExp(value){return value?typeof value=="object"&&toString.call(value)==regexpClass:false}function isString(value){return typeof value=="string"||toString.call(value)==stringClass}function isUndefined(value){return typeof value=="undefined"}function merge(object,source,deepIndicator){var args=arguments,index=0,length=2;if(!isObject(object)){return object}if(deepIndicator===indicatorObject){var callback=args[3],stackA=args[4],stackB=args[5]}else{stackA=[];stackB=[];if(typeof deepIndicator!="number"){length=args.length}if(length>3&&typeof args[length-2]=="function"){callback=lodash.createCallback(args[--length-1],args[length--],2)}else if(length>2&&typeof args[length-1]=="function"){callback=args[--length]}}while(++index<length){(isArray(args[index])?forEach:forOwn)(args[index],function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){var stackLength=stackA.length;while(stackLength--){if(found=stackA[stackLength]==source){value=stackB[stackLength];break}}if(!found){var isShallow;if(callback){result=callback(value,source);if(isShallow=typeof result!="undefined"){value=result}}if(!isShallow){value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}}stackA.push(source);stackB.push(value);if(!isShallow){value=merge(value,source,indicatorObject,callback,stackA,stackB)}}}else{if(callback){result=callback(value,source);if(typeof result=="undefined"){result=source}}if(typeof result!="undefined"){value=result}}object[key]=value})}return object}function omit(object,callback,thisArg){var isFunc=typeof callback=="function",result={};if(isFunc){callback=lodash.createCallback(callback,thisArg)}else{var props=concat.apply(arrayRef,nativeSlice.call(arguments,1))}forIn(object,function(value,key,object){if(isFunc?!callback(value,key,object):indexOf(props,key)<0){result[key]=value}});return result}function pairs(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if(typeof callback!="function"){var index=-1,props=concat.apply(arrayRef,nativeSlice.call(arguments,1)),length=isObject(object)?props.length:0;while(++index<length){var key=props[index];if(key in object){result[key]=object[key]}}}else{callback=lodash.createCallback(callback,thisArg);forIn(object,function(value,key,object){if(callback(value,key,object)){result[key]=value}})}return result}function values(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){result[index]=object[props[index]]}return result}function at(collection){var index=-1,props=concat.apply(arrayRef,nativeSlice.call(arguments,1)),length=props.length,result=Array(length);while(++index<length){result[index]=collection[props[index]]}return result}function contains(collection,target,fromIndex){var index=-1,length=collection?collection.length:0,result=false;fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex)||0;if(typeof length=="number"){result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1}else{forOwn(collection,function(value){if(++index>=fromIndex){return!(result=value===target)}})}return result}function countBy(collection,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg);forEach(collection,function(value,key,collection){key=String(callback(value,key,collection));hasOwnProperty.call(result,key)?result[key]++:result[key]=1});return result}function every(collection,callback,thisArg){var result=true;callback=lodash.createCallback(callback,thisArg);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(!(result=!!callback(collection[index],index,collection))){break}}}else{forOwn(collection,function(value,index,collection){return result=!!callback(value,index,collection)})}return result}function filter(collection,callback,thisArg){var result=[];callback=lodash.createCallback(callback,thisArg);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){result.push(value)}}}else{forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result.push(value)}})}return result}function find(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){return value}}}else{var result;forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return false}});return result}}function forEach(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=callback&&typeof thisArg=="undefined"?callback:lodash.createCallback(callback,thisArg);if(typeof length=="number"){while(++index<length){if(callback(collection[index],index,collection)===false){break}}}else{forOwn(collection,callback)}return collection}function groupBy(collection,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg);forEach(collection,function(value,key,collection){key=String(callback(value,key,collection));(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)});return result}function invoke(collection,methodName){var args=nativeSlice.call(arguments,2),index=-1,isFunc=typeof methodName=="function",length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)});return result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=lodash.createCallback(callback,thisArg);if(typeof length=="number"){var result=Array(length);while(++index<length){result[index]=callback(collection[index],index,collection)}}else{result=[];forOwn(collection,function(value,key,collection){result[++index]=callback(value,key,collection)})}return result}function max(collection,callback,thisArg){var computed=-Infinity,result=computed;if(!callback&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value>result){result=value}}}else{callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current>computed){computed=current;result=value}})}return result}function min(collection,callback,thisArg){var computed=Infinity,result=computed;if(!callback&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value<result){result=value}}}else{callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current<computed){computed=current;result=value}})}return result}function pluck(collection,property){var index=-1,length=collection?collection.length:0;if(typeof length=="number"){var result=Array(length);while(++index<length){result[index]=collection[index][property]}}return result||map(collection,property)}function reduce(collection,callback,accumulator,thisArg){if(!collection)return accumulator;var noaccum=arguments.length<3;callback=lodash.createCallback(callback,thisArg,4);var index=-1,length=collection.length;if(typeof length=="number"){if(noaccum){accumulator=collection[++index]}while(++index<length){accumulator=callback(accumulator,collection[index],index,collection)}}else{forOwn(collection,function(value,index,collection){accumulator=noaccum?(noaccum=false,value):callback(accumulator,value,index,collection)})}return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var iterable=collection,length=collection?collection.length:0,noaccum=arguments.length<3;if(typeof length!="number"){var props=keys(collection);length=props.length}callback=lodash.createCallback(callback,thisArg,4);forEach(collection,function(value,index,collection){index=props?props[--length]:--length;accumulator=noaccum?(noaccum=false,iterable[index]):callback(accumulator,iterable[index],index,collection)});return accumulator}function reject(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg);return filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){var rand=floor(nativeRandom()*(++index+1));result[index]=result[rand];result[rand]=value});return result}function size(collection){var length=collection?collection.length:0;return typeof length=="number"?length:keys(collection).length}function some(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(result=callback(collection[index],index,collection)){break}}}else{forOwn(collection,function(value,index,collection){return!(result=callback(value,index,collection))})}return!!result}function sortBy(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);callback=lodash.createCallback(callback,thisArg);forEach(collection,function(value,key,collection){result[++index]={criteria:callback(value,key,collection),index:index,value:value}});length=result.length;result.sort(compareAscending);while(length--){result[length]=result[length].value}return result}function toArray(collection){if(collection&&typeof collection.length=="number"){return slice(collection)}return values(collection)}var where=filter;function compact(array){var index=-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value){result.push(value)}}return result}function difference(array){var index=-1,length=array?array.length:0,flattened=concat.apply(arrayRef,nativeSlice.call(arguments,1)),contains=cachedContains(flattened),result=[];while(++index<length){var value=array[index];if(!contains(value)){result.push(value)}}return result}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg);while(++index<length){if(callback(array[index],index,array)){return index}}return-1}function first(array,callback,thisArg){if(array){var n=0,length=array.length;if(typeof callback!="number"&&callback!=null){var index=-1;callback=lodash.createCallback(callback,thisArg);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array[0]}}return slice(array,0,nativeMin(nativeMax(0,n),length))}}function flatten(array,isShallow,callback,thisArg){var index=-1,length=array?array.length:0,result=[];if(typeof isShallow!="boolean"&&isShallow!=null){thisArg=callback;callback=isShallow;isShallow=false}if(callback!=null){callback=lodash.createCallback(callback,thisArg)}while(++index<length){var value=array[index];if(callback){value=callback(value,index,array)}if(isArray(value)){push.apply(result,isShallow?value:flatten(value))}else{result.push(value)}}return result}function indexOf(array,value,fromIndex){var index=-1,length=array?array.length:0;if(typeof fromIndex=="number"){index=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex||0)-1}else if(fromIndex){index=sortedIndex(array,value);return array[index]===value?index:-1}while(++index<length){if(array[index]===value){return index}}return-1}function initial(array,callback,thisArg){if(!array){return[]}var n=0,length=array.length;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg);while(index--&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:callback||n}return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(array){var args=arguments,argsLength=args.length,cache={0:{}},index=-1,length=array?array.length:0,isLarge=length>=largeArraySize,result=[],seen=result;outer:while(++index<length){var value=array[index];if(isLarge){var key=keyPrefix+value;var inited=cache[0][key]?!(seen=cache[0][key]):seen=cache[0][key]=[]}if(inited||indexOf(seen,value)<0){if(isLarge){seen.push(value)}var argsIndex=argsLength;while(--argsIndex){if(!(cache[argsIndex]||(cache[argsIndex]=cachedContains(args[argsIndex])))(value)){continue outer}}result.push(value)}}return result}function last(array,callback,thisArg){if(array){var n=0,length=array.length;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg);while(index--&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array[length-1]}}return slice(array,nativeMax(0,length-n))}}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;if(typeof fromIndex=="number"){index=(fromIndex<0?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1}while(index--){if(array[index]===value){return index}}return-1}function range(start,end,step){start=+start||0;step=+step||1;if(end==null){end=start;start=0}var index=-1,length=nativeMax(0,ceil((end-start)/step)),result=Array(length);while(++index<length){result[index]=start;start+=step}return result}function rest(array,callback,thisArg){if(typeof callback!="number"&&callback!=null){var n=0,index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:nativeMax(0,callback)}return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;callback=callback?lodash.createCallback(callback,thisArg,1):identity;value=callback(value);while(low<high){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(array){if(!isArray(array)){arguments[0]=array?nativeSlice.call(array):arrayRef}return uniq(concat.apply(arrayRef,arguments))}function uniq(array,isSorted,callback,thisArg){var index=-1,length=array?array.length:0,result=[],seen=result;if(typeof isSorted!="boolean"&&isSorted!=null){thisArg=callback;callback=isSorted;isSorted=false}var isLarge=!isSorted&&length>=largeArraySize;if(isLarge){var cache={}}if(callback!=null){seen=[];callback=lodash.createCallback(callback,thisArg)}while(++index<length){var value=array[index],computed=callback?callback(value,index,array):value;if(isLarge){var key=keyPrefix+computed;var inited=cache[key]?!(seen=cache[key]):seen=cache[key]=[]}if(isSorted?!index||seen[seen.length-1]!==computed:inited||indexOf(seen,computed)<0){if(callback||isLarge){seen.push(computed)}result.push(value)}}return result}function unzip(array){var index=-1,length=array?array.length:0,tupleLength=length?max(pluck(array,"length")):0,result=Array(tupleLength);while(++index<length){var tupleIndex=-1,tuple=array[index];while(++tupleIndex<tupleLength){(result[tupleIndex]||(result[tupleIndex]=Array(length)))[index]=tuple[tupleIndex]}}return result}function without(array){return difference(array,nativeSlice.call(arguments,1))}function zip(array){var index=-1,length=array?max(pluck(arguments,"length")):0,result=Array(length);while(++index<length){result[index]=pluck(arguments,index)}return result}function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};while(++index<length){var key=keys[index];if(values){result[key]=values[index]}else{result[key[0]]=key[1]}}return result}function after(n,func){if(n<1){return func()}return function(){if(--n<1){return func.apply(this,arguments)}}}function bind(func,thisArg){return support.fastBind||nativeBind&&arguments.length>2?nativeBind.call.apply(nativeBind,arguments):createBound(func,thisArg,nativeSlice.call(arguments,2))}function bindAll(object){var funcs=arguments.length>1?concat.apply(arrayRef,nativeSlice.call(arguments,1)):functions(object),index=-1,length=funcs.length;while(++index<length){var key=funcs[index];object[key]=bind(object[key],object)}return object}function bindKey(object,key){return createBound(object,key,nativeSlice.call(arguments,2),indicatorObject)}function compose(){var funcs=arguments;return function(){var args=arguments,length=funcs.length;while(length--){args=[funcs[length].apply(this,args)]}return args[0]}}function createCallback(func,thisArg,argCount){if(func==null){return identity}var type=typeof func;if(type!="function"){if(type!="object"){return function(object){return object[func]}}var props=keys(func);return function(object){var length=props.length,result=false;while(length--){if(!(result=isEqual(object[props[length]],func[props[length]],indicatorObject))){break}}return result}}if(typeof thisArg!="undefined"){if(argCount===1){return function(value){return func.call(thisArg,value)}}if(argCount===2){return function(a,b){return func.call(thisArg,a,b)}}if(argCount===4){return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return function(value,index,collection){return func.call(thisArg,value,index,collection)}}return func}function debounce(func,wait,options){var args,inited,result,thisArg,timeoutId,trailing=true;function delayed(){inited=timeoutId=null;if(trailing){result=func.apply(thisArg,args)}}if(options===true){var leading=true;trailing=false}else if(options&&objectTypes[typeof options]){leading=options.leading;trailing="trailing"in options?options.trailing:trailing}return function(){args=arguments;thisArg=this;clearTimeout(timeoutId);if(!inited&&leading){inited=true;result=func.apply(thisArg,args)}else{timeoutId=setTimeout(delayed,wait)}return result}}function defer(func){var args=nativeSlice.call(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}if(isV8&&freeModule&&typeof setImmediate=="function"){defer=bind(setImmediate,context)}function delay(func,wait){var args=nativeSlice.call(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){var cache={};return function(){var key=keyPrefix+(resolver?resolver.apply(this,arguments):arguments[0]);return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)}}function once(func){var ran,result;return function(){if(ran){return result}ran=true;result=func.apply(this,arguments);func=null;return result}}function partial(func){return createBound(func,nativeSlice.call(arguments,1))}function partialRight(func){return createBound(func,nativeSlice.call(arguments,1),null,indicatorObject)}function throttle(func,wait,options){var args,result,thisArg,timeoutId,lastCalled=0,leading=true,trailing=true;function trailingCall(){timeoutId=null;if(trailing){lastCalled=new Date;result=func.apply(thisArg,args)}}if(options===false){leading=false}else if(options&&objectTypes[typeof options]){leading="leading"in options?options.leading:leading;trailing="trailing"in options?options.trailing:trailing}return function(){var now=new Date;if(!timeoutId&&!leading){lastCalled=now}var remaining=wait-(now-lastCalled);args=arguments;thisArg=this;if(remaining<=0){clearTimeout(timeoutId);timeoutId=null;lastCalled=now;result=func.apply(thisArg,args)}else if(!timeoutId){timeoutId=setTimeout(trailingCall,remaining)}return result}}function wrap(value,wrapper){return function(){var args=[value];push.apply(args,arguments);return wrapper.apply(this,args)}}function escape(string){return string==null?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object){forEach(functions(object),function(methodName){var func=lodash[methodName]=object[methodName];lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(lodash,args);return value&&typeof value=="object"&&value==result?this:new lodashWrapper(result)}})}function noConflict(){context._=oldDash;return this}var parseInt=nativeParseInt(whitespace+"08")==8?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};function random(min,max){if(min==null&&max==null){max=1}min=+min||0;if(max==null){max=min;min=0}return min+floor(nativeRandom()*((+max||0)-min+1))}function result(object,property){var value=object?object[property]:undefined;return isFunction(value)?object[property]():value}function template(text,data,options){var settings=lodash.templateSettings;text||(text="");options=defaults({},options,settings);var imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports);var isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match});source+="';\n";var variable=options.variable,hasVariable=variable;if(!hasVariable){variable="obj";source="with ("+variable+") {\n"+source+"\n}\n"}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//@ sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){e.source=source;throw e}if(data){return result(data)}result.source=source;return result}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);callback=lodash.createCallback(callback,thisArg,1);while(++index<n){result[index]=callback(index)}return result}function unescape(string){return string==null?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(prefix==null?"":prefix)+id}function tap(value,interceptor){interceptor(value);return value}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}lodash.after=after;lodash.assign=assign;lodash.at=at;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.compact=compact;lodash.compose=compose;lodash.countBy=countBy;lodash.createCallback=createCallback;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.filter=filter;lodash.flatten=flatten;lodash.forEach=forEach;lodash.forIn=forIn;lodash.forOwn=forOwn;lodash.functions=functions;lodash.groupBy=groupBy;lodash.initial=initial;lodash.intersection=intersection;lodash.invert=invert;lodash.invoke=invoke;lodash.keys=keys;lodash.map=map;lodash.max=max;lodash.memoize=memoize;lodash.merge=merge;lodash.min=min;lodash.omit=omit;lodash.once=once;lodash.pairs=pairs;lodash.partial=partial;lodash.partialRight=partialRight;lodash.pick=pick;lodash.pluck=pluck;lodash.range=range;lodash.reject=reject;lodash.rest=rest;lodash.shuffle=shuffle;lodash.sortBy=sortBy;lodash.tap=tap;lodash.throttle=throttle;lodash.times=times;lodash.toArray=toArray;lodash.union=union;lodash.uniq=uniq;lodash.unzip=unzip;lodash.values=values;lodash.where=where;lodash.without=without;lodash.wrap=wrap;lodash.zip=zip;lodash.zipObject=zipObject;lodash.collect=map;lodash.drop=rest;lodash.each=forEach;lodash.extend=assign;lodash.methods=functions;lodash.object=zipObject;lodash.select=filter;lodash.tail=rest;lodash.unique=uniq;mixin(lodash);lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.contains=contains;lodash.escape=escape;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.has=has;lodash.identity=identity;lodash.indexOf=indexOf;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isBoolean=isBoolean;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isNaN=isNaN;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isString=isString;lodash.isUndefined=isUndefined;lodash.lastIndexOf=lastIndexOf;lodash.mixin=mixin;lodash.noConflict=noConflict;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.result=result;lodash.runInContext=runInContext;lodash.size=size;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.template=template;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.all=every;lodash.any=some;lodash.detect=find;lodash.foldl=reduce;lodash.foldr=reduceRight;lodash.include=contains;lodash.inject=reduce;forOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(){var args=[this.__wrapped__];push.apply(args,arguments);return func.apply(lodash,args)}}});lodash.first=first;lodash.last=last;lodash.take=first;lodash.head=first;forOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(callback,thisArg){var result=func(this.__wrapped__,callback,thisArg);return callback==null||thisArg&&typeof callback!="function"?result:new lodashWrapper(result)}}});lodash.VERSION="1.2.1";lodash.prototype.toString=wrapperToString;lodash.prototype.value=wrapperValueOf;lodash.prototype.valueOf=wrapperValueOf;forEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments)}});forEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){func.apply(this.__wrapped__,arguments);return this}});forEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments))}});return lodash}var _=runInContext();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){window._=_;define(function(){return _})}else if(freeExports&&!freeExports.nodeType){if(freeModule){(freeModule.exports=_)._=_}else{freeExports._=_}}else{window._=_}})(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/node_modules/lodash/dist/lodash.js","/node_modules/lodash/dist")},{__browserify_process:1,__browserify_buffer:2}],5:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);(function(){var viclib,ref$,slice$=[].slice;viclib=(ref$=function(){return import$(typeof global!="undefined"&&global!==null?global:window,viclib)},ref$.mixin=function(){var i$,fns,constructor;fns=0<(i$=arguments.length-1)?slice$.call(arguments,0,i$):(i$=0,[]),constructor=arguments[i$];return function(self,init){var this$=this;self==null&&(self={});init==null&&(init={});each(function(it){return it(self)},fns);return import$(import$(self,constructor.call(self)),init)}},ref$.install=function(lib){lib==null&&(lib=viclib);return import$(typeof global!="undefined"&&global!==null?global:window,lib)},ref$.log=function(){return console.log.apply(console,arguments)},ref$.iter=curry$(function(list,fn){var key,val,results$=[];for(key in list){val=list[key];results$.push(fn(val,key))}return results$}),ref$.ends_with=curry$(function(str,prefix){return deepEq$(str.slice(-prefix.length),prefix,"===")
}),ref$.extend=curry$(function(super_fn,fn){return function(){return fn.call(this,super_fn,arguments)}}),ref$.after=curry$(function(super_fn,fn){return function(){super_fn.apply(this,arguments);return fn.apply(this,arguments)}}),ref$.before=curry$(function(super_fn,fn){return function(){fn.apply(this,arguments);return super_fn.apply(this,arguments)}}),ref$.defer=function(fn){return setTimeout(fn,1)},ref$.make_id=function(next_id){return function(it){if(it.id==null){if(Object.defineProperty!=null){Object.defineProperty(it,"id",{value:next_id++})}else{it.id=next_id++}}return it}}.call(this,0),ref$.remove=function(array,obj){var index;if((index=array.indexOf(obj))!==-1){return array.splice(index,1)}},ref$);module.exports=viclib;viclib();function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}function curry$(f,bound){var context,_curry=function(args){return f.length>1?function(){var params=args?args.concat():[];context=bound?context||this:this;return params.push.apply(params,arguments)<f.length&&arguments.length?_curry.call(context,params):f.apply(context,params)}:f};return _curry()}function deepEq$(x,y,type){var toString={}.toString,hasOwnProperty={}.hasOwnProperty,has=function(obj,key){return hasOwnProperty.call(obj,key)};first=true;return eq(x,y,[]);function eq(a,b,stack){var className,length,size,result,alength,blength,r,key,ref,sizeB;if(a==null||b==null){return a===b}if(a.__placeholder__||b.__placeholder__){return true}if(a===b){return a!==0||1/a==1/b}className=toString.call(a);if(toString.call(b)!=className){return false}switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object"){return false}length=stack.length;while(length--){if(stack[length]==a){return true}}stack.push(a);size=0;result=true;if(className=="[object Array]"){alength=a.length;blength=b.length;if(first){switch(type){case"===":result=alength===blength;break;case"<==":result=alength<=blength;break;case"<<=":result=alength<blength;break}size=alength;first=false}else{result=alength===blength;size=alength}if(result){while(size--){if(!(result=size in a==size in b&&eq(a[size],b[size],stack))){break}}}}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor){return false}for(key in a){if(has(a,key)){size++;if(!(result=has(b,key)&&eq(a[key],b[key],stack))){break}}}if(result){sizeB=0;for(key in b){if(has(b,key)){++sizeB}}if(first){if(type==="<<="){result=size<sizeB}else if(type==="<=="){result=size<=sizeB}else{result=size===sizeB}}else{first=false;result=size===sizeB}}}stack.pop();return result}}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/node_modules/viclib.js","/node_modules")},{"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],33:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){(function(window,document,Math,undef){var nop=function(){};var debug=function(){if("console"in window)return function(msg){window.console.log("Processing.js: "+msg)};return nop}();var ajax=function(url){var xhr=new XMLHttpRequest;xhr.open("GET",url,false);if(xhr.overrideMimeType)xhr.overrideMimeType("text/plain");xhr.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT");xhr.send(null);if(xhr.status!==200&&xhr.status!==0)throw"XMLHttpRequest failed, status code "+xhr.status;return xhr.responseText};var isDOMPresent="document"in this&&!("fake"in this.document);document.head=document.head||document.getElementsByTagName("head")[0];function setupTypedArray(name,fallback){if(name in window)return window[name];if(typeof window[fallback]==="function")return window[fallback];return function(obj){if(obj instanceof Array)return obj;if(typeof obj==="number"){var arr=[];arr.length=obj;return arr}}}if(document.documentMode>=9&&!document.doctype)throw"The doctype directive is missing. The recommended doctype in Internet Explorer is the HTML5 doctype: <!DOCTYPE html>";var Float32Array=setupTypedArray("Float32Array","WebGLFloatArray"),Int32Array=setupTypedArray("Int32Array","WebGLIntArray"),Uint16Array=setupTypedArray("Uint16Array","WebGLUnsignedShortArray"),Uint8Array=setupTypedArray("Uint8Array","WebGLUnsignedByteArray");var PConstants={X:0,Y:1,Z:2,R:3,G:4,B:5,A:6,U:7,V:8,NX:9,NY:10,NZ:11,EDGE:12,SR:13,SG:14,SB:15,SA:16,SW:17,TX:18,TY:19,TZ:20,VX:21,VY:22,VZ:23,VW:24,AR:25,AG:26,AB:27,DR:3,DG:4,DB:5,DA:6,SPR:28,SPG:29,SPB:30,SHINE:31,ER:32,EG:33,EB:34,BEEN_LIT:35,VERTEX_FIELD_COUNT:36,P2D:1,JAVA2D:1,WEBGL:2,P3D:2,OPENGL:2,PDF:0,DXF:0,OTHER:0,WINDOWS:1,MAXOSX:2,LINUX:3,EPSILON:1e-4,MAX_FLOAT:3.4028235e38,MIN_FLOAT:-3.4028235e38,MAX_INT:2147483647,MIN_INT:-2147483648,PI:Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,THIRD_PI:Math.PI/3,QUARTER_PI:Math.PI/4,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,WHITESPACE:" 	\n\r\f ",RGB:1,ARGB:2,HSB:3,ALPHA:4,CMYK:5,TIFF:0,TARGA:1,JPEG:2,GIF:3,BLUR:11,GRAY:12,INVERT:13,OPAQUE:14,POSTERIZE:15,THRESHOLD:16,ERODE:17,DILATE:18,REPLACE:0,BLEND:1<<0,ADD:1<<1,SUBTRACT:1<<2,LIGHTEST:1<<3,DARKEST:1<<4,DIFFERENCE:1<<5,EXCLUSION:1<<6,MULTIPLY:1<<7,SCREEN:1<<8,OVERLAY:1<<9,HARD_LIGHT:1<<10,SOFT_LIGHT:1<<11,DODGE:1<<12,BURN:1<<13,ALPHA_MASK:4278190080,RED_MASK:16711680,GREEN_MASK:65280,BLUE_MASK:255,CUSTOM:0,ORTHOGRAPHIC:2,PERSPECTIVE:3,POINT:2,POINTS:2,LINE:4,LINES:4,TRIANGLE:8,TRIANGLES:9,TRIANGLE_STRIP:10,TRIANGLE_FAN:11,QUAD:16,QUADS:16,QUAD_STRIP:17,POLYGON:20,PATH:21,RECT:30,ELLIPSE:31,ARC:32,SPHERE:40,BOX:41,GROUP:0,PRIMITIVE:1,GEOMETRY:3,VERTEX:0,BEZIER_VERTEX:1,CURVE_VERTEX:2,BREAK:3,CLOSESHAPE:4,OPEN:1,CLOSE:2,CORNER:0,CORNERS:1,RADIUS:2,CENTER_RADIUS:2,CENTER:3,DIAMETER:3,CENTER_DIAMETER:3,BASELINE:0,TOP:101,BOTTOM:102,NORMAL:1,NORMALIZED:1,IMAGE:2,MODEL:4,SHAPE:5,SQUARE:"butt",ROUND:"round",PROJECT:"square",MITER:"miter",BEVEL:"bevel",AMBIENT:0,DIRECTIONAL:1,SPOT:3,BACKSPACE:8,TAB:9,ENTER:10,RETURN:13,ESC:27,DELETE:127,CODED:65535,SHIFT:16,CONTROL:17,ALT:18,CAPSLK:20,PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLK:144,META:157,INSERT:155,ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",NOCURSOR:"url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='), auto",DISABLE_OPENGL_2X_SMOOTH:1,ENABLE_OPENGL_2X_SMOOTH:-1,ENABLE_OPENGL_4X_SMOOTH:2,ENABLE_NATIVE_FONTS:3,DISABLE_DEPTH_TEST:4,ENABLE_DEPTH_TEST:-4,ENABLE_DEPTH_SORT:5,DISABLE_DEPTH_SORT:-5,DISABLE_OPENGL_ERROR_REPORT:6,ENABLE_OPENGL_ERROR_REPORT:-6,ENABLE_ACCURATE_TEXTURES:7,DISABLE_ACCURATE_TEXTURES:-7,HINT_COUNT:10,SINCOS_LENGTH:720,PRECISIONB:15,PRECISIONF:1<<15,PREC_MAXVAL:(1<<15)-1,PREC_ALPHA_SHIFT:24-15,PREC_RED_SHIFT:16-15,NORMAL_MODE_AUTO:0,NORMAL_MODE_SHAPE:1,NORMAL_MODE_VERTEX:2,MAX_LIGHTS:8};function virtHashCode(obj){if(typeof obj==="string"){var hash=0;for(var i=0;i<obj.length;++i)hash=hash*31+obj.charCodeAt(i)&4294967295;return hash}if(typeof obj!=="object")return obj&4294967295;if(obj.hashCode instanceof Function)return obj.hashCode();if(obj.$id===undef)obj.$id=Math.floor(Math.random()*65536)-32768<<16|Math.floor(Math.random()*65536);return obj.$id}function virtEquals(obj,other){if(obj===null||other===null)return obj===null&&other===null;if(typeof obj==="string")return obj===other;if(typeof obj!=="object")return obj===other;if(obj.equals instanceof Function)return obj.equals(other);return obj===other}var ObjectIterator=function(obj){if(obj.iterator instanceof Function)return obj.iterator();if(obj instanceof Array){var index=-1;this.hasNext=function(){return++index<obj.length};this.next=function(){return obj[index]}}else throw"Unable to iterate: "+obj};var ArrayList=function(){function Iterator(array){var index=0;this.hasNext=function(){return index<array.length};this.next=function(){return array[index++]};this.remove=function(){array.splice(index,1)}}function ArrayList(a){var array;if(a instanceof ArrayList)array=a.toArray();else{array=[];if(typeof a==="number")array.length=a>0?a:0}this.get=function(i){return array[i]};this.contains=function(item){return this.indexOf(item)>-1};this.indexOf=function(item){for(var i=0,len=array.length;i<len;++i)if(virtEquals(item,array[i]))return i;return-1};this.lastIndexOf=function(item){for(var i=array.length-1;i>=0;--i)if(virtEquals(item,array[i]))return i;return-1};this.add=function(){if(arguments.length===1)array.push(arguments[0]);else if(arguments.length===2){var arg0=arguments[0];if(typeof arg0==="number")if(arg0>=0&&arg0<=array.length)array.splice(arg0,0,arguments[1]);else throw arg0+" is not a valid index";else throw typeof arg0+" is not a number"}else throw"Please use the proper number of parameters."};this.addAll=function(arg1,arg2){var it;if(typeof arg1==="number"){if(arg1<0||arg1>array.length)throw"Index out of bounds for addAll: "+arg1+" greater or equal than "+array.length;it=new ObjectIterator(arg2);while(it.hasNext())array.splice(arg1++,0,it.next())}else{it=new ObjectIterator(arg1);while(it.hasNext())array.push(it.next())}};this.set=function(){if(arguments.length===2){var arg0=arguments[0];if(typeof arg0==="number")if(arg0>=0&&arg0<array.length)array.splice(arg0,1,arguments[1]);else throw arg0+" is not a valid index.";else throw typeof arg0+" is not a number"}else throw"Please use the proper number of parameters."};this.size=function(){return array.length};this.clear=function(){array.length=0};this.remove=function(item){if(typeof item==="number")return array.splice(item,1)[0];item=this.indexOf(item);if(item>-1){array.splice(item,1);return true}return false};this.removeAll=function(c){var i,x,item,newList=new ArrayList;newList.addAll(this);this.clear();for(i=0,x=0;i<newList.size();i++){item=newList.get(i);if(!c.contains(item))this.add(x++,item)}if(this.size()<newList.size())return true;return false};this.isEmpty=function(){return!array.length};this.clone=function(){return new ArrayList(this)};this.toArray=function(){return array.slice(0)};this.iterator=function(){return new Iterator(array)}}return ArrayList}();var HashMap=function(){function HashMap(){if(arguments.length===1&&arguments[0]instanceof HashMap)return arguments[0].clone();var initialCapacity=arguments.length>0?arguments[0]:16;var loadFactor=arguments.length>1?arguments[1]:.75;var buckets=[];buckets.length=initialCapacity;var count=0;var hashMap=this;function getBucketIndex(key){var index=virtHashCode(key)%buckets.length;return index<0?buckets.length+index:index}function ensureLoad(){if(count<=loadFactor*buckets.length)return;var allEntries=[];for(var i=0;i<buckets.length;++i)if(buckets[i]!==undef)allEntries=allEntries.concat(buckets[i]);var newBucketsLength=buckets.length*2;buckets=[];buckets.length=newBucketsLength;for(var j=0;j<allEntries.length;++j){var index=getBucketIndex(allEntries[j].key);var bucket=buckets[index];if(bucket===undef)buckets[index]=bucket=[];bucket.push(allEntries[j])}}function Iterator(conversion,removeItem){var bucketIndex=0;var itemIndex=-1;var endOfBuckets=false;var currentItem;function findNext(){while(!endOfBuckets){++itemIndex;if(bucketIndex>=buckets.length)endOfBuckets=true;else if(buckets[bucketIndex]===undef||itemIndex>=buckets[bucketIndex].length){itemIndex=-1;++bucketIndex}else return}}this.hasNext=function(){return!endOfBuckets};this.next=function(){currentItem=conversion(buckets[bucketIndex][itemIndex]);findNext();return currentItem};this.remove=function(){if(currentItem!==undef){removeItem(currentItem);--itemIndex;findNext()}};findNext()}function Set(conversion,isIn,removeItem){this.clear=function(){hashMap.clear()};this.contains=function(o){return isIn(o)};this.containsAll=function(o){var it=o.iterator();while(it.hasNext())if(!this.contains(it.next()))return false;return true};this.isEmpty=function(){return hashMap.isEmpty()};this.iterator=function(){return new Iterator(conversion,removeItem)};this.remove=function(o){if(this.contains(o)){removeItem(o);return true}return false};this.removeAll=function(c){var it=c.iterator();var changed=false;while(it.hasNext()){var item=it.next();if(this.contains(item)){removeItem(item);changed=true}}return true};this.retainAll=function(c){var it=this.iterator();var toRemove=[];while(it.hasNext()){var entry=it.next();if(!c.contains(entry))toRemove.push(entry)}for(var i=0;i<toRemove.length;++i)removeItem(toRemove[i]);return toRemove.length>0};this.size=function(){return hashMap.size()};this.toArray=function(){var result=[];var it=this.iterator();while(it.hasNext())result.push(it.next());return result}}function Entry(pair){this._isIn=function(map){return map===hashMap&&pair.removed===undef};this.equals=function(o){return virtEquals(pair.key,o.getKey())};this.getKey=function(){return pair.key};this.getValue=function(){return pair.value};this.hashCode=function(o){return virtHashCode(pair.key)};this.setValue=function(value){var old=pair.value;pair.value=value;return old}}this.clear=function(){count=0;buckets=[];buckets.length=initialCapacity};this.clone=function(){var map=new HashMap;map.putAll(this);return map};this.containsKey=function(key){var index=getBucketIndex(key);var bucket=buckets[index];if(bucket===undef)return false;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key))return true;return false};this.containsValue=function(value){for(var i=0;i<buckets.length;++i){var bucket=buckets[i];if(bucket===undef)continue;for(var j=0;j<bucket.length;++j)if(virtEquals(bucket[j].value,value))return true}return false};this.entrySet=function(){return new Set(function(pair){return new Entry(pair)},function(pair){return pair instanceof Entry&&pair._isIn(hashMap)},function(pair){return hashMap.remove(pair.getKey())})};this.get=function(key){var index=getBucketIndex(key);var bucket=buckets[index];if(bucket===undef)return null;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key))return bucket[i].value;return null};this.isEmpty=function(){return count===0};this.keySet=function(){return new Set(function(pair){return pair.key},function(key){return hashMap.containsKey(key)},function(key){return hashMap.remove(key)})};this.values=function(){return new Set(function(pair){return pair.value},function(value){return hashMap.containsValue(value)},function(value){return hashMap.removeByValue(value)})};this.put=function(key,value){var index=getBucketIndex(key);var bucket=buckets[index];if(bucket===undef){++count;buckets[index]=[{key:key,value:value}];ensureLoad();return null}for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key)){var previous=bucket[i].value;bucket[i].value=value;return previous}++count;bucket.push({key:key,value:value});ensureLoad();return null};this.putAll=function(m){var it=m.entrySet().iterator();while(it.hasNext()){var entry=it.next();this.put(entry.getKey(),entry.getValue())}};this.remove=function(key){var index=getBucketIndex(key);var bucket=buckets[index];if(bucket===undef)return null;for(var i=0;i<bucket.length;++i)if(virtEquals(bucket[i].key,key)){--count;var previous=bucket[i].value;bucket[i].removed=true;if(bucket.length>1)bucket.splice(i,1);else buckets[index]=undef;return previous}return null};this.removeByValue=function(value){var bucket,i,ilen,pair;for(bucket in buckets)if(buckets.hasOwnProperty(bucket))for(i=0,ilen=buckets[bucket].length;i<ilen;i++){pair=buckets[bucket][i];if(pair.value===value){buckets[bucket].splice(i,1);return true}}return false};this.size=function(){return count}}return HashMap}();var PVector=function(){function PVector(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0}PVector.dist=function(v1,v2){return v1.dist(v2)};PVector.dot=function(v1,v2){return v1.dot(v2)};PVector.cross=function(v1,v2){return v1.cross(v2)};PVector.angleBetween=function(v1,v2){return Math.acos(v1.dot(v2)/(v1.mag()*v2.mag()))};PVector.prototype={set:function(v,y,z){if(arguments.length===1)this.set(v.x||v[0]||0,v.y||v[1]||0,v.z||v[2]||0);else{this.x=v;this.y=y;this.z=z}},get:function(){return new PVector(this.x,this.y,this.z)},mag:function(){var x=this.x,y=this.y,z=this.z;return Math.sqrt(x*x+y*y+z*z)},add:function(v,y,z){if(arguments.length===1){this.x+=v.x;this.y+=v.y;this.z+=v.z}else{this.x+=v;this.y+=y;this.z+=z}},sub:function(v,y,z){if(arguments.length===1){this.x-=v.x;this.y-=v.y;this.z-=v.z}else{this.x-=v;this.y-=y;this.z-=z}},mult:function(v){if(typeof v==="number"){this.x*=v;this.y*=v;this.z*=v}else{this.x*=v.x;this.y*=v.y;this.z*=v.z}},div:function(v){if(typeof v==="number"){this.x/=v;this.y/=v;this.z/=v}else{this.x/=v.x;this.y/=v.y;this.z/=v.z}},dist:function(v){var dx=this.x-v.x,dy=this.y-v.y,dz=this.z-v.z;return Math.sqrt(dx*dx+dy*dy+dz*dz)},dot:function(v,y,z){if(arguments.length===1)return this.x*v.x+this.y*v.y+this.z*v.z;return this.x*v+this.y*y+this.z*z},cross:function(v){var x=this.x,y=this.y,z=this.z;return new PVector(y*v.z-v.y*z,z*v.x-v.z*x,x*v.y-v.x*y)},normalize:function(){var m=this.mag();if(m>0)this.div(m)},limit:function(high){if(this.mag()>high){this.normalize();this.mult(high)}},heading2D:function(){return-Math.atan2(-this.y,this.x)},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},array:function(){return[this.x,this.y,this.z]}};function createPVectorMethod(method){return function(v1,v2){var v=v1.get();v[method](v2);return v}}for(var method in PVector.prototype)if(PVector.prototype.hasOwnProperty(method)&&!PVector.hasOwnProperty(method))PVector[method]=createPVectorMethod(method);return PVector}();function DefaultScope(){}DefaultScope.prototype=PConstants;var defaultScope=new DefaultScope;defaultScope.ArrayList=ArrayList;defaultScope.HashMap=HashMap;defaultScope.PVector=PVector;defaultScope.ObjectIterator=ObjectIterator;defaultScope.PConstants=PConstants;defaultScope.defineProperty=function(obj,name,desc){if("defineProperty"in Object)Object.defineProperty(obj,name,desc);else{if(desc.hasOwnProperty("get"))obj.__defineGetter__(name,desc.get);if(desc.hasOwnProperty("set"))obj.__defineSetter__(name,desc.set)}};function overloadBaseClassFunction(object,name,basefn){if(!object.hasOwnProperty(name)||typeof object[name]!=="function"){object[name]=basefn;return}var fn=object[name];if("$overloads"in fn){fn.$defaultOverload=basefn;return}if(!("$overloads"in basefn)&&fn.length===basefn.length)return;var overloads,defaultOverload;if("$overloads"in basefn){overloads=basefn.$overloads.slice(0);overloads[fn.length]=fn;defaultOverload=basefn.$defaultOverload}else{overloads=[];overloads[basefn.length]=basefn;overloads[fn.length]=fn;defaultOverload=fn}var hubfn=function(){var fn=hubfn.$overloads[arguments.length]||("$methodArgsIndex"in hubfn&&arguments.length>hubfn.$methodArgsIndex?hubfn.$overloads[hubfn.$methodArgsIndex]:null)||hubfn.$defaultOverload;return fn.apply(this,arguments)};hubfn.$overloads=overloads;if("$methodArgsIndex"in basefn)hubfn.$methodArgsIndex=basefn.$methodArgsIndex;hubfn.$defaultOverload=defaultOverload;hubfn.name=name;object[name]=hubfn}function extendClass(subClass,baseClass){function extendGetterSetter(propertyName){defaultScope.defineProperty(subClass,propertyName,{get:function(){return baseClass[propertyName]},set:function(v){baseClass[propertyName]=v},enumerable:true})}var properties=[];for(var propertyName in baseClass)if(typeof baseClass[propertyName]==="function")overloadBaseClassFunction(subClass,propertyName,baseClass[propertyName]);else if(propertyName.charAt(0)!=="$"&&!(propertyName in subClass))properties.push(propertyName);while(properties.length>0)extendGetterSetter(properties.shift());subClass.$super=baseClass}defaultScope.extendClassChain=function(base){var path=[base];for(var self=base.$upcast;self;self=self.$upcast){extendClass(self,base);path.push(self);base=self}while(path.length>0)path.pop().$self=base};defaultScope.extendStaticMembers=function(derived,base){extendClass(derived,base)};defaultScope.extendInterfaceMembers=function(derived,base){extendClass(derived,base)};defaultScope.addMethod=function(object,name,fn,hasMethodArgs){var existingfn=object[name];if(existingfn||hasMethodArgs){var args=fn.length;if("$overloads"in existingfn)existingfn.$overloads[args]=fn;else{var hubfn=function(){var fn=hubfn.$overloads[arguments.length]||("$methodArgsIndex"in hubfn&&arguments.length>hubfn.$methodArgsIndex?hubfn.$overloads[hubfn.$methodArgsIndex]:null)||hubfn.$defaultOverload;return fn.apply(this,arguments)};var overloads=[];if(existingfn)overloads[existingfn.length]=existingfn;overloads[args]=fn;hubfn.$overloads=overloads;hubfn.$defaultOverload=existingfn||fn;if(hasMethodArgs)hubfn.$methodArgsIndex=args;hubfn.name=name;object[name]=hubfn}}else object[name]=fn};function isNumericalJavaType(type){if(typeof type!=="string")return false;return["byte","int","char","color","float","long","double"].indexOf(type)!==-1}defaultScope.createJavaArray=function(type,bounds){var result=null,defaultValue=null;if(typeof type==="string")if(type==="boolean")defaultValue=false;else if(isNumericalJavaType(type))defaultValue=0;if(typeof bounds[0]==="number"){var itemsCount=0|bounds[0];if(bounds.length<=1){result=[];result.length=itemsCount;for(var i=0;i<itemsCount;++i)result[i]=defaultValue}else{result=[];var newBounds=bounds.slice(1);for(var j=0;j<itemsCount;++j)result.push(defaultScope.createJavaArray(type,newBounds))}}return result};var colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};(function(Processing){var unsupportedP5=("open() createOutput() createInput() BufferedReader selectFolder() "+"dataPath() createWriter() selectOutput() beginRecord() "+"saveStream() endRecord() selectInput() saveBytes() createReader() "+"beginRaw() endRaw() PrintWriter delay()").split(" "),count=unsupportedP5.length,prettyName,p5Name;function createUnsupportedFunc(n){return function(){throw"Processing.js does not support "+n+"."}}while(count--){prettyName=unsupportedP5[count];p5Name=prettyName.replace("()","");Processing[p5Name]=createUnsupportedFunc(prettyName)}})(defaultScope);defaultScope.defineProperty(defaultScope,"screenWidth",{get:function(){return window.innerWidth}});defaultScope.defineProperty(defaultScope,"screenHeight",{get:function(){return window.innerHeight}});defaultScope.defineProperty(defaultScope,"online",{get:function(){return true}});var processingInstances=[];var processingInstanceIds={};var removeInstance=function(id){processingInstances.splice(processingInstanceIds[id],1);delete processingInstanceIds[id]};var addInstance=function(processing){if(processing.externals.canvas.id===undef||!processing.externals.canvas.id.length)processing.externals.canvas.id="__processing"+processingInstances.length;processingInstanceIds[processing.externals.canvas.id]=processingInstances.length;processingInstances.push(processing)};function computeFontMetrics(pfont){var emQuad=250,correctionFactor=pfont.size/emQuad,canvas=document.createElement("canvas");canvas.width=2*emQuad;canvas.height=2*emQuad;canvas.style.opacity=0;var cfmFont=pfont.getCSSDefinition(emQuad+"px","normal"),ctx=canvas.getContext("2d");ctx.font=cfmFont;var protrusions="dbflkhyjqpg";canvas.width=ctx.measureText(protrusions).width;ctx.font=cfmFont;var leadDiv=document.createElement("div");leadDiv.style.position="absolute";leadDiv.style.opacity=0;leadDiv.style.fontFamily='"'+pfont.name+'"';leadDiv.style.fontSize=emQuad+"px";leadDiv.innerHTML=protrusions+"<br/>"+protrusions;document.body.appendChild(leadDiv);var w=canvas.width,h=canvas.height,baseline=h/2;ctx.fillStyle="white";ctx.fillRect(0,0,w,h);ctx.fillStyle="black";ctx.fillText(protrusions,0,baseline);var pixelData=ctx.getImageData(0,0,w,h).data;var i=0,w4=w*4,len=pixelData.length;while(++i<len&&pixelData[i]===255)nop();var ascent=Math.round(i/w4);i=len-1;while(--i>0&&pixelData[i]===255)nop();var descent=Math.round(i/w4);pfont.ascent=correctionFactor*(baseline-ascent);pfont.descent=correctionFactor*(descent-baseline);if(document.defaultView.getComputedStyle){var leadDivHeight=document.defaultView.getComputedStyle(leadDiv,null).getPropertyValue("height");leadDivHeight=correctionFactor*leadDivHeight.replace("px","");if(leadDivHeight>=pfont.size*2)pfont.leading=Math.round(leadDivHeight/2)}document.body.removeChild(leadDiv);if(pfont.caching)return ctx}function PFont(name,size){if(name===undef)name="";this.name=name;if(size===undef)size=0;this.size=size;this.glyph=false;this.ascent=0;this.descent=0;this.leading=1.2*size;var illegalIndicator=name.indexOf(" Italic Bold");if(illegalIndicator!==-1)name=name.substring(0,illegalIndicator);this.style="normal";var italicsIndicator=name.indexOf(" Italic");if(italicsIndicator!==-1){name=name.substring(0,italicsIndicator);this.style="italic"}this.weight="normal";var boldIndicator=name.indexOf(" Bold");if(boldIndicator!==-1){name=name.substring(0,boldIndicator);this.weight="bold"}this.family="sans-serif";if(name!==undef)switch(name){case"sans-serif":case"serif":case"monospace":case"fantasy":case"cursive":this.family=name;break;default:this.family='"'+name+'", sans-serif';break}this.context2d=computeFontMetrics(this);this.css=this.getCSSDefinition();if(this.context2d)this.context2d.font=this.css}PFont.prototype.caching=true;PFont.prototype.getCSSDefinition=function(fontSize,lineHeight){if(fontSize===undef)fontSize=this.size+"px";if(lineHeight===undef)lineHeight=this.leading+"px";var components=[this.style,"normal",this.weight,fontSize+"/"+lineHeight,this.family];return components.join(" ")};PFont.prototype.measureTextWidth=function(string){return this.context2d.measureText(string).width};PFont.prototype.measureTextWidthFallback=function(string){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");ctx.font=this.css;return ctx.measureText(string).width};PFont.PFontCache={length:0};PFont.get=function(fontName,fontSize){fontSize=(fontSize*10+.5|0)/10;var cache=PFont.PFontCache,idx=fontName+"/"+fontSize;if(!cache[idx]){cache[idx]=new PFont(fontName,fontSize);cache.length++;if(cache.length===50){PFont.prototype.measureTextWidth=PFont.prototype.measureTextWidthFallback;PFont.prototype.caching=false;var entry;for(entry in cache)if(entry!=="length")cache[entry].context2d=null;return new PFont(fontName,fontSize)}if(cache.length===400){PFont.PFontCache={};PFont.get=PFont.getFallback;return new PFont(fontName,fontSize)}}return cache[idx]};PFont.getFallback=function(fontName,fontSize){return new PFont(fontName,fontSize)};PFont.list=function(){return["sans-serif","serif","monospace","fantasy","cursive"]};PFont.preloading={template:{},initialized:false,initialize:function(){var generateTinyFont=function(){var encoded="#E3KAI2wAgT1MvMg7Eo3VmNtYX7ABi3CxnbHlm"+"7Abw3kaGVhZ7ACs3OGhoZWE7A53CRobXR47AY3"+"AGbG9jYQ7G03Bm1heH7ABC3CBuYW1l7Ae3AgcG"+"9zd7AI3AE#B3AQ2kgTY18PPPUACwAg3ALSRoo3"+"#yld0xg32QAB77#E777773B#E3C#I#Q77773E#"+"Q7777777772CMAIw7AB77732B#M#Q3wAB#g3B#"+"E#E2BB//82BB////w#B7#gAEg3E77x2B32B#E#"+"Q#MTcBAQ32gAe#M#QQJ#E32M#QQJ#I#g32Q77#";var expand=function(input){return"AAAAAAAA".substr(~~input?7-input:6)};return encoded.replace(/[#237]/g,expand)};var fontface=document.createElement("style");fontface.setAttribute("type","text/css");fontface.innerHTML="@font-face {\n"+'  font-family: "PjsEmptyFont";'+"\n"+"  src: url('data:application/x-font-ttf;base64,"+generateTinyFont()+"')\n"+"       format('truetype');\n"+"}";document.head.appendChild(fontface);var element=document.createElement("span");element.style.cssText='position: absolute; top: 0; left: 0; opacity: 0; font-family: "PjsEmptyFont", fantasy;';element.innerHTML="AAAAAAAA";document.body.appendChild(element);this.template=element;this.initialized=true},getElementWidth:function(element){return document.defaultView.getComputedStyle(element,"").getPropertyValue("width")},timeAttempted:0,pending:function(intervallength){if(!this.initialized)this.initialize();var element,computedWidthFont,computedWidthRef=this.getElementWidth(this.template);for(var i=0;i<this.fontList.length;i++){element=this.fontList[i];computedWidthFont=this.getElementWidth(element);if(this.timeAttempted<4e3&&computedWidthFont===computedWidthRef){this.timeAttempted+=intervallength;return true}else{document.body.removeChild(element);this.fontList.splice(i--,1);this.timeAttempted=0}}if(this.fontList.length===0)return false;return true},fontList:[],addedList:{},add:function(fontSrc){if(!this.initialized)this.initialize();var fontName=typeof fontSrc==="object"?fontSrc.fontFace:fontSrc,fontUrl=typeof fontSrc==="object"?fontSrc.url:fontSrc;if(this.addedList[fontName])return;var style=document.createElement("style");style.setAttribute("type","text/css");style.innerHTML="@font-face{\n  font-family: '"+fontName+"';\n  src:  url('"+fontUrl+"');\n}\n";document.head.appendChild(style);this.addedList[fontName]=true;var element=document.createElement("span");element.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;";element.style.fontFamily='"'+fontName+'", "PjsEmptyFont", fantasy';element.innerHTML="AAAAAAAA";document.body.appendChild(element);this.fontList.push(element)}};defaultScope.PFont=PFont;var Processing=this.Processing=function(aCanvas,aCode){if(!(this instanceof Processing))throw"called Processing constructor as if it were a function: missing 'new'.";
var curElement,pgraphicsMode=aCanvas===undef&&aCode===undef;if(pgraphicsMode)curElement=document.createElement("canvas");else curElement=typeof aCanvas==="string"?document.getElementById(aCanvas):aCanvas;if(!(curElement instanceof HTMLCanvasElement))throw"called Processing constructor without passing canvas element reference or id.";function unimplemented(s){Processing.debug("Unimplemented - "+s)}var p=this;p.externals={canvas:curElement,context:undef,sketch:undef};p.name="Processing.js Instance";p.use3DContext=false;p.focused=false;p.breakShape=false;p.glyphTable={};p.pmouseX=0;p.pmouseY=0;p.mouseX=0;p.mouseY=0;p.mouseButton=0;p.mouseScroll=0;p.mouseClicked=undef;p.mouseDragged=undef;p.mouseMoved=undef;p.mousePressed=undef;p.mouseReleased=undef;p.mouseScrolled=undef;p.mouseOver=undef;p.mouseOut=undef;p.touchStart=undef;p.touchEnd=undef;p.touchMove=undef;p.touchCancel=undef;p.key=undef;p.keyCode=undef;p.keyPressed=nop;p.keyReleased=nop;p.keyTyped=nop;p.draw=undef;p.setup=undef;p.__mousePressed=false;p.__keyPressed=false;p.__frameRate=60;p.frameCount=0;p.width=100;p.height=100;var curContext,curSketch,drawing,online=true,doFill=true,fillStyle=[1,1,1,1],currentFillColor=4294967295,isFillDirty=true,doStroke=true,strokeStyle=[0,0,0,1],currentStrokeColor=4278190080,isStrokeDirty=true,lineWidth=1,loopStarted=false,renderSmooth=false,doLoop=true,looping=0,curRectMode=0,curEllipseMode=3,normalX=0,normalY=0,normalZ=0,normalMode=0,curFrameRate=60,curMsPerFrame=1e3/curFrameRate,curCursor="default",oldCursor=curElement.style.cursor,curShape=20,curShapeCount=0,curvePoints=[],curTightness=0,curveDet=20,curveInited=false,backgroundObj=-3355444,bezDetail=20,colorModeA=255,colorModeX=255,colorModeY=255,colorModeZ=255,pathOpen=false,mouseDragging=false,pmouseXLastFrame=0,pmouseYLastFrame=0,curColorMode=1,curTint=null,curTint3d=null,getLoaded=false,start=Date.now(),timeSinceLastFPS=start,framesSinceLastFPS=0,textcanvas,curveBasisMatrix,curveToBezierMatrix,curveDrawMatrix,bezierDrawMatrix,bezierBasisInverse,bezierBasisMatrix,curContextCache={attributes:{},locations:{}},programObject3D,programObject2D,programObjectUnlitShape,boxBuffer,boxNormBuffer,boxOutlineBuffer,rectBuffer,rectNormBuffer,sphereBuffer,lineBuffer,fillBuffer,fillColorBuffer,strokeColorBuffer,pointBuffer,shapeTexVBO,canTex,textTex,curTexture={width:0,height:0},curTextureMode=2,usingTexture=false,textBuffer,textureBuffer,indexBuffer,horizontalTextAlignment=37,verticalTextAlignment=0,textMode=4,curFontName="Arial",curTextSize=12,curTextAscent=9,curTextDescent=2,curTextLeading=14,curTextFont=PFont.get(curFontName,curTextSize),originalContext,proxyContext=null,isContextReplaced=false,setPixelsCached,maxPixelsCached=1e3,pressedKeysMap=[],lastPressedKeyCode=null,codedKeys=[16,17,18,20,33,34,35,36,37,38,39,40,144,155,112,113,114,115,116,117,118,119,120,121,122,123,157];var stylePaddingLeft,stylePaddingTop,styleBorderLeft,styleBorderTop;if(document.defaultView&&document.defaultView.getComputedStyle){stylePaddingLeft=parseInt(document.defaultView.getComputedStyle(curElement,null)["paddingLeft"],10)||0;stylePaddingTop=parseInt(document.defaultView.getComputedStyle(curElement,null)["paddingTop"],10)||0;styleBorderLeft=parseInt(document.defaultView.getComputedStyle(curElement,null)["borderLeftWidth"],10)||0;styleBorderTop=parseInt(document.defaultView.getComputedStyle(curElement,null)["borderTopWidth"],10)||0}var lightCount=0;var sphereDetailV=0,sphereDetailU=0,sphereX=[],sphereY=[],sphereZ=[],sinLUT=new Float32Array(720),cosLUT=new Float32Array(720),sphereVerts,sphereNorms;var cam,cameraInv,modelView,modelViewInv,userMatrixStack,userReverseMatrixStack,inverseCopy,projection,manipulatingCamera=false,frustumMode=false,cameraFOV=60*(Math.PI/180),cameraX=p.width/2,cameraY=p.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),cameraNear=cameraZ/10,cameraFar=cameraZ*10,cameraAspect=p.width/p.height;var vertArray=[],curveVertArray=[],curveVertCount=0,isCurve=false,isBezier=false,firstVert=true;var curShapeMode=0;var styleArray=[];var boxVerts=new Float32Array([.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]);var boxOutlineVerts=new Float32Array([.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5]);var boxNorms=new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]);var rectVerts=new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]);var rectNorms=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);var vertexShaderSrcUnlitShape="varying vec4 vFrontColor;"+"attribute vec3 aVertex;"+"attribute vec4 aColor;"+"uniform mat4 uView;"+"uniform mat4 uProjection;"+"uniform float uPointSize;"+"void main(void) {"+"  vFrontColor = aColor;"+"  gl_PointSize = uPointSize;"+"  gl_Position = uProjection * uView * vec4(aVertex, 1.0);"+"}";var fragmentShaderSrcUnlitShape="#ifdef GL_ES\n"+"precision highp float;\n"+"#endif\n"+"varying vec4 vFrontColor;"+"uniform bool uSmooth;"+"void main(void){"+"  if(uSmooth == true){"+"    float dist = distance(gl_PointCoord, vec2(0.5));"+"    if(dist > 0.5){"+"      discard;"+"    }"+"  }"+"  gl_FragColor = vFrontColor;"+"}";var vertexShaderSrc2D="varying vec4 vFrontColor;"+"attribute vec3 aVertex;"+"attribute vec2 aTextureCoord;"+"uniform vec4 uColor;"+"uniform mat4 uModel;"+"uniform mat4 uView;"+"uniform mat4 uProjection;"+"uniform float uPointSize;"+"varying vec2 vTextureCoord;"+"void main(void) {"+"  gl_PointSize = uPointSize;"+"  vFrontColor = uColor;"+"  gl_Position = uProjection * uView * uModel * vec4(aVertex, 1.0);"+"  vTextureCoord = aTextureCoord;"+"}";var fragmentShaderSrc2D="#ifdef GL_ES\n"+"precision highp float;\n"+"#endif\n"+"varying vec4 vFrontColor;"+"varying vec2 vTextureCoord;"+"uniform sampler2D uSampler;"+"uniform int uIsDrawingText;"+"uniform bool uSmooth;"+"void main(void){"+"  if(uSmooth == true){"+"    float dist = distance(gl_PointCoord, vec2(0.5));"+"    if(dist > 0.5){"+"      discard;"+"    }"+"  }"+"  if(uIsDrawingText == 1){"+"    float alpha = texture2D(uSampler, vTextureCoord).a;"+"    gl_FragColor = vec4(vFrontColor.rgb * alpha, alpha);"+"  }"+"  else{"+"    gl_FragColor = vFrontColor;"+"  }"+"}";var webglMaxTempsWorkaround=/Windows/.test(navigator.userAgent);var vertexShaderSrc3D="varying vec4 vFrontColor;"+"attribute vec3 aVertex;"+"attribute vec3 aNormal;"+"attribute vec4 aColor;"+"attribute vec2 aTexture;"+"varying   vec2 vTexture;"+"uniform vec4 uColor;"+"uniform bool uUsingMat;"+"uniform vec3 uSpecular;"+"uniform vec3 uMaterialEmissive;"+"uniform vec3 uMaterialAmbient;"+"uniform vec3 uMaterialSpecular;"+"uniform float uShininess;"+"uniform mat4 uModel;"+"uniform mat4 uView;"+"uniform mat4 uProjection;"+"uniform mat4 uNormalTransform;"+"uniform int uLightCount;"+"uniform vec3 uFalloff;"+"struct Light {"+"  int type;"+"  vec3 color;"+"  vec3 position;"+"  vec3 direction;"+"  float angle;"+"  vec3 halfVector;"+"  float concentration;"+"};"+"uniform Light uLights0;"+"uniform Light uLights1;"+"uniform Light uLights2;"+"uniform Light uLights3;"+"uniform Light uLights4;"+"uniform Light uLights5;"+"uniform Light uLights6;"+"uniform Light uLights7;"+"Light getLight(int index){"+"  if(index == 0) return uLights0;"+"  if(index == 1) return uLights1;"+"  if(index == 2) return uLights2;"+"  if(index == 3) return uLights3;"+"  if(index == 4) return uLights4;"+"  if(index == 5) return uLights5;"+"  if(index == 6) return uLights6;"+"  return uLights7;"+"}"+"void AmbientLight( inout vec3 totalAmbient, in vec3 ecPos, in Light light ) {"+"  float d = length( light.position - ecPos );"+"  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));"+"  totalAmbient += light.color * attenuation;"+"}"+"void DirectionalLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {"+"  float powerFactor = 0.0;"+"  float nDotVP = max(0.0, dot( vertNormal, normalize(-light.position) ));"+"  float nDotVH = max(0.0, dot( vertNormal, normalize(-light.position-normalize(ecPos) )));"+"  if( nDotVP != 0.0 ){"+"    powerFactor = pow( nDotVH, uShininess );"+"  }"+"  col += light.color * nDotVP;"+"  spec += uSpecular * powerFactor;"+"}"+"void PointLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {"+"  float powerFactor;"+"   vec3 VP = light.position - ecPos;"+"  float d = length( VP ); "+"  VP = normalize( VP );"+"  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));"+"  float nDotVP = max( 0.0, dot( vertNormal, VP ));"+"  vec3 halfVector = normalize( VP - normalize(ecPos) );"+"  float nDotHV = max( 0.0, dot( vertNormal, halfVector ));"+"  if( nDotVP == 0.0 ) {"+"    powerFactor = 0.0;"+"  }"+"  else {"+"    powerFactor = pow( nDotHV, uShininess );"+"  }"+"  spec += uSpecular * powerFactor * attenuation;"+"  col += light.color * nDotVP * attenuation;"+"}"+"void SpotLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {"+"  float spotAttenuation;"+"  float powerFactor = 0.0;"+"  vec3 VP = light.position - ecPos;"+"  vec3 ldir = normalize( -light.direction );"+"  float d = length( VP );"+"  VP = normalize( VP );"+"  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ) );"+"  float spotDot = dot( VP, ldir );"+(webglMaxTempsWorkaround?"  spotAttenuation = 1.0; ":"  if( spotDot > cos( light.angle ) ) {"+"    spotAttenuation = pow( spotDot, light.concentration );"+"  }"+"  else{"+"    spotAttenuation = 0.0;"+"  }"+"  attenuation *= spotAttenuation;"+"")+"  float nDotVP = max( 0.0, dot( vertNormal, VP ) );"+"  vec3 halfVector = normalize( VP - normalize(ecPos) );"+"  float nDotHV = max( 0.0, dot( vertNormal, halfVector ) );"+"  if( nDotVP != 0.0 ) {"+"    powerFactor = pow( nDotHV, uShininess );"+"  }"+"  spec += uSpecular * powerFactor * attenuation;"+"  col += light.color * nDotVP * attenuation;"+"}"+"void main(void) {"+"  vec3 finalAmbient = vec3( 0.0 );"+"  vec3 finalDiffuse = vec3( 0.0 );"+"  vec3 finalSpecular = vec3( 0.0 );"+"  vec4 col = uColor;"+"  if ( uColor[0] == -1.0 ){"+"    col = aColor;"+"  }"+"  vec3 norm = normalize(vec3( uNormalTransform * vec4( aNormal, 0.0 ) ));"+"  vec4 ecPos4 = uView * uModel * vec4(aVertex, 1.0);"+"  vec3 ecPos = (vec3(ecPos4))/ecPos4.w;"+"  if( uLightCount == 0 ) {"+"    vFrontColor = col + vec4(uMaterialSpecular, 1.0);"+"  }"+"  else {"+"    for( int i = 0; i < 8; i++ ) {"+"      Light l = getLight(i);"+"      if( i >= uLightCount ){"+"        break;"+"      }"+"      if( l.type == 0 ) {"+"        AmbientLight( finalAmbient, ecPos, l );"+"      }"+"      else if( l.type == 1 ) {"+"        DirectionalLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"      else if( l.type == 2 ) {"+"        PointLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"      else {"+"        SpotLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"    }"+"   if( uUsingMat == false ) {"+"     vFrontColor = vec4("+"       vec3( col ) * finalAmbient +"+"       vec3( col ) * finalDiffuse +"+"       vec3( col ) * finalSpecular,"+"       col[3] );"+"   }"+"   else{"+"     vFrontColor = vec4( "+"       uMaterialEmissive + "+"       (vec3(col) * uMaterialAmbient * finalAmbient ) + "+"       (vec3(col) * finalDiffuse) + "+"       (uMaterialSpecular * finalSpecular), "+"       col[3] );"+"    }"+"  }"+"  vTexture.xy = aTexture.xy;"+"  gl_Position = uProjection * uView * uModel * vec4( aVertex, 1.0 );"+"}";var fragmentShaderSrc3D="#ifdef GL_ES\n"+"precision highp float;\n"+"#endif\n"+"varying vec4 vFrontColor;"+"uniform sampler2D uSampler;"+"uniform bool uUsingTexture;"+"varying vec2 vTexture;"+"void main(void){"+"  if( uUsingTexture ){"+"    gl_FragColor = vec4(texture2D(uSampler, vTexture.xy)) * vFrontColor;"+"  }"+"  else{"+"    gl_FragColor = vFrontColor;"+"  }"+"}";function uniformf(cacheId,programObj,varName,varValue){var varLocation=curContextCache.locations[cacheId];if(varLocation===undef){varLocation=curContext.getUniformLocation(programObj,varName);curContextCache.locations[cacheId]=varLocation}if(varLocation!==null)if(varValue.length===4)curContext.uniform4fv(varLocation,varValue);else if(varValue.length===3)curContext.uniform3fv(varLocation,varValue);else if(varValue.length===2)curContext.uniform2fv(varLocation,varValue);else curContext.uniform1f(varLocation,varValue)}function uniformi(cacheId,programObj,varName,varValue){var varLocation=curContextCache.locations[cacheId];if(varLocation===undef){varLocation=curContext.getUniformLocation(programObj,varName);curContextCache.locations[cacheId]=varLocation}if(varLocation!==null)if(varValue.length===4)curContext.uniform4iv(varLocation,varValue);else if(varValue.length===3)curContext.uniform3iv(varLocation,varValue);else if(varValue.length===2)curContext.uniform2iv(varLocation,varValue);else curContext.uniform1i(varLocation,varValue)}function uniformMatrix(cacheId,programObj,varName,transpose,matrix){var varLocation=curContextCache.locations[cacheId];if(varLocation===undef){varLocation=curContext.getUniformLocation(programObj,varName);curContextCache.locations[cacheId]=varLocation}if(varLocation!==-1)if(matrix.length===16)curContext.uniformMatrix4fv(varLocation,transpose,matrix);else if(matrix.length===9)curContext.uniformMatrix3fv(varLocation,transpose,matrix);else curContext.uniformMatrix2fv(varLocation,transpose,matrix)}function vertexAttribPointer(cacheId,programObj,varName,size,VBO){var varLocation=curContextCache.attributes[cacheId];if(varLocation===undef){varLocation=curContext.getAttribLocation(programObj,varName);curContextCache.attributes[cacheId]=varLocation}if(varLocation!==-1){curContext.bindBuffer(curContext.ARRAY_BUFFER,VBO);curContext.vertexAttribPointer(varLocation,size,curContext.FLOAT,false,0,0);curContext.enableVertexAttribArray(varLocation)}}function disableVertexAttribPointer(cacheId,programObj,varName){var varLocation=curContextCache.attributes[cacheId];if(varLocation===undef){varLocation=curContext.getAttribLocation(programObj,varName);curContextCache.attributes[cacheId]=varLocation}if(varLocation!==-1)curContext.disableVertexAttribArray(varLocation)}var createProgramObject=function(curContext,vetexShaderSource,fragmentShaderSource){var vertexShaderObject=curContext.createShader(curContext.VERTEX_SHADER);curContext.shaderSource(vertexShaderObject,vetexShaderSource);curContext.compileShader(vertexShaderObject);if(!curContext.getShaderParameter(vertexShaderObject,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(vertexShaderObject);var fragmentShaderObject=curContext.createShader(curContext.FRAGMENT_SHADER);curContext.shaderSource(fragmentShaderObject,fragmentShaderSource);curContext.compileShader(fragmentShaderObject);if(!curContext.getShaderParameter(fragmentShaderObject,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(fragmentShaderObject);var programObject=curContext.createProgram();curContext.attachShader(programObject,vertexShaderObject);curContext.attachShader(programObject,fragmentShaderObject);curContext.linkProgram(programObject);if(!curContext.getProgramParameter(programObject,curContext.LINK_STATUS))throw"Error linking shaders.";return programObject};var imageModeCorner=function(x,y,w,h,whAreSizes){return{x:x,y:y,w:w,h:h}};var imageModeConvert=imageModeCorner;var imageModeCorners=function(x,y,w,h,whAreSizes){return{x:x,y:y,w:whAreSizes?w:w-x,h:whAreSizes?h:h-y}};var imageModeCenter=function(x,y,w,h,whAreSizes){return{x:x-w/2,y:y-h/2,w:w,h:h}};var DrawingShared=function(){};var Drawing2D=function(){};var Drawing3D=function(){};var DrawingPre=function(){};Drawing2D.prototype=new DrawingShared;Drawing2D.prototype.constructor=Drawing2D;Drawing3D.prototype=new DrawingShared;Drawing3D.prototype.constructor=Drawing3D;DrawingPre.prototype=new DrawingShared;DrawingPre.prototype.constructor=DrawingPre;DrawingShared.prototype.a3DOnlyFunction=nop;var charMap={};var Char=p.Character=function(chr){if(typeof chr==="string"&&chr.length===1)this.code=chr.charCodeAt(0);else if(typeof chr==="number")this.code=chr;else if(chr instanceof Char)this.code=chr;else this.code=NaN;return charMap[this.code]===undef?charMap[this.code]=this:charMap[this.code]};Char.prototype.toString=function(){return String.fromCharCode(this.code)};Char.prototype.valueOf=function(){return this.code};var PShape=p.PShape=function(family){this.family=family||0;this.visible=true;this.style=true;this.children=[];this.nameTable=[];this.params=[];this.name="";this.image=null;this.matrix=null;this.kind=null;this.close=null;this.width=null;this.height=null;this.parent=null};PShape.prototype={isVisible:function(){return this.visible},setVisible:function(visible){this.visible=visible},disableStyle:function(){this.style=false;for(var i=0,j=this.children.length;i<j;i++)this.children[i].disableStyle()},enableStyle:function(){this.style=true;for(var i=0,j=this.children.length;i<j;i++)this.children[i].enableStyle()},getFamily:function(){return this.family},getWidth:function(){return this.width},getHeight:function(){return this.height},setName:function(name){this.name=name},getName:function(){return this.name},draw:function(renderContext){renderContext=renderContext||p;if(this.visible){this.pre(renderContext);this.drawImpl(renderContext);this.post(renderContext)}},drawImpl:function(renderContext){if(this.family===0)this.drawGroup(renderContext);else if(this.family===1)this.drawPrimitive(renderContext);else if(this.family===3)this.drawGeometry(renderContext);else if(this.family===21)this.drawPath(renderContext)},drawPath:function(renderContext){var i,j;if(this.vertices.length===0)return;renderContext.beginShape();if(this.vertexCodes.length===0)if(this.vertices[0].length===2)for(i=0,j=this.vertices.length;i<j;i++)renderContext.vertex(this.vertices[i][0],this.vertices[i][1]);else for(i=0,j=this.vertices.length;i<j;i++)renderContext.vertex(this.vertices[i][0],this.vertices[i][1],this.vertices[i][2]);else{var index=0;if(this.vertices[0].length===2)for(i=0,j=this.vertexCodes.length;i<j;i++)if(this.vertexCodes[i]===0){renderContext.vertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index]["moveTo"]);renderContext.breakShape=false;index++}else if(this.vertexCodes[i]===1){renderContext.bezierVertex(this.vertices[index+0][0],this.vertices[index+0][1],this.vertices[index+1][0],this.vertices[index+1][1],this.vertices[index+2][0],this.vertices[index+2][1]);index+=3}else if(this.vertexCodes[i]===2){renderContext.curveVertex(this.vertices[index][0],this.vertices[index][1]);index++}else{if(this.vertexCodes[i]===3)renderContext.breakShape=true}else for(i=0,j=this.vertexCodes.length;i<j;i++)if(this.vertexCodes[i]===0){renderContext.vertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index][2]);if(this.vertices[index]["moveTo"]===true)vertArray[vertArray.length-1]["moveTo"]=true;else if(this.vertices[index]["moveTo"]===false)vertArray[vertArray.length-1]["moveTo"]=false;renderContext.breakShape=false}else if(this.vertexCodes[i]===1){renderContext.bezierVertex(this.vertices[index+0][0],this.vertices[index+0][1],this.vertices[index+0][2],this.vertices[index+1][0],this.vertices[index+1][1],this.vertices[index+1][2],this.vertices[index+2][0],this.vertices[index+2][1],this.vertices[index+2][2]);index+=3}else if(this.vertexCodes[i]===2){renderContext.curveVertex(this.vertices[index][0],this.vertices[index][1],this.vertices[index][2]);index++}else if(this.vertexCodes[i]===3)renderContext.breakShape=true}renderContext.endShape(this.close?2:1)},drawGeometry:function(renderContext){var i,j;renderContext.beginShape(this.kind);if(this.style)for(i=0,j=this.vertices.length;i<j;i++)renderContext.vertex(this.vertices[i]);else for(i=0,j=this.vertices.length;i<j;i++){var vert=this.vertices[i];if(vert[2]===0)renderContext.vertex(vert[0],vert[1]);else renderContext.vertex(vert[0],vert[1],vert[2])}renderContext.endShape()},drawGroup:function(renderContext){for(var i=0,j=this.children.length;i<j;i++)this.children[i].draw(renderContext)},drawPrimitive:function(renderContext){if(this.kind===2)renderContext.point(this.params[0],this.params[1]);else if(this.kind===4)if(this.params.length===4)renderContext.line(this.params[0],this.params[1],this.params[2],this.params[3]);else renderContext.line(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(this.kind===8)renderContext.triangle(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(this.kind===16)renderContext.quad(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5],this.params[6],this.params[7]);else if(this.kind===30)if(this.image!==null){var imMode=imageModeConvert;renderContext.imageMode(0);renderContext.image(this.image,this.params[0],this.params[1],this.params[2],this.params[3]);imageModeConvert=imMode}else{var rcMode=curRectMode;renderContext.rectMode(0);renderContext.rect(this.params[0],this.params[1],this.params[2],this.params[3]);curRectMode=rcMode}else if(this.kind===31){var elMode=curEllipseMode;renderContext.ellipseMode(0);renderContext.ellipse(this.params[0],this.params[1],this.params[2],this.params[3]);curEllipseMode=elMode}else if(this.kind===32){var eMode=curEllipseMode;renderContext.ellipseMode(0);renderContext.arc(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);curEllipseMode=eMode}else if(this.kind===41)if(this.params.length===1)renderContext.box(this.params[0]);else renderContext.box(this.params[0],this.params[1],this.params[2]);else if(this.kind===40)renderContext.sphere(this.params[0])},pre:function(renderContext){if(this.matrix){renderContext.pushMatrix();renderContext.transform(this.matrix)}if(this.style){renderContext.pushStyle();this.styles(renderContext)}},post:function(renderContext){if(this.matrix)renderContext.popMatrix();if(this.style)renderContext.popStyle()},styles:function(renderContext){if(this.stroke){renderContext.stroke(this.strokeColor);renderContext.strokeWeight(this.strokeWeight);renderContext.strokeCap(this.strokeCap);renderContext.strokeJoin(this.strokeJoin)}else renderContext.noStroke();if(this.fill)renderContext.fill(this.fillColor);else renderContext.noFill()},getChild:function(child){var i,j;if(typeof child==="number")return this.children[child];var found;if(child===""||this.name===child)return this;if(this.nameTable.length>0){for(i=0,j=this.nameTable.length;i<j||found;i++)if(this.nameTable[i].getName===child){found=this.nameTable[i];break}if(found)return found}for(i=0,j=this.children.length;i<j;i++){found=this.children[i].getChild(child);if(found)return found}return null},getChildCount:function(){return this.children.length},addChild:function(child){this.children.push(child);child.parent=this;if(child.getName()!==null)this.addName(child.getName(),child)},addName:function(name,shape){if(this.parent!==null)this.parent.addName(name,shape);else this.nameTable.push([name,shape])},translate:function(){if(arguments.length===2){this.checkMatrix(2);this.matrix.translate(arguments[0],arguments[1])}else{this.checkMatrix(3);this.matrix.translate(arguments[0],arguments[1],0)}},checkMatrix:function(dimensions){if(this.matrix===null)if(dimensions===2)this.matrix=new p.PMatrix2D;else this.matrix=new p.PMatrix3D;else if(dimensions===3&&this.matrix instanceof p.PMatrix2D)this.matrix=new p.PMatrix3D},rotateX:function(angle){this.rotate(angle,1,0,0)},rotateY:function(angle){this.rotate(angle,0,1,0)},rotateZ:function(angle){this.rotate(angle,0,0,1)},rotate:function(){if(arguments.length===1){this.checkMatrix(2);this.matrix.rotate(arguments[0])}else{this.checkMatrix(3);this.matrix.rotate(arguments[0],arguments[1],arguments[2],arguments[3])}},scale:function(){if(arguments.length===2){this.checkMatrix(2);this.matrix.scale(arguments[0],arguments[1])}else if(arguments.length===3){this.checkMatrix(2);this.matrix.scale(arguments[0],arguments[1],arguments[2])}else{this.checkMatrix(2);this.matrix.scale(arguments[0])}},resetMatrix:function(){this.checkMatrix(2);this.matrix.reset()},applyMatrix:function(matrix){if(arguments.length===1)this.applyMatrix(matrix.elements[0],matrix.elements[1],0,matrix.elements[2],matrix.elements[3],matrix.elements[4],0,matrix.elements[5],0,0,1,0,0,0,0,1);else if(arguments.length===6){this.checkMatrix(2);this.matrix.apply(arguments[0],arguments[1],arguments[2],0,arguments[3],arguments[4],arguments[5],0,0,0,1,0,0,0,0,1)}else if(arguments.length===16){this.checkMatrix(3);this.matrix.apply(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15])}}};var PShapeSVG=p.PShapeSVG=function(){p.PShape.call(this);if(arguments.length===1){this.element=arguments[0];this.vertexCodes=[];this.vertices=[];this.opacity=1;this.stroke=false;this.strokeColor=4278190080;this.strokeWeight=1;this.strokeCap="butt";this.strokeJoin="miter";this.strokeGradient=null;this.strokeGradientPaint=null;this.strokeName=null;this.strokeOpacity=1;this.fill=true;this.fillColor=4278190080;this.fillGradient=null;this.fillGradientPaint=null;this.fillName=null;this.fillOpacity=1;if(this.element.getName()!=="svg")throw"root is not <svg>, it's <"+this.element.getName()+">"}else if(arguments.length===2)if(typeof arguments[1]==="string"){if(arguments[1].indexOf(".svg")>-1){this.element=new p.XMLElement(p,arguments[1]);this.vertexCodes=[];this.vertices=[];this.opacity=1;this.stroke=false;this.strokeColor=4278190080;this.strokeWeight=1;this.strokeCap="butt";this.strokeJoin="miter";this.strokeGradient="";this.strokeGradientPaint="";this.strokeName="";this.strokeOpacity=1;this.fill=true;this.fillColor=4278190080;this.fillGradient=null;this.fillGradientPaint=null;this.fillOpacity=1}}else if(arguments[0]){this.element=arguments[1];this.vertexCodes=arguments[0].vertexCodes.slice();this.vertices=arguments[0].vertices.slice();this.stroke=arguments[0].stroke;this.strokeColor=arguments[0].strokeColor;this.strokeWeight=arguments[0].strokeWeight;this.strokeCap=arguments[0].strokeCap;this.strokeJoin=arguments[0].strokeJoin;this.strokeGradient=arguments[0].strokeGradient;this.strokeGradientPaint=arguments[0].strokeGradientPaint;this.strokeName=arguments[0].strokeName;this.fill=arguments[0].fill;this.fillColor=arguments[0].fillColor;this.fillGradient=arguments[0].fillGradient;this.fillGradientPaint=arguments[0].fillGradientPaint;this.fillName=arguments[0].fillName;this.strokeOpacity=arguments[0].strokeOpacity;this.fillOpacity=arguments[0].fillOpacity;this.opacity=arguments[0].opacity}this.name=this.element.getStringAttribute("id");var displayStr=this.element.getStringAttribute("display","inline");this.visible=displayStr!=="none";var str=this.element.getAttribute("transform");if(str)this.matrix=this.parseMatrix(str);var viewBoxStr=this.element.getStringAttribute("viewBox");if(viewBoxStr!==null){var viewBox=viewBoxStr.split(" ");this.width=viewBox[2];this.height=viewBox[3]}var unitWidth=this.element.getStringAttribute("width");var unitHeight=this.element.getStringAttribute("height");if(unitWidth!==null){this.width=this.parseUnitSize(unitWidth);this.height=this.parseUnitSize(unitHeight)}else if(this.width===0||this.height===0){this.width=1;this.height=1;throw"The width and/or height is not "+"readable in the <svg> tag of this file."}this.parseColors(this.element);this.parseChildren(this.element)};PShapeSVG.prototype=new PShape;PShapeSVG.prototype.parseMatrix=function(){function getCoords(s){var m=[];s.replace(/\((.*?)\)/,function(){return function(all,params){m=params.replace(/,+/g," ").split(/\s+/)}}());return m}return function(str){this.checkMatrix(2);var pieces=[];str.replace(/\s*(\w+)\((.*?)\)/g,function(all){pieces.push(p.trim(all))});if(pieces.length===0)return null;for(var i=0,j=pieces.length;i<j;i++){var m=getCoords(pieces[i]);if(pieces[i].indexOf("matrix")!==-1)this.matrix.set(m[0],m[2],m[4],m[1],m[3],m[5]);else if(pieces[i].indexOf("translate")!==-1){var tx=m[0];var ty=m.length===2?m[1]:0;this.matrix.translate(tx,ty)}else if(pieces[i].indexOf("scale")!==-1){var sx=m[0];var sy=m.length===2?m[1]:m[0];this.matrix.scale(sx,sy)}else if(pieces[i].indexOf("rotate")!==-1){var angle=m[0];if(m.length===1)this.matrix.rotate(p.radians(angle));else if(m.length===3){this.matrix.translate(m[1],m[2]);this.matrix.rotate(p.radians(m[0]));this.matrix.translate(-m[1],-m[2])}}else if(pieces[i].indexOf("skewX")!==-1)this.matrix.skewX(parseFloat(m[0]));else if(pieces[i].indexOf("skewY")!==-1)this.matrix.skewY(m[0]);else if(pieces[i].indexOf("shearX")!==-1)this.matrix.shearX(m[0]);else if(pieces[i].indexOf("shearY")!==-1)this.matrix.shearY(m[0])}return this.matrix}}();PShapeSVG.prototype.parseChildren=function(element){var newelement=element.getChildren();var children=new p.PShape;for(var i=0,j=newelement.length;i<j;i++){var kid=this.parseChild(newelement[i]);if(kid)children.addChild(kid)}this.children.push(children)};PShapeSVG.prototype.getName=function(){return this.name};PShapeSVG.prototype.parseChild=function(elem){var name=elem.getName();var shape;if(name==="g")shape=new PShapeSVG(this,elem);else if(name==="defs")shape=new PShapeSVG(this,elem);else if(name==="line"){shape=new PShapeSVG(this,elem);shape.parseLine()}else if(name==="circle"){shape=new PShapeSVG(this,elem);shape.parseEllipse(true)}else if(name==="ellipse"){shape=new PShapeSVG(this,elem);shape.parseEllipse(false)}else if(name==="rect"){shape=new PShapeSVG(this,elem);shape.parseRect()}else if(name==="polygon"){shape=new PShapeSVG(this,elem);shape.parsePoly(true)}else if(name==="polyline"){shape=new PShapeSVG(this,elem);shape.parsePoly(false)}else if(name==="path"){shape=new PShapeSVG(this,elem);shape.parsePath()}else if(name==="radialGradient")unimplemented("PShapeSVG.prototype.parseChild, name = radialGradient");else if(name==="linearGradient")unimplemented("PShapeSVG.prototype.parseChild, name = linearGradient");else if(name==="text")unimplemented("PShapeSVG.prototype.parseChild, name = text");else if(name==="filter")unimplemented("PShapeSVG.prototype.parseChild, name = filter");else if(name==="mask")unimplemented("PShapeSVG.prototype.parseChild, name = mask");else nop();return shape};PShapeSVG.prototype.parsePath=function(){this.family=21;this.kind=0;var pathDataChars=[];var c;var pathData=p.trim(this.element.getStringAttribute("d").replace(/[\s,]+/g," "));if(pathData===null)return;pathData=p.__toCharArray(pathData);var cx=0,cy=0,ctrlX=0,ctrlY=0,ctrlX1=0,ctrlX2=0,ctrlY1=0,ctrlY2=0,endX=0,endY=0,ppx=0,ppy=0,px=0,py=0,i=0,valOf=0;var str="";var tmpArray=[];var flag=false;var lastInstruction;var command;var j,k;while(i<pathData.length){valOf=pathData[i].valueOf();if(valOf>=65&&valOf<=90||valOf>=97&&valOf<=122){j=i;i++;if(i<pathData.length){tmpArray=[];valOf=pathData[i].valueOf();while(!(valOf>=65&&valOf<=90||valOf>=97&&valOf<=100||valOf>=102&&valOf<=122)&&flag===false){if(valOf===32){if(str!==""){tmpArray.push(parseFloat(str));str=""}i++}else if(valOf===45)if(pathData[i-1].valueOf()===101){str+=pathData[i].toString();i++}else{if(str!=="")tmpArray.push(parseFloat(str));str=pathData[i].toString();i++}else{str+=pathData[i].toString();i++}if(i===pathData.length)flag=true;else valOf=pathData[i].valueOf()}}if(str!==""){tmpArray.push(parseFloat(str));
str=""}command=pathData[j];valOf=command.valueOf();if(valOf===77){if(tmpArray.length>=2&&tmpArray.length%2===0){cx=tmpArray[0];cy=tmpArray[1];this.parsePathMoveto(cx,cy);if(tmpArray.length>2)for(j=2,k=tmpArray.length;j<k;j+=2){cx=tmpArray[j];cy=tmpArray[j+1];this.parsePathLineto(cx,cy)}}}else if(valOf===109){if(tmpArray.length>=2&&tmpArray.length%2===0){cx+=tmpArray[0];cy+=tmpArray[1];this.parsePathMoveto(cx,cy);if(tmpArray.length>2)for(j=2,k=tmpArray.length;j<k;j+=2){cx+=tmpArray[j];cy+=tmpArray[j+1];this.parsePathLineto(cx,cy)}}}else if(valOf===76){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;j<k;j+=2){cx=tmpArray[j];cy=tmpArray[j+1];this.parsePathLineto(cx,cy)}}else if(valOf===108){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;j<k;j+=2){cx+=tmpArray[j];cy+=tmpArray[j+1];this.parsePathLineto(cx,cy)}}else if(valOf===72)for(j=0,k=tmpArray.length;j<k;j++){cx=tmpArray[j];this.parsePathLineto(cx,cy)}else if(valOf===104)for(j=0,k=tmpArray.length;j<k;j++){cx+=tmpArray[j];this.parsePathLineto(cx,cy)}else if(valOf===86)for(j=0,k=tmpArray.length;j<k;j++){cy=tmpArray[j];this.parsePathLineto(cx,cy)}else if(valOf===118)for(j=0,k=tmpArray.length;j<k;j++){cy+=tmpArray[j];this.parsePathLineto(cx,cy)}else if(valOf===67){if(tmpArray.length>=6&&tmpArray.length%6===0)for(j=0,k=tmpArray.length;j<k;j+=6){ctrlX1=tmpArray[j];ctrlY1=tmpArray[j+1];ctrlX2=tmpArray[j+2];ctrlY2=tmpArray[j+3];endX=tmpArray[j+4];endY=tmpArray[j+5];this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY);cx=endX;cy=endY}}else if(valOf===99){if(tmpArray.length>=6&&tmpArray.length%6===0)for(j=0,k=tmpArray.length;j<k;j+=6){ctrlX1=cx+tmpArray[j];ctrlY1=cy+tmpArray[j+1];ctrlX2=cx+tmpArray[j+2];ctrlY2=cy+tmpArray[j+3];endX=cx+tmpArray[j+4];endY=cy+tmpArray[j+5];this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY);cx=endX;cy=endY}}else if(valOf===83){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;j<k;j+=4){if(lastInstruction.toLowerCase()==="c"||lastInstruction.toLowerCase()==="s"){ppx=this.vertices[this.vertices.length-2][0];ppy=this.vertices[this.vertices.length-2][1];px=this.vertices[this.vertices.length-1][0];py=this.vertices[this.vertices.length-1][1];ctrlX1=px+(px-ppx);ctrlY1=py+(py-ppy)}else{ctrlX1=this.vertices[this.vertices.length-1][0];ctrlY1=this.vertices[this.vertices.length-1][1]}ctrlX2=tmpArray[j];ctrlY2=tmpArray[j+1];endX=tmpArray[j+2];endY=tmpArray[j+3];this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY);cx=endX;cy=endY}}else if(valOf===115){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;j<k;j+=4){if(lastInstruction.toLowerCase()==="c"||lastInstruction.toLowerCase()==="s"){ppx=this.vertices[this.vertices.length-2][0];ppy=this.vertices[this.vertices.length-2][1];px=this.vertices[this.vertices.length-1][0];py=this.vertices[this.vertices.length-1][1];ctrlX1=px+(px-ppx);ctrlY1=py+(py-ppy)}else{ctrlX1=this.vertices[this.vertices.length-1][0];ctrlY1=this.vertices[this.vertices.length-1][1]}ctrlX2=cx+tmpArray[j];ctrlY2=cy+tmpArray[j+1];endX=cx+tmpArray[j+2];endY=cy+tmpArray[j+3];this.parsePathCurveto(ctrlX1,ctrlY1,ctrlX2,ctrlY2,endX,endY);cx=endX;cy=endY}}else if(valOf===81){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;j<k;j+=4){ctrlX=tmpArray[j];ctrlY=tmpArray[j+1];endX=tmpArray[j+2];endY=tmpArray[j+3];this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY);cx=endX;cy=endY}}else if(valOf===113){if(tmpArray.length>=4&&tmpArray.length%4===0)for(j=0,k=tmpArray.length;j<k;j+=4){ctrlX=cx+tmpArray[j];ctrlY=cy+tmpArray[j+1];endX=cx+tmpArray[j+2];endY=cy+tmpArray[j+3];this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY);cx=endX;cy=endY}}else if(valOf===84){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;j<k;j+=2){if(lastInstruction.toLowerCase()==="q"||lastInstruction.toLowerCase()==="t"){ppx=this.vertices[this.vertices.length-2][0];ppy=this.vertices[this.vertices.length-2][1];px=this.vertices[this.vertices.length-1][0];py=this.vertices[this.vertices.length-1][1];ctrlX=px+(px-ppx);ctrlY=py+(py-ppy)}else{ctrlX=cx;ctrlY=cy}endX=tmpArray[j];endY=tmpArray[j+1];this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY);cx=endX;cy=endY}}else if(valOf===116){if(tmpArray.length>=2&&tmpArray.length%2===0)for(j=0,k=tmpArray.length;j<k;j+=2){if(lastInstruction.toLowerCase()==="q"||lastInstruction.toLowerCase()==="t"){ppx=this.vertices[this.vertices.length-2][0];ppy=this.vertices[this.vertices.length-2][1];px=this.vertices[this.vertices.length-1][0];py=this.vertices[this.vertices.length-1][1];ctrlX=px+(px-ppx);ctrlY=py+(py-ppy)}else{ctrlX=cx;ctrlY=cy}endX=cx+tmpArray[j];endY=cy+tmpArray[j+1];this.parsePathQuadto(cx,cy,ctrlX,ctrlY,endX,endY);cx=endX;cy=endY}}else if(valOf===90||valOf===122)this.close=true;lastInstruction=command.toString()}else i++}};PShapeSVG.prototype.parsePathQuadto=function(x1,y1,cx,cy,x2,y2){if(this.vertices.length>0){this.parsePathCode(1);this.parsePathVertex(x1+(cx-x1)*2/3,y1+(cy-y1)*2/3);this.parsePathVertex(x2+(cx-x2)*2/3,y2+(cy-y2)*2/3);this.parsePathVertex(x2,y2)}else throw"Path must start with M/m"};PShapeSVG.prototype.parsePathCurveto=function(x1,y1,x2,y2,x3,y3){if(this.vertices.length>0){this.parsePathCode(1);this.parsePathVertex(x1,y1);this.parsePathVertex(x2,y2);this.parsePathVertex(x3,y3)}else throw"Path must start with M/m"};PShapeSVG.prototype.parsePathLineto=function(px,py){if(this.vertices.length>0){this.parsePathCode(0);this.parsePathVertex(px,py);this.vertices[this.vertices.length-1]["moveTo"]=false}else throw"Path must start with M/m"};PShapeSVG.prototype.parsePathMoveto=function(px,py){if(this.vertices.length>0)this.parsePathCode(3);this.parsePathCode(0);this.parsePathVertex(px,py);this.vertices[this.vertices.length-1]["moveTo"]=true};PShapeSVG.prototype.parsePathVertex=function(x,y){var verts=[];verts[0]=x;verts[1]=y;this.vertices.push(verts)};PShapeSVG.prototype.parsePathCode=function(what){this.vertexCodes.push(what)};PShapeSVG.prototype.parsePoly=function(val){this.family=21;this.close=val;var pointsAttr=p.trim(this.element.getStringAttribute("points").replace(/[,\s]+/g," "));if(pointsAttr!==null){var pointsBuffer=pointsAttr.split(" ");if(pointsBuffer.length%2===0)for(var i=0,j=pointsBuffer.length;i<j;i++){var verts=[];verts[0]=pointsBuffer[i];verts[1]=pointsBuffer[++i];this.vertices.push(verts)}else throw"Error parsing polygon points: odd number of coordinates provided"}};PShapeSVG.prototype.parseRect=function(){this.kind=30;this.family=1;this.params=[];this.params[0]=this.element.getFloatAttribute("x");this.params[1]=this.element.getFloatAttribute("y");this.params[2]=this.element.getFloatAttribute("width");this.params[3]=this.element.getFloatAttribute("height");if(this.params[2]<0||this.params[3]<0)throw"svg error: negative width or height found while parsing <rect>"};PShapeSVG.prototype.parseEllipse=function(val){this.kind=31;this.family=1;this.params=[];this.params[0]=this.element.getFloatAttribute("cx")|0;this.params[1]=this.element.getFloatAttribute("cy")|0;var rx,ry;if(val){rx=ry=this.element.getFloatAttribute("r");if(rx<0)throw"svg error: negative radius found while parsing <circle>"}else{rx=this.element.getFloatAttribute("rx");ry=this.element.getFloatAttribute("ry");if(rx<0||ry<0)throw"svg error: negative x-axis radius or y-axis radius found while parsing <ellipse>"}this.params[0]-=rx;this.params[1]-=ry;this.params[2]=rx*2;this.params[3]=ry*2};PShapeSVG.prototype.parseLine=function(){this.kind=4;this.family=1;this.params=[];this.params[0]=this.element.getFloatAttribute("x1");this.params[1]=this.element.getFloatAttribute("y1");this.params[2]=this.element.getFloatAttribute("x2");this.params[3]=this.element.getFloatAttribute("y2")};PShapeSVG.prototype.parseColors=function(element){if(element.hasAttribute("opacity"))this.setOpacity(element.getAttribute("opacity"));if(element.hasAttribute("stroke"))this.setStroke(element.getAttribute("stroke"));if(element.hasAttribute("stroke-width"))this.setStrokeWeight(element.getAttribute("stroke-width"));if(element.hasAttribute("stroke-linejoin"))this.setStrokeJoin(element.getAttribute("stroke-linejoin"));if(element.hasAttribute("stroke-linecap"))this.setStrokeCap(element.getStringAttribute("stroke-linecap"));if(element.hasAttribute("fill"))this.setFill(element.getStringAttribute("fill"));if(element.hasAttribute("style")){var styleText=element.getStringAttribute("style");var styleTokens=styleText.toString().split(";");for(var i=0,j=styleTokens.length;i<j;i++){var tokens=p.trim(styleTokens[i].split(":"));if(tokens[0]==="fill")this.setFill(tokens[1]);else if(tokens[0]==="fill-opacity")this.setFillOpacity(tokens[1]);else if(tokens[0]==="stroke")this.setStroke(tokens[1]);else if(tokens[0]==="stroke-width")this.setStrokeWeight(tokens[1]);else if(tokens[0]==="stroke-linecap")this.setStrokeCap(tokens[1]);else if(tokens[0]==="stroke-linejoin")this.setStrokeJoin(tokens[1]);else if(tokens[0]==="stroke-opacity")this.setStrokeOpacity(tokens[1]);else if(tokens[0]==="opacity")this.setOpacity(tokens[1])}}};PShapeSVG.prototype.setFillOpacity=function(opacityText){this.fillOpacity=parseFloat(opacityText);this.fillColor=this.fillOpacity*255<<24|this.fillColor&16777215};PShapeSVG.prototype.setFill=function(fillText){var opacityMask=this.fillColor&4278190080;if(fillText==="none")this.fill=false;else if(fillText.indexOf("#")===0){this.fill=true;if(fillText.length===4)fillText=fillText.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3");this.fillColor=opacityMask|parseInt(fillText.substring(1),16)&16777215}else if(fillText.indexOf("rgb")===0){this.fill=true;this.fillColor=opacityMask|this.parseRGB(fillText)}else if(fillText.indexOf("url(#")===0)this.fillName=fillText.substring(5,fillText.length-1);else if(colors[fillText]){this.fill=true;this.fillColor=opacityMask|parseInt(colors[fillText].substring(1),16)&16777215}};PShapeSVG.prototype.setOpacity=function(opacity){this.strokeColor=parseFloat(opacity)*255<<24|this.strokeColor&16777215;this.fillColor=parseFloat(opacity)*255<<24|this.fillColor&16777215};PShapeSVG.prototype.setStroke=function(strokeText){var opacityMask=this.strokeColor&4278190080;if(strokeText==="none")this.stroke=false;else if(strokeText.charAt(0)==="#"){this.stroke=true;if(strokeText.length===4)strokeText=strokeText.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3");this.strokeColor=opacityMask|parseInt(strokeText.substring(1),16)&16777215}else if(strokeText.indexOf("rgb")===0){this.stroke=true;this.strokeColor=opacityMask|this.parseRGB(strokeText)}else if(strokeText.indexOf("url(#")===0)this.strokeName=strokeText.substring(5,strokeText.length-1);else if(colors[strokeText]){this.stroke=true;this.strokeColor=opacityMask|parseInt(colors[strokeText].substring(1),16)&16777215}};PShapeSVG.prototype.setStrokeWeight=function(weight){this.strokeWeight=this.parseUnitSize(weight)};PShapeSVG.prototype.setStrokeJoin=function(linejoin){if(linejoin==="miter")this.strokeJoin="miter";else if(linejoin==="round")this.strokeJoin="round";else if(linejoin==="bevel")this.strokeJoin="bevel"};PShapeSVG.prototype.setStrokeCap=function(linecap){if(linecap==="butt")this.strokeCap="butt";else if(linecap==="round")this.strokeCap="round";else if(linecap==="square")this.strokeCap="square"};PShapeSVG.prototype.setStrokeOpacity=function(opacityText){this.strokeOpacity=parseFloat(opacityText);this.strokeColor=this.strokeOpacity*255<<24|this.strokeColor&16777215};PShapeSVG.prototype.parseRGB=function(color){var sub=color.substring(color.indexOf("(")+1,color.indexOf(")"));var values=sub.split(", ");return values[0]<<16|values[1]<<8|values[2]};PShapeSVG.prototype.parseUnitSize=function(text){var len=text.length-2;if(len<0)return text;if(text.indexOf("pt")===len)return parseFloat(text.substring(0,len))*1.25;if(text.indexOf("pc")===len)return parseFloat(text.substring(0,len))*15;if(text.indexOf("mm")===len)return parseFloat(text.substring(0,len))*3.543307;if(text.indexOf("cm")===len)return parseFloat(text.substring(0,len))*35.43307;if(text.indexOf("in")===len)return parseFloat(text.substring(0,len))*90;if(text.indexOf("px")===len)return parseFloat(text.substring(0,len));return parseFloat(text)};p.shape=function(shape,x,y,width,height){if(arguments.length>=1&&arguments[0]!==null)if(shape.isVisible()){p.pushMatrix();if(curShapeMode===3)if(arguments.length===5){p.translate(x-width/2,y-height/2);p.scale(width/shape.getWidth(),height/shape.getHeight())}else if(arguments.length===3)p.translate(x-shape.getWidth()/2,-shape.getHeight()/2);else p.translate(-shape.getWidth()/2,-shape.getHeight()/2);else if(curShapeMode===0)if(arguments.length===5){p.translate(x,y);p.scale(width/shape.getWidth(),height/shape.getHeight())}else{if(arguments.length===3)p.translate(x,y)}else if(curShapeMode===1)if(arguments.length===5){width-=x;height-=y;p.translate(x,y);p.scale(width/shape.getWidth(),height/shape.getHeight())}else if(arguments.length===3)p.translate(x,y);shape.draw(p);if(arguments.length===1&&curShapeMode===3||arguments.length>1)p.popMatrix()}};p.shapeMode=function(mode){curShapeMode=mode};p.loadShape=function(filename){if(arguments.length===1)if(filename.indexOf(".svg")>-1)return new PShapeSVG(null,filename);return null};var XMLAttribute=function(fname,n,nameSpace,v,t){this.fullName=fname||"";this.name=n||"";this.namespace=nameSpace||"";this.value=v;this.type=t};XMLAttribute.prototype={getName:function(){return this.name},getFullName:function(){return this.fullName},getNamespace:function(){return this.namespace},getValue:function(){return this.value},getType:function(){return this.type},setValue:function(newval){this.value=newval}};var XMLElement=p.XMLElement=function(selector,uri,sysid,line){this.attributes=[];this.children=[];this.fullName=null;this.name=null;this.namespace="";this.content=null;this.parent=null;this.lineNr="";this.systemID="";this.type="ELEMENT";if(selector)if(typeof selector==="string")if(uri===undef&&selector.indexOf("<")>-1)this.parse(selector);else{this.fullName=selector;this.namespace=uri;this.systemId=sysid;this.lineNr=line}else this.parse(uri)};XMLElement.prototype={parse:function(textstring){var xmlDoc;try{var extension=textstring.substring(textstring.length-4);if(extension===".xml"||extension===".svg")textstring=ajax(textstring);xmlDoc=(new DOMParser).parseFromString(textstring,"text/xml");var elements=xmlDoc.documentElement;if(elements)this.parseChildrenRecursive(null,elements);else throw"Error loading document";return this}catch(e){throw e}},parseChildrenRecursive:function(parent,elementpath){var xmlelement,xmlattribute,tmpattrib,l,m,child;if(!parent){this.fullName=elementpath.localName;this.name=elementpath.nodeName;xmlelement=this}else{xmlelement=new XMLElement(elementpath.nodeName);xmlelement.parent=parent}if(elementpath.nodeType===3&&elementpath.textContent!=="")return this.createPCDataElement(elementpath.textContent);if(elementpath.nodeType===4)return this.createCDataElement(elementpath.textContent);if(elementpath.attributes)for(l=0,m=elementpath.attributes.length;l<m;l++){tmpattrib=elementpath.attributes[l];xmlattribute=new XMLAttribute(tmpattrib.getname,tmpattrib.nodeName,tmpattrib.namespaceURI,tmpattrib.nodeValue,tmpattrib.nodeType);xmlelement.attributes.push(xmlattribute)}if(elementpath.childNodes)for(l=0,m=elementpath.childNodes.length;l<m;l++){var node=elementpath.childNodes[l];child=xmlelement.parseChildrenRecursive(xmlelement,node);if(child!==null)xmlelement.children.push(child)}return xmlelement},createElement:function(fullname,namespaceuri,sysid,line){if(sysid===undef)return new XMLElement(fullname,namespaceuri);return new XMLElement(fullname,namespaceuri,sysid,line)},createPCDataElement:function(content,isCDATA){if(content.replace(/^\s+$/g,"")==="")return null;var pcdata=new XMLElement;pcdata.type="TEXT";pcdata.content=content;return pcdata},createCDataElement:function(content){var cdata=this.createPCDataElement(content);if(cdata===null)return null;cdata.type="CDATA";var htmlentities={"<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"},entity;for(entity in htmlentities)if(!Object.hasOwnProperty(htmlentities,entity))content=content.replace(new RegExp(entity,"g"),htmlentities[entity]);cdata.cdata=content;return cdata},hasAttribute:function(){if(arguments.length===1)return this.getAttribute(arguments[0])!==null;if(arguments.length===2)return this.getAttribute(arguments[0],arguments[1])!==null},equals:function(other){if(!(other instanceof XMLElement))return false;var i,j;if(this.fullName!==other.fullName)return false;if(this.attributes.length!==other.getAttributeCount())return false;if(this.attributes.length!==other.attributes.length)return false;var attr_name,attr_ns,attr_value,attr_type,attr_other;for(i=0,j=this.attributes.length;i<j;i++){attr_name=this.attributes[i].getName();attr_ns=this.attributes[i].getNamespace();attr_other=other.findAttribute(attr_name,attr_ns);if(attr_other===null)return false;if(this.attributes[i].getValue()!==attr_other.getValue())return false;if(this.attributes[i].getType()!==attr_other.getType())return false}if(this.children.length!==other.getChildCount())return false;if(this.children.length>0){var child1,child2;for(i=0,j=this.children.length;i<j;i++){child1=this.getChild(i);child2=other.getChild(i);if(!child1.equals(child2))return false}return true}return this.content===other.content},getContent:function(){if(this.type==="TEXT"||this.type==="CDATA")return this.content;var children=this.children;if(children.length===1&&(children[0].type==="TEXT"||children[0].type==="CDATA"))return children[0].content;return null},getAttribute:function(){var attribute;if(arguments.length===2){attribute=this.findAttribute(arguments[0]);if(attribute)return attribute.getValue();return arguments[1]}else if(arguments.length===1){attribute=this.findAttribute(arguments[0]);if(attribute)return attribute.getValue();return null}else if(arguments.length===3){attribute=this.findAttribute(arguments[0],arguments[1]);if(attribute)return attribute.getValue();return arguments[2]}},getStringAttribute:function(){if(arguments.length===1)return this.getAttribute(arguments[0]);if(arguments.length===2)return this.getAttribute(arguments[0],arguments[1]);return this.getAttribute(arguments[0],arguments[1],arguments[2])},getString:function(attributeName){return this.getStringAttribute(attributeName)},getFloatAttribute:function(){if(arguments.length===1)return parseFloat(this.getAttribute(arguments[0],0));if(arguments.length===2)return this.getAttribute(arguments[0],arguments[1]);return this.getAttribute(arguments[0],arguments[1],arguments[2])},getFloat:function(attributeName){return this.getFloatAttribute(attributeName)},getIntAttribute:function(){if(arguments.length===1)return this.getAttribute(arguments[0],0);if(arguments.length===2)return this.getAttribute(arguments[0],arguments[1]);return this.getAttribute(arguments[0],arguments[1],arguments[2])},getInt:function(attributeName){return this.getIntAttribute(attributeName)},hasChildren:function(){return this.children.length>0},addChild:function(child){if(child!==null){child.parent=this;this.children.push(child)}},insertChild:function(child,index){if(child){if(child.getLocalName()===null&&!this.hasChildren()){var lastChild=this.children[this.children.length-1];if(lastChild.getLocalName()===null){lastChild.setContent(lastChild.getContent()+child.getContent());return}}child.parent=this;this.children.splice(index,0,child)}},getChild:function(selector){if(typeof selector==="number")return this.children[selector];if(selector.indexOf("/")!==-1)return this.getChildRecursive(selector.split("/"),0);var kid,kidName;for(var i=0,j=this.getChildCount();i<j;i++){kid=this.getChild(i);kidName=kid.getName();if(kidName!==null&&kidName===selector)return kid}return null},getChildren:function(){if(arguments.length===1){if(typeof arguments[0]==="number")return this.getChild(arguments[0]);if(arguments[0].indexOf("/")!==-1)return this.getChildrenRecursive(arguments[0].split("/"),0);var matches=[];var kid,kidName;for(var i=0,j=this.getChildCount();i<j;i++){kid=this.getChild(i);kidName=kid.getName();if(kidName!==null&&kidName===arguments[0])matches.push(kid)}return matches}return this.children},getChildCount:function(){return this.children.length},getChildRecursive:function(items,offset){if(offset===items.length)return this;var kid,kidName,matchName=items[offset];for(var i=0,j=this.getChildCount();i<j;i++){kid=this.getChild(i);kidName=kid.getName();if(kidName!==null&&kidName===matchName)return kid.getChildRecursive(items,offset+1)}return null},getChildrenRecursive:function(items,offset){if(offset===items.length-1)return this.getChildren(items[offset]);var matches=this.getChildren(items[offset]);var kidMatches=[];for(var i=0;i<matches.length;i++)kidMatches=kidMatches.concat(matches[i].getChildrenRecursive(items,offset+1));return kidMatches},isLeaf:function(){return!this.hasChildren()},listChildren:function(){var arr=[];for(var i=0,j=this.children.length;i<j;i++)arr.push(this.getChild(i).getName());return arr},removeAttribute:function(name,namespace){this.namespace=namespace||"";for(var i=0,j=this.attributes.length;i<j;i++)if(this.attributes[i].getName()===name&&this.attributes[i].getNamespace()===this.namespace){this.attributes.splice(i,1);break}},removeChild:function(child){if(child)for(var i=0,j=this.children.length;i<j;i++)if(this.children[i].equals(child)){this.children.splice(i,1);break}},removeChildAtIndex:function(index){if(this.children.length>index)this.children.splice(index,1)},findAttribute:function(name,namespace){this.namespace=namespace||"";for(var i=0,j=this.attributes.length;i<j;i++)if(this.attributes[i].getName()===name&&this.attributes[i].getNamespace()===this.namespace)return this.attributes[i];return null},setAttribute:function(){var attr;if(arguments.length===3){var index=arguments[0].indexOf(":");var name=arguments[0].substring(index+1);attr=this.findAttribute(name,arguments[1]);if(attr)attr.setValue(arguments[2]);else{attr=new XMLAttribute(arguments[0],name,arguments[1],arguments[2],"CDATA");this.attributes.push(attr)}}else{attr=this.findAttribute(arguments[0]);if(attr)attr.setValue(arguments[1]);else{attr=new XMLAttribute(arguments[0],arguments[0],null,arguments[1],"CDATA");this.attributes.push(attr)}}},setString:function(attribute,value){this.setAttribute(attribute,value)},setInt:function(attribute,value){this.setAttribute(attribute,value)},setFloat:function(attribute,value){this.setAttribute(attribute,value)},setContent:function(content){if(this.children.length>0)Processing.debug("Tried to set content for XMLElement with children");this.content=content},setName:function(){if(arguments.length===1){this.name=arguments[0];this.fullName=arguments[0];this.namespace=null}else{var index=arguments[0].indexOf(":");if(arguments[1]===null||index<0)this.name=arguments[0];else this.name=arguments[0].substring(index+1);this.fullName=arguments[0];this.namespace=arguments[1]}},getName:function(){return this.fullName},getLocalName:function(){return this.name},getAttributeCount:function(){return this.attributes.length},toString:function(){if(this.type==="TEXT")return this.content;if(this.type==="CDATA")return this.cdata;var tagstring=this.fullName;var xmlstring="<"+tagstring;var a,c;for(a=0;a<this.attributes.length;a++){var attr=this.attributes[a];xmlstring+=" "+attr.getName()+"="+'"'+attr.getValue()+'"'}if(this.children.length===0)if(this.content==="")xmlstring+="/>";else xmlstring+=">"+this.content+"</"+tagstring+">";else{xmlstring+=">";for(c=0;c<this.children.length;c++)xmlstring+=this.children[c].toString();xmlstring+="</"+tagstring+">"}return xmlstring}};XMLElement.parse=function(xmlstring){var element=new XMLElement;element.parse(xmlstring);return element};var XML=p.XML=p.XMLElement;p.loadXML=function(uri){return new XML(p,uri)};var printMatrixHelper=function(elements){var big=0;for(var i=0;i<elements.length;i++)if(i!==0)big=Math.max(big,Math.abs(elements[i]));else big=Math.abs(elements[i]);var digits=(big+"").indexOf(".");if(digits===0)digits=1;else if(digits===-1)digits=(big+"").length;return digits};var PMatrix2D=p.PMatrix2D=function(){if(arguments.length===0)this.reset();else if(arguments.length===1&&arguments[0]instanceof PMatrix2D)this.set(arguments[0].array());else if(arguments.length===6)this.set(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};PMatrix2D.prototype={set:function(){if(arguments.length===6){var a=arguments;this.set([a[0],a[1],a[2],a[3],a[4],a[5]])}else if(arguments.length===1&&arguments[0]instanceof PMatrix2D)this.elements=arguments[0].array();else if(arguments.length===1&&arguments[0]instanceof Array)this.elements=arguments[0].slice()},get:function(){var outgoing=new PMatrix2D;outgoing.set(this.elements);return outgoing},reset:function(){this.set([1,0,0,0,1,0])},array:function array(){return this.elements.slice()},translate:function(tx,ty){this.elements[2]=tx*this.elements[0]+ty*this.elements[1]+this.elements[2];this.elements[5]=tx*this.elements[3]+ty*this.elements[4]+this.elements[5]},invTranslate:function(tx,ty){this.translate(-tx,-ty)},transpose:function(){},mult:function(source,target){var x,y;if(source instanceof PVector){x=source.x;y=source.y;if(!target)target=new PVector}else if(source instanceof Array){x=source[0];y=source[1];if(!target)target=[]}if(target instanceof Array){target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2];target[1]=this.elements[3]*x+this.elements[4]*y+this.elements[5]}else if(target instanceof PVector){target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2];target.y=this.elements[3]*x+this.elements[4]*y+this.elements[5];target.z=0}return target},multX:function(x,y){return x*this.elements[0]+y*this.elements[1]+this.elements[2]},multY:function(x,y){return x*this.elements[3]+y*this.elements[4]+this.elements[5]},skewX:function(angle){this.apply(1,0,1,angle,0,0)},skewY:function(angle){this.apply(1,0,1,0,angle,0)},shearX:function(angle){this.apply(1,0,1,Math.tan(angle),0,0)},shearY:function(angle){this.apply(1,0,1,0,Math.tan(angle),0)},determinant:function(){return this.elements[0]*this.elements[4]-this.elements[1]*this.elements[3]},invert:function(){var d=this.determinant();if(Math.abs(d)>-2147483648){var old00=this.elements[0];var old01=this.elements[1];var old02=this.elements[2];var old10=this.elements[3];var old11=this.elements[4];var old12=this.elements[5];this.elements[0]=old11/d;this.elements[3]=-old10/d;this.elements[1]=-old01/d;this.elements[4]=old00/d;this.elements[2]=(old01*old12-old11*old02)/d;this.elements[5]=(old10*old02-old00*old12)/d;return true}return false},scale:function(sx,sy){if(sx&&!sy)sy=sx;if(sx&&sy){this.elements[0]*=sx;this.elements[1]*=sy;this.elements[3]*=sx;this.elements[4]*=sy}},invScale:function(sx,sy){if(sx&&!sy)sy=sx;this.scale(1/sx,1/sy)},apply:function(){var source;if(arguments.length===1&&arguments[0]instanceof PMatrix2D)source=arguments[0].array();else if(arguments.length===6)source=Array.prototype.slice.call(arguments);else if(arguments.length===1&&arguments[0]instanceof Array)source=arguments[0];var result=[0,0,this.elements[2],0,0,this.elements[5]];var e=0;for(var row=0;row<2;row++)for(var col=0;col<3;col++,e++)result[e]+=this.elements[row*3+0]*source[col+0]+this.elements[row*3+1]*source[col+3];this.elements=result.slice()},preApply:function(){var source;if(arguments.length===1&&arguments[0]instanceof PMatrix2D)source=arguments[0].array();else if(arguments.length===6)source=Array.prototype.slice.call(arguments);else if(arguments.length===1&&arguments[0]instanceof Array)source=arguments[0];var result=[0,0,source[2],0,0,source[5]];result[2]=source[2]+this.elements[2]*source[0]+this.elements[5]*source[1];result[5]=source[5]+this.elements[2]*source[3]+this.elements[5]*source[4];result[0]=this.elements[0]*source[0]+this.elements[3]*source[1];result[3]=this.elements[0]*source[3]+this.elements[3]*source[4];result[1]=this.elements[1]*source[0]+this.elements[4]*source[1];result[4]=this.elements[1]*source[3]+this.elements[4]*source[4];this.elements=result.slice()},rotate:function(angle){var c=Math.cos(angle);var s=Math.sin(angle);var temp1=this.elements[0];var temp2=this.elements[1];this.elements[0]=c*temp1+s*temp2;this.elements[1]=-s*temp1+c*temp2;temp1=this.elements[3];temp2=this.elements[4];this.elements[3]=c*temp1+s*temp2;this.elements[4]=-s*temp1+c*temp2},rotateZ:function(angle){this.rotate(angle)},invRotateZ:function(angle){this.rotateZ(angle-Math.PI)},print:function(){var digits=printMatrixHelper(this.elements);var output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+"\n"+p.nfs(this.elements[3],digits,4)+" "+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+"\n\n";p.println(output)}};var PMatrix3D=p.PMatrix3D=function(){this.reset()};PMatrix3D.prototype={set:function(){if(arguments.length===16)this.elements=Array.prototype.slice.call(arguments);else if(arguments.length===1&&arguments[0]instanceof PMatrix3D)this.elements=arguments[0].array();else if(arguments.length===1&&arguments[0]instanceof Array)this.elements=arguments[0].slice()},get:function(){var outgoing=new PMatrix3D;outgoing.set(this.elements);return outgoing},reset:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},array:function array(){return this.elements.slice()},translate:function(tx,ty,tz){if(tz===undef)tz=0;this.elements[3]+=tx*this.elements[0]+ty*this.elements[1]+tz*this.elements[2];this.elements[7]+=tx*this.elements[4]+ty*this.elements[5]+tz*this.elements[6];this.elements[11]+=tx*this.elements[8]+ty*this.elements[9]+tz*this.elements[10];this.elements[15]+=tx*this.elements[12]+ty*this.elements[13]+tz*this.elements[14]},transpose:function(){var temp=this.elements[4];this.elements[4]=this.elements[1];this.elements[1]=temp;temp=this.elements[8];this.elements[8]=this.elements[2];this.elements[2]=temp;temp=this.elements[6];this.elements[6]=this.elements[9];this.elements[9]=temp;temp=this.elements[3];this.elements[3]=this.elements[12];this.elements[12]=temp;temp=this.elements[7];this.elements[7]=this.elements[13];this.elements[13]=temp;temp=this.elements[11];this.elements[11]=this.elements[14];this.elements[14]=temp},mult:function(source,target){var x,y,z,w;if(source instanceof PVector){x=source.x;y=source.y;z=source.z;w=1;if(!target)target=new PVector}else if(source instanceof Array){x=source[0];y=source[1];z=source[2];w=source[3]||1;if(!target||target.length!==3&&target.length!==4)target=[0,0,0]}if(target instanceof Array)if(target.length===3){target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3];target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7];target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]}else if(target.length===4){target[0]=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w;target[1]=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w;target[2]=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w;target[3]=this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w}if(target instanceof PVector){target.x=this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3];target.y=this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7];target.z=this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]}return target},preApply:function(){var source;if(arguments.length===1&&arguments[0]instanceof PMatrix3D)source=arguments[0].array();else if(arguments.length===16)source=Array.prototype.slice.call(arguments);else if(arguments.length===1&&arguments[0]instanceof Array)source=arguments[0];var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var e=0;for(var row=0;row<4;row++)for(var col=0;col<4;col++,e++)result[e]+=this.elements[col+0]*source[row*4+0]+this.elements[col+4]*source[row*4+1]+this.elements[col+8]*source[row*4+2]+this.elements[col+12]*source[row*4+3];this.elements=result.slice()},apply:function(){var source;if(arguments.length===1&&arguments[0]instanceof PMatrix3D)source=arguments[0].array();
else if(arguments.length===16)source=Array.prototype.slice.call(arguments);else if(arguments.length===1&&arguments[0]instanceof Array)source=arguments[0];var result=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var e=0;for(var row=0;row<4;row++)for(var col=0;col<4;col++,e++)result[e]+=this.elements[row*4+0]*source[col+0]+this.elements[row*4+1]*source[col+4]+this.elements[row*4+2]*source[col+8]+this.elements[row*4+3]*source[col+12];this.elements=result.slice()},rotate:function(angle,v0,v1,v2){if(!v1)this.rotateZ(angle);else{var c=p.cos(angle);var s=p.sin(angle);var t=1-c;this.apply(t*v0*v0+c,t*v0*v1-s*v2,t*v0*v2+s*v1,0,t*v0*v1+s*v2,t*v1*v1+c,t*v1*v2-s*v0,0,t*v0*v2-s*v1,t*v1*v2+s*v0,t*v2*v2+c,0,0,0,0,1)}},invApply:function(){if(inverseCopy===undef)inverseCopy=new PMatrix3D;var a=arguments;inverseCopy.set(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]);if(!inverseCopy.invert())return false;this.preApply(inverseCopy);return true},rotateX:function(angle){var c=p.cos(angle);var s=p.sin(angle);this.apply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},rotateY:function(angle){var c=p.cos(angle);var s=p.sin(angle);this.apply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},rotateZ:function(angle){var c=Math.cos(angle);var s=Math.sin(angle);this.apply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},scale:function(sx,sy,sz){if(sx&&!sy&&!sz)sy=sz=sx;else if(sx&&sy&&!sz)sz=1;if(sx&&sy&&sz){this.elements[0]*=sx;this.elements[1]*=sy;this.elements[2]*=sz;this.elements[4]*=sx;this.elements[5]*=sy;this.elements[6]*=sz;this.elements[8]*=sx;this.elements[9]*=sy;this.elements[10]*=sz;this.elements[12]*=sx;this.elements[13]*=sy;this.elements[14]*=sz}},skewX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},shearX:function(angle){var t=Math.tan(angle);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},shearY:function(angle){var t=Math.tan(angle);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(x,y,z,w){if(!z)return this.elements[0]*x+this.elements[1]*y+this.elements[3];if(!w)return this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3];return this.elements[0]*x+this.elements[1]*y+this.elements[2]*z+this.elements[3]*w},multY:function(x,y,z,w){if(!z)return this.elements[4]*x+this.elements[5]*y+this.elements[7];if(!w)return this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7];return this.elements[4]*x+this.elements[5]*y+this.elements[6]*z+this.elements[7]*w},multZ:function(x,y,z,w){if(!w)return this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11];return this.elements[8]*x+this.elements[9]*y+this.elements[10]*z+this.elements[11]*w},multW:function(x,y,z,w){if(!w)return this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15];return this.elements[12]*x+this.elements[13]*y+this.elements[14]*z+this.elements[15]*w},invert:function(){var fA0=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4];var fA1=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4];var fA2=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4];var fA3=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5];var fA4=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5];var fA5=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6];var fB0=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12];var fB1=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12];var fB2=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12];var fB3=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13];var fB4=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13];var fB5=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14];var fDet=fA0*fB5-fA1*fB4+fA2*fB3+fA3*fB2-fA4*fB1+fA5*fB0;if(Math.abs(fDet)<=1e-9)return false;var kInv=[];kInv[0]=+this.elements[5]*fB5-this.elements[6]*fB4+this.elements[7]*fB3;kInv[4]=-this.elements[4]*fB5+this.elements[6]*fB2-this.elements[7]*fB1;kInv[8]=+this.elements[4]*fB4-this.elements[5]*fB2+this.elements[7]*fB0;kInv[12]=-this.elements[4]*fB3+this.elements[5]*fB1-this.elements[6]*fB0;kInv[1]=-this.elements[1]*fB5+this.elements[2]*fB4-this.elements[3]*fB3;kInv[5]=+this.elements[0]*fB5-this.elements[2]*fB2+this.elements[3]*fB1;kInv[9]=-this.elements[0]*fB4+this.elements[1]*fB2-this.elements[3]*fB0;kInv[13]=+this.elements[0]*fB3-this.elements[1]*fB1+this.elements[2]*fB0;kInv[2]=+this.elements[13]*fA5-this.elements[14]*fA4+this.elements[15]*fA3;kInv[6]=-this.elements[12]*fA5+this.elements[14]*fA2-this.elements[15]*fA1;kInv[10]=+this.elements[12]*fA4-this.elements[13]*fA2+this.elements[15]*fA0;kInv[14]=-this.elements[12]*fA3+this.elements[13]*fA1-this.elements[14]*fA0;kInv[3]=-this.elements[9]*fA5+this.elements[10]*fA4-this.elements[11]*fA3;kInv[7]=+this.elements[8]*fA5-this.elements[10]*fA2+this.elements[11]*fA1;kInv[11]=-this.elements[8]*fA4+this.elements[9]*fA2-this.elements[11]*fA0;kInv[15]=+this.elements[8]*fA3-this.elements[9]*fA1+this.elements[10]*fA0;var fInvDet=1/fDet;kInv[0]*=fInvDet;kInv[1]*=fInvDet;kInv[2]*=fInvDet;kInv[3]*=fInvDet;kInv[4]*=fInvDet;kInv[5]*=fInvDet;kInv[6]*=fInvDet;kInv[7]*=fInvDet;kInv[8]*=fInvDet;kInv[9]*=fInvDet;kInv[10]*=fInvDet;kInv[11]*=fInvDet;kInv[12]*=fInvDet;kInv[13]*=fInvDet;kInv[14]*=fInvDet;kInv[15]*=fInvDet;this.elements=kInv.slice();return true},toString:function(){var str="";for(var i=0;i<15;i++)str+=this.elements[i]+", ";str+=this.elements[15];return str},print:function(){var digits=printMatrixHelper(this.elements);var output=""+p.nfs(this.elements[0],digits,4)+" "+p.nfs(this.elements[1],digits,4)+" "+p.nfs(this.elements[2],digits,4)+" "+p.nfs(this.elements[3],digits,4)+"\n"+p.nfs(this.elements[4],digits,4)+" "+p.nfs(this.elements[5],digits,4)+" "+p.nfs(this.elements[6],digits,4)+" "+p.nfs(this.elements[7],digits,4)+"\n"+p.nfs(this.elements[8],digits,4)+" "+p.nfs(this.elements[9],digits,4)+" "+p.nfs(this.elements[10],digits,4)+" "+p.nfs(this.elements[11],digits,4)+"\n"+p.nfs(this.elements[12],digits,4)+" "+p.nfs(this.elements[13],digits,4)+" "+p.nfs(this.elements[14],digits,4)+" "+p.nfs(this.elements[15],digits,4)+"\n\n";p.println(output)},invTranslate:function(tx,ty,tz){this.preApply(1,0,0,-tx,0,1,0,-ty,0,0,1,-tz,0,0,0,1)},invRotateX:function(angle){var c=Math.cos(-angle);var s=Math.sin(-angle);this.preApply([1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1])},invRotateY:function(angle){var c=Math.cos(-angle);var s=Math.sin(-angle);this.preApply([c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1])},invRotateZ:function(angle){var c=Math.cos(-angle);var s=Math.sin(-angle);this.preApply([c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1])},invScale:function(x,y,z){this.preApply([1/x,0,0,0,0,1/y,0,0,0,0,1/z,0,0,0,0,1])}};var PMatrixStack=p.PMatrixStack=function(){this.matrixStack=[]};PMatrixStack.prototype.load=function(){var tmpMatrix=drawing.$newPMatrix();if(arguments.length===1)tmpMatrix.set(arguments[0]);else tmpMatrix.set(arguments);this.matrixStack.push(tmpMatrix)};Drawing2D.prototype.$newPMatrix=function(){return new PMatrix2D};Drawing3D.prototype.$newPMatrix=function(){return new PMatrix3D};PMatrixStack.prototype.push=function(){this.matrixStack.push(this.peek())};PMatrixStack.prototype.pop=function(){return this.matrixStack.pop()};PMatrixStack.prototype.peek=function(){var tmpMatrix=drawing.$newPMatrix();tmpMatrix.set(this.matrixStack[this.matrixStack.length-1]);return tmpMatrix};PMatrixStack.prototype.mult=function(matrix){this.matrixStack[this.matrixStack.length-1].apply(matrix)};p.split=function(str,delim){return str.split(delim)};p.splitTokens=function(str,tokens){if(tokens===undef)return str.split(/\s+/g);var chars=tokens.split(/()/g),buffer="",len=str.length,i,c,tokenized=[];for(i=0;i<len;i++){c=str[i];if(chars.indexOf(c)>-1){if(buffer!=="")tokenized.push(buffer);buffer=""}else buffer+=c}if(buffer!=="")tokenized.push(buffer);return tokenized};p.append=function(array,element){array[array.length]=element;return array};p.concat=function(array1,array2){return array1.concat(array2)};p.sort=function(array,numElem){var ret=[];if(array.length>0){var elemsToCopy=numElem>0?numElem:array.length;for(var i=0;i<elemsToCopy;i++)ret.push(array[i]);if(typeof array[0]==="string")ret.sort();else ret.sort(function(a,b){return a-b});if(numElem>0)for(var j=ret.length;j<array.length;j++)ret.push(array[j])}return ret};p.splice=function(array,value,index){if(value.length===0)return array;if(value instanceof Array)for(var i=0,j=index;i<value.length;j++,i++)array.splice(j,0,value[i]);else array.splice(index,0,value);return array};p.subset=function(array,offset,length){var end=length!==undef?offset+length:array.length;return array.slice(offset,end)};p.join=function(array,seperator){return array.join(seperator)};p.shorten=function(ary){var newary=[];var len=ary.length;for(var i=0;i<len;i++)newary[i]=ary[i];newary.pop();return newary};p.expand=function(ary,targetSize){var temp=ary.slice(0),newSize=targetSize||ary.length*2;temp.length=newSize;return temp};p.arrayCopy=function(){var src,srcPos=0,dest,destPos=0,length;if(arguments.length===2){src=arguments[0];dest=arguments[1];length=src.length}else if(arguments.length===3){src=arguments[0];dest=arguments[1];length=arguments[2]}else if(arguments.length===5){src=arguments[0];srcPos=arguments[1];dest=arguments[2];destPos=arguments[3];length=arguments[4]}for(var i=srcPos,j=destPos;i<length+srcPos;i++,j++)if(dest[j]!==undef)dest[j]=src[i];else throw"array index out of bounds exception"};p.reverse=function(array){return array.reverse()};p.mix=function(a,b,f){return a+((b-a)*f>>8)};p.peg=function(n){return n<0?0:n>255?255:n};p.modes=function(){var ALPHA_MASK=4278190080,RED_MASK=16711680,GREEN_MASK=65280,BLUE_MASK=255,min=Math.min,max=Math.max;function applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb){var a=min(((c1&4278190080)>>>24)+f,255)<<24;var r=ar+((cr-ar)*f>>8);r=(r<0?0:r>255?255:r)<<16;var g=ag+((cg-ag)*f>>8);g=(g<0?0:g>255?255:g)<<8;var b=ab+((cb-ab)*f>>8);b=b<0?0:b>255?255:b;return a|r|g|b}return{replace:function(c1,c2){return c2},blend:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=c1&RED_MASK,ag=c1&GREEN_MASK,ab=c1&BLUE_MASK,br=c2&RED_MASK,bg=c2&GREEN_MASK,bb=c2&BLUE_MASK;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|ar+((br-ar)*f>>8)&RED_MASK|ag+((bg-ag)*f>>8)&GREEN_MASK|ab+((bb-ab)*f>>8)&BLUE_MASK},add:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|min((c1&RED_MASK)+((c2&RED_MASK)>>8)*f,RED_MASK)&RED_MASK|min((c1&GREEN_MASK)+((c2&GREEN_MASK)>>8)*f,GREEN_MASK)&GREEN_MASK|min((c1&BLUE_MASK)+((c2&BLUE_MASK)*f>>8),BLUE_MASK)},subtract:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|max((c1&RED_MASK)-((c2&RED_MASK)>>8)*f,GREEN_MASK)&RED_MASK|max((c1&GREEN_MASK)-((c2&GREEN_MASK)>>8)*f,BLUE_MASK)&GREEN_MASK|max((c1&BLUE_MASK)-((c2&BLUE_MASK)*f>>8),0)},lightest:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24;return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|max(c1&RED_MASK,((c2&RED_MASK)>>8)*f)&RED_MASK|max(c1&GREEN_MASK,((c2&GREEN_MASK)>>8)*f)&GREEN_MASK|max(c1&BLUE_MASK,(c2&BLUE_MASK)*f>>8)},darkest:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=c1&RED_MASK,ag=c1&GREEN_MASK,ab=c1&BLUE_MASK,br=min(c1&RED_MASK,((c2&RED_MASK)>>8)*f),bg=min(c1&GREEN_MASK,((c2&GREEN_MASK)>>8)*f),bb=min(c1&BLUE_MASK,(c2&BLUE_MASK)*f>>8);return min(((c1&ALPHA_MASK)>>>24)+f,255)<<24|ar+((br-ar)*f>>8)&RED_MASK|ag+((bg-ag)*f>>8)&GREEN_MASK|ab+((bb-ab)*f>>8)&BLUE_MASK},difference:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar>br?ar-br:br-ar,cg=ag>bg?ag-bg:bg-ag,cb=ab>bb?ab-bb:bb-ab;return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},exclusion:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar+br-(ar*br>>7),cg=ag+bg-(ag*bg>>7),cb=ab+bb-(ab*bb>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},multiply:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar*br>>8,cg=ag*bg>>8,cb=ab*bb>>8;return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},screen:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=255-((255-ar)*(255-br)>>8),cg=255-((255-ag)*(255-bg)>>8),cb=255-((255-ab)*(255-bb)>>8);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},hard_light:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=br<128?ar*br>>7:255-((255-ar)*(255-br)>>7),cg=bg<128?ag*bg>>7:255-((255-ag)*(255-bg)>>7),cb=bb<128?ab*bb>>7:255-((255-ab)*(255-bb)>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},soft_light:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=(ar*br>>7)+(ar*ar>>8)-(ar*ar*br>>15),cg=(ag*bg>>7)+(ag*ag>>8)-(ag*ag*bg>>15),cb=(ab*bb>>7)+(ab*ab>>8)-(ab*ab*bb>>15);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},overlay:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK,cr=ar<128?ar*br>>7:255-((255-ar)*(255-br)>>7),cg=ag<128?ag*bg>>7:255-((255-ag)*(255-bg)>>7),cb=ab<128?ab*bb>>7:255-((255-ab)*(255-bb)>>7);return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},dodge:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK;var cr=255;if(br!==255){cr=(ar<<8)/(255-br);cr=cr<0?0:cr>255?255:cr}var cg=255;if(bg!==255){cg=(ag<<8)/(255-bg);cg=cg<0?0:cg>255?255:cg}var cb=255;if(bb!==255){cb=(ab<<8)/(255-bb);cb=cb<0?0:cb>255?255:cb}return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)},burn:function(c1,c2){var f=(c2&ALPHA_MASK)>>>24,ar=(c1&RED_MASK)>>16,ag=(c1&GREEN_MASK)>>8,ab=c1&BLUE_MASK,br=(c2&RED_MASK)>>16,bg=(c2&GREEN_MASK)>>8,bb=c2&BLUE_MASK;var cr=0;if(br!==0){cr=(255-ar<<8)/br;cr=255-(cr<0?0:cr>255?255:cr)}var cg=0;if(bg!==0){cg=(255-ag<<8)/bg;cg=255-(cg<0?0:cg>255?255:cg)}var cb=0;if(bb!==0){cb=(255-ab<<8)/bb;cb=255-(cb<0?0:cb>255?255:cb)}return applyMode(c1,f,ar,ag,ab,br,bg,bb,cr,cg,cb)}}}();function color$4(aValue1,aValue2,aValue3,aValue4){var r,g,b,a;if(curColorMode===3){var rgb=p.color.toRGB(aValue1,aValue2,aValue3);r=rgb[0];g=rgb[1];b=rgb[2]}else{r=Math.round(255*(aValue1/colorModeX));g=Math.round(255*(aValue2/colorModeY));b=Math.round(255*(aValue3/colorModeZ))}a=Math.round(255*(aValue4/colorModeA));r=r<0?0:r;g=g<0?0:g;b=b<0?0:b;a=a<0?0:a;r=r>255?255:r;g=g>255?255:g;b=b>255?255:b;a=a>255?255:a;return a<<24&4278190080|r<<16&16711680|g<<8&65280|b&255}function color$2(aValue1,aValue2){var a;if(aValue1&4278190080){a=Math.round(255*(aValue2/colorModeA));a=a>255?255:a;a=a<0?0:a;return aValue1-(aValue1&4278190080)+(a<<24&4278190080)}if(curColorMode===1)return color$4(aValue1,aValue1,aValue1,aValue2);if(curColorMode===3)return color$4(0,0,aValue1/colorModeX*colorModeZ,aValue2)}function color$1(aValue1){if(aValue1<=colorModeX&&aValue1>=0){if(curColorMode===1)return color$4(aValue1,aValue1,aValue1,colorModeA);if(curColorMode===3)return color$4(0,0,aValue1/colorModeX*colorModeZ,colorModeA)}if(aValue1){if(aValue1>2147483647)aValue1-=4294967296;return aValue1}}p.color=function(aValue1,aValue2,aValue3,aValue4){if(aValue1!==undef&&aValue2!==undef&&aValue3!==undef&&aValue4!==undef)return color$4(aValue1,aValue2,aValue3,aValue4);if(aValue1!==undef&&aValue2!==undef&&aValue3!==undef)return color$4(aValue1,aValue2,aValue3,colorModeA);if(aValue1!==undef&&aValue2!==undef)return color$2(aValue1,aValue2);if(typeof aValue1==="number")return color$1(aValue1);return color$4(colorModeX,colorModeY,colorModeZ,colorModeA)};p.color.toString=function(colorInt){return"rgba("+(colorInt>>16&255)+","+(colorInt>>8&255)+","+(colorInt&255)+","+(colorInt>>24&255)/255+")"};p.color.toInt=function(r,g,b,a){return a<<24&4278190080|r<<16&16711680|g<<8&65280|b&255};p.color.toArray=function(colorInt){return[colorInt>>16&255,colorInt>>8&255,colorInt&255,colorInt>>24&255]};p.color.toGLArray=function(colorInt){return[((colorInt&16711680)>>>16)/255,(colorInt>>8&255)/255,(colorInt&255)/255,(colorInt>>24&255)/255]};p.color.toRGB=function(h,s,b){h=h>colorModeX?colorModeX:h;s=s>colorModeY?colorModeY:s;b=b>colorModeZ?colorModeZ:b;h=h/colorModeX*360;s=s/colorModeY*100;b=b/colorModeZ*100;var br=Math.round(b/100*255);if(s===0)return[br,br,br];var hue=h%360;var f=hue%60;var p=Math.round(b*(100-s)/1e4*255);var q=Math.round(b*(6e3-s*f)/6e5*255);var t=Math.round(b*(6e3-s*(60-f))/6e5*255);switch(Math.floor(hue/60)){case 0:return[br,t,p];case 1:return[q,br,p];case 2:return[p,br,t];case 3:return[p,q,br];case 4:return[t,p,br];case 5:return[br,p,q]}};function colorToHSB(colorInt){var red,green,blue;red=(colorInt>>16&255)/255;green=(colorInt>>8&255)/255;blue=(colorInt&255)/255;var max=p.max(p.max(red,green),blue),min=p.min(p.min(red,green),blue),hue,saturation;if(min===max)return[0,0,max*colorModeZ];saturation=(max-min)/max;if(red===max)hue=(green-blue)/(max-min);else if(green===max)hue=2+(blue-red)/(max-min);else hue=4+(red-green)/(max-min);hue/=6;if(hue<0)hue+=1;else if(hue>1)hue-=1;return[hue*colorModeX,saturation*colorModeY,max*colorModeZ]}p.brightness=function(colInt){return colorToHSB(colInt)[2]};p.saturation=function(colInt){return colorToHSB(colInt)[1]};p.hue=function(colInt){return colorToHSB(colInt)[0]};p.red=function(aColor){return(aColor>>16&255)/255*colorModeX};p.green=function(aColor){return((aColor&65280)>>>8)/255*colorModeY};p.blue=function(aColor){return(aColor&255)/255*colorModeZ};p.alpha=function(aColor){return(aColor>>24&255)/255*colorModeA};p.lerpColor=function(c1,c2,amt){var r,g,b,a,r1,g1,b1,a1,r2,g2,b2,a2;var hsb1,hsb2,rgb,h,s;var colorBits1=p.color(c1);var colorBits2=p.color(c2);if(curColorMode===3){hsb1=colorToHSB(colorBits1);a1=(colorBits1>>24&255)/colorModeA;hsb2=colorToHSB(colorBits2);a2=((colorBits2&4278190080)>>>24)/colorModeA;h=p.lerp(hsb1[0],hsb2[0],amt);s=p.lerp(hsb1[1],hsb2[1],amt);b=p.lerp(hsb1[2],hsb2[2],amt);rgb=p.color.toRGB(h,s,b);a=p.lerp(a1,a2,amt)*colorModeA;return a<<24&4278190080|(rgb[0]&255)<<16|(rgb[1]&255)<<8|rgb[2]&255}r1=colorBits1>>16&255;g1=colorBits1>>8&255;b1=colorBits1&255;a1=(colorBits1>>24&255)/colorModeA;r2=(colorBits2&16711680)>>>16;g2=colorBits2>>8&255;b2=colorBits2&255;a2=(colorBits2>>24&255)/colorModeA;r=p.lerp(r1,r2,amt)|0;g=p.lerp(g1,g2,amt)|0;b=p.lerp(b1,b2,amt)|0;a=p.lerp(a1,a2,amt)*colorModeA;return a<<24&4278190080|r<<16&16711680|g<<8&65280|b&255};p.colorMode=function(){curColorMode=arguments[0];if(arguments.length>1){colorModeX=arguments[1];colorModeY=arguments[2]||arguments[1];colorModeZ=arguments[3]||arguments[1];colorModeA=arguments[4]||arguments[1]}};p.blendColor=function(c1,c2,mode){if(mode===0)return p.modes.replace(c1,c2);else if(mode===1)return p.modes.blend(c1,c2);else if(mode===2)return p.modes.add(c1,c2);else if(mode===4)return p.modes.subtract(c1,c2);else if(mode===8)return p.modes.lightest(c1,c2);else if(mode===16)return p.modes.darkest(c1,c2);else if(mode===32)return p.modes.difference(c1,c2);else if(mode===64)return p.modes.exclusion(c1,c2);else if(mode===128)return p.modes.multiply(c1,c2);else if(mode===256)return p.modes.screen(c1,c2);else if(mode===1024)return p.modes.hard_light(c1,c2);else if(mode===2048)return p.modes.soft_light(c1,c2);else if(mode===512)return p.modes.overlay(c1,c2);else if(mode===4096)return p.modes.dodge(c1,c2);else if(mode===8192)return p.modes.burn(c1,c2)};function saveContext(){curContext.save()}function restoreContext(){curContext.restore();isStrokeDirty=true;isFillDirty=true}p.printMatrix=function(){modelView.print()};Drawing2D.prototype.translate=function(x,y){modelView.translate(x,y);modelViewInv.invTranslate(x,y);curContext.translate(x,y)};Drawing3D.prototype.translate=function(x,y,z){modelView.translate(x,y,z);modelViewInv.invTranslate(x,y,z)};Drawing2D.prototype.scale=function(x,y){modelView.scale(x,y);modelViewInv.invScale(x,y);curContext.scale(x,y||x)};Drawing3D.prototype.scale=function(x,y,z){modelView.scale(x,y,z);modelViewInv.invScale(x,y,z)};Drawing2D.prototype.transform=function(pmatrix){var e=pmatrix.array();curContext.transform(e[0],e[3],e[1],e[4],e[2],e[5])};Drawing3D.prototype.transformm=function(pmatrix3d){throw"p.transform is currently not supported in 3D mode"};Drawing2D.prototype.pushMatrix=function(){userMatrixStack.load(modelView);userReverseMatrixStack.load(modelViewInv);saveContext()};Drawing3D.prototype.pushMatrix=function(){userMatrixStack.load(modelView);userReverseMatrixStack.load(modelViewInv)};Drawing2D.prototype.popMatrix=function(){modelView.set(userMatrixStack.pop());modelViewInv.set(userReverseMatrixStack.pop());restoreContext()};Drawing3D.prototype.popMatrix=function(){modelView.set(userMatrixStack.pop());modelViewInv.set(userReverseMatrixStack.pop())};Drawing2D.prototype.resetMatrix=function(){modelView.reset();modelViewInv.reset();curContext.setTransform(1,0,0,1,0,0)};Drawing3D.prototype.resetMatrix=function(){modelView.reset();modelViewInv.reset()};DrawingShared.prototype.applyMatrix=function(){var a=arguments;modelView.apply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]);modelViewInv.invApply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])};Drawing2D.prototype.applyMatrix=function(){var a=arguments;for(var cnt=a.length;cnt<16;cnt++)a[cnt]=0;a[10]=a[15]=1;DrawingShared.prototype.applyMatrix.apply(this,a)};p.rotateX=function(angleInRadians){modelView.rotateX(angleInRadians);modelViewInv.invRotateX(angleInRadians)};Drawing2D.prototype.rotateZ=function(){throw"rotateZ() is not supported in 2D mode. Use rotate(float) instead."};Drawing3D.prototype.rotateZ=function(angleInRadians){modelView.rotateZ(angleInRadians);modelViewInv.invRotateZ(angleInRadians)};p.rotateY=function(angleInRadians){modelView.rotateY(angleInRadians);modelViewInv.invRotateY(angleInRadians)};Drawing2D.prototype.rotate=function(angleInRadians){modelView.rotateZ(angleInRadians);modelViewInv.invRotateZ(angleInRadians);curContext.rotate(angleInRadians)};Drawing3D.prototype.rotate=function(angleInRadians){p.rotateZ(angleInRadians)};Drawing2D.prototype.shearX=function(angleInRadians){modelView.shearX(angleInRadians);curContext.transform(1,0,angleInRadians,1,0,0)};Drawing3D.prototype.shearX=function(angleInRadians){modelView.shearX(angleInRadians)};Drawing2D.prototype.shearY=function(angleInRadians){modelView.shearY(angleInRadians);curContext.transform(1,angleInRadians,0,1,0,0)};Drawing3D.prototype.shearY=function(angleInRadians){modelView.shearY(angleInRadians)};p.pushStyle=function(){saveContext();p.pushMatrix();var newState={doFill:doFill,currentFillColor:currentFillColor,doStroke:doStroke,currentStrokeColor:currentStrokeColor,curTint:curTint,curRectMode:curRectMode,curColorMode:curColorMode,colorModeX:colorModeX,colorModeZ:colorModeZ,colorModeY:colorModeY,colorModeA:colorModeA,curTextFont:curTextFont,horizontalTextAlignment:horizontalTextAlignment,verticalTextAlignment:verticalTextAlignment,textMode:textMode,curFontName:curFontName,curTextSize:curTextSize,curTextAscent:curTextAscent,curTextDescent:curTextDescent,curTextLeading:curTextLeading};styleArray.push(newState)};p.popStyle=function(){var oldState=styleArray.pop();if(oldState){restoreContext();p.popMatrix();doFill=oldState.doFill;currentFillColor=oldState.currentFillColor;doStroke=oldState.doStroke;currentStrokeColor=oldState.currentStrokeColor;curTint=oldState.curTint;curRectMode=oldState.curRectMode;curColorMode=oldState.curColorMode;colorModeX=oldState.colorModeX;colorModeZ=oldState.colorModeZ;colorModeY=oldState.colorModeY;colorModeA=oldState.colorModeA;curTextFont=oldState.curTextFont;curFontName=oldState.curFontName;curTextSize=oldState.curTextSize;horizontalTextAlignment=oldState.horizontalTextAlignment;verticalTextAlignment=oldState.verticalTextAlignment;textMode=oldState.textMode;curTextAscent=oldState.curTextAscent;curTextDescent=oldState.curTextDescent;curTextLeading=oldState.curTextLeading}else throw"Too many popStyle() without enough pushStyle()"};p.year=function(){return(new Date).getFullYear()};p.month=function(){return(new Date).getMonth()+1};p.day=function(){return(new Date).getDate()};p.hour=function(){return(new Date).getHours()};p.minute=function(){return(new Date).getMinutes()};p.second=function(){return(new Date).getSeconds()};p.millis=function(){return Date.now()-start};function redrawHelper(){var sec=(Date.now()-timeSinceLastFPS)/1e3;framesSinceLastFPS++;var fps=framesSinceLastFPS/sec;if(sec>.5){timeSinceLastFPS=Date.now();framesSinceLastFPS=0;p.__frameRate=fps}p.frameCount++}Drawing2D.prototype.redraw=function(){redrawHelper();curContext.lineWidth=lineWidth;var pmouseXLastEvent=p.pmouseX,pmouseYLastEvent=p.pmouseY;p.pmouseX=pmouseXLastFrame;p.pmouseY=pmouseYLastFrame;saveContext();p.draw();restoreContext();pmouseXLastFrame=p.mouseX;pmouseYLastFrame=p.mouseY;p.pmouseX=pmouseXLastEvent;p.pmouseY=pmouseYLastEvent};Drawing3D.prototype.redraw=function(){redrawHelper();var pmouseXLastEvent=p.pmouseX,pmouseYLastEvent=p.pmouseY;p.pmouseX=pmouseXLastFrame;p.pmouseY=pmouseYLastFrame;curContext.clear(curContext.DEPTH_BUFFER_BIT);curContextCache={attributes:{},locations:{}};p.noLights();p.lightFalloff(1,0,0);p.shininess(1);p.ambient(255,255,255);p.specular(0,0,0);p.emissive(0,0,0);p.camera();p.draw();pmouseXLastFrame=p.mouseX;pmouseYLastFrame=p.mouseY;p.pmouseX=pmouseXLastEvent;p.pmouseY=pmouseYLastEvent};p.noLoop=function(){doLoop=false;loopStarted=false;clearInterval(looping);curSketch.onPause()};p.loop=function(){if(loopStarted)return;timeSinceLastFPS=Date.now();framesSinceLastFPS=0;looping=window.setInterval(function(){try{curSketch.onFrameStart();p.redraw();curSketch.onFrameEnd()}catch(e_loop){window.clearInterval(looping);throw e_loop}},curMsPerFrame);doLoop=true;loopStarted=true;curSketch.onLoop()};p.frameRate=function(aRate){curFrameRate=aRate;curMsPerFrame=1e3/curFrameRate;if(doLoop){p.noLoop();p.loop()}};var eventHandlers=[];function attachEventHandler(elem,type,fn){if(elem.addEventListener)elem.addEventListener(type,fn,false);else elem.attachEvent("on"+type,fn);eventHandlers.push({elem:elem,type:type,fn:fn})}function detachEventHandler(eventHandler){var elem=eventHandler.elem,type=eventHandler.type,fn=eventHandler.fn;if(elem.removeEventListener)elem.removeEventListener(type,fn,false);else if(elem.detachEvent)elem.detachEvent("on"+type,fn)}p.exit=function(){window.clearInterval(looping);removeInstance(p.externals.canvas.id);delete curElement.onmousedown;for(var lib in Processing.lib)if(Processing.lib.hasOwnProperty(lib))if(Processing.lib[lib].hasOwnProperty("detach"))Processing.lib[lib].detach(p);var i=eventHandlers.length;while(i--)detachEventHandler(eventHandlers[i]);curSketch.onExit()};p.cursor=function(){if(arguments.length>1||arguments.length===1&&arguments[0]instanceof p.PImage){var image=arguments[0],x,y;if(arguments.length>=3){x=arguments[1];y=arguments[2];if(x<0||y<0||y>=image.height||x>=image.width)throw"x and y must be non-negative and less than the dimensions of the image"}else{x=image.width>>>1;y=image.height>>>1}var imageDataURL=image.toDataURL();var style='url("'+imageDataURL+'") '+x+" "+y+", default";curCursor=curElement.style.cursor=style}else if(arguments.length===1){var mode=arguments[0];curCursor=curElement.style.cursor=mode}else curCursor=curElement.style.cursor=oldCursor};p.noCursor=function(){curCursor=curElement.style.cursor=PConstants.NOCURSOR};p.link=function(href,target){if(target!==undef)window.open(href,target);else window.location=href};p.beginDraw=nop;p.endDraw=nop;Drawing2D.prototype.toImageData=function(x,y,w,h){x=x!==undef?x:0;y=y!==undef?y:0;w=w!==undef?w:p.width;h=h!==undef?h:p.height;return curContext.getImageData(x,y,w,h)};Drawing3D.prototype.toImageData=function(x,y,w,h){x=x!==undef?x:0;y=y!==undef?y:0;w=w!==undef?w:p.width;h=h!==undef?h:p.height;var c=document.createElement("canvas"),ctx=c.getContext("2d"),obj=ctx.createImageData(w,h),uBuff=new Uint8Array(w*h*4);curContext.readPixels(x,y,w,h,curContext.RGBA,curContext.UNSIGNED_BYTE,uBuff);for(var i=0,ul=uBuff.length,obj_data=obj.data;i<ul;i++)obj_data[i]=uBuff[(h-1-Math.floor(i/4/w))*w*4+i%(w*4)];return obj};p.status=function(text){window.status=text};p.binary=function(num,numBits){var bit;if(numBits>0)bit=numBits;else if(num instanceof Char){bit=16;num|=0}else{bit=32;while(bit>1&&!(num>>>bit-1&1))bit--}var result="";while(bit>0)result+=num>>>--bit&1?"1":"0";return result};p.unbinary=function(binaryString){var i=binaryString.length-1,mask=1,result=0;while(i>=0){var ch=binaryString[i--];if(ch!=="0"&&ch!=="1")throw"the value passed into unbinary was not an 8 bit binary number";if(ch==="1")result+=mask;mask<<=1}return result};function nfCoreScalar(value,plus,minus,leftDigits,rightDigits,group){var sign=value<0?minus:plus;var autoDetectDecimals=rightDigits===0;var rightDigitsOfDefault=rightDigits===undef||rightDigits<0?0:rightDigits;var absValue=Math.abs(value);if(autoDetectDecimals){rightDigitsOfDefault=1;absValue*=10;while(Math.abs(Math.round(absValue)-absValue)>1e-6&&rightDigitsOfDefault<7){++rightDigitsOfDefault;absValue*=10}}else if(rightDigitsOfDefault!==0)absValue*=Math.pow(10,rightDigitsOfDefault);var number,doubled=absValue*2;if(Math.floor(absValue)===absValue)number=absValue;else if(Math.floor(doubled)===doubled){var floored=Math.floor(absValue);number=floored+floored%2}else number=Math.round(absValue);var buffer="";var totalDigits=leftDigits+rightDigitsOfDefault;while(totalDigits>0||number>0){totalDigits--;buffer=""+number%10+buffer;number=Math.floor(number/10)}if(group!==undef){var i=buffer.length-3-rightDigitsOfDefault;while(i>0){buffer=buffer.substring(0,i)+group+buffer.substring(i);i-=3}}if(rightDigitsOfDefault>0)return sign+buffer.substring(0,buffer.length-rightDigitsOfDefault)+"."+buffer.substring(buffer.length-rightDigitsOfDefault,buffer.length);return sign+buffer}function nfCore(value,plus,minus,leftDigits,rightDigits,group){if(value instanceof Array){var arr=[];for(var i=0,len=value.length;i<len;i++)arr.push(nfCoreScalar(value[i],plus,minus,leftDigits,rightDigits,group));return arr}return nfCoreScalar(value,plus,minus,leftDigits,rightDigits,group)}p.nf=function(value,leftDigits,rightDigits){return nfCore(value,"","-",leftDigits,rightDigits)};p.nfs=function(value,leftDigits,rightDigits){return nfCore(value," ","-",leftDigits,rightDigits)};p.nfp=function(value,leftDigits,rightDigits){return nfCore(value,"+","-",leftDigits,rightDigits)};p.nfc=function(value,leftDigits,rightDigits){return nfCore(value,"","-",leftDigits,rightDigits,",")};var decimalToHex=function(d,padding){padding=padding===undef||padding===null?padding=8:padding;if(d<0)d=4294967295+d+1;var hex=Number(d).toString(16).toUpperCase();while(hex.length<padding)hex="0"+hex;if(hex.length>=padding)hex=hex.substring(hex.length-padding,hex.length);return hex};p.hex=function(value,len){if(arguments.length===1)if(value instanceof Char)len=4;else len=8;return decimalToHex(value,len)};function unhexScalar(hex){var value=parseInt("0x"+hex,16);if(value>2147483647)value-=4294967296;return value}p.unhex=function(hex){if(hex instanceof Array){var arr=[];for(var i=0;i<hex.length;i++)arr.push(unhexScalar(hex[i]));return arr}return unhexScalar(hex)};p.loadStrings=function(filename){if(localStorage[filename])return localStorage[filename].split("\n");var filecontent=ajax(filename);if(typeof filecontent!=="string"||filecontent==="")return[];filecontent=filecontent.replace(/(\r\n?)/g,"\n").replace(/\n$/,"");
return filecontent.split("\n")};p.saveStrings=function(filename,strings){localStorage[filename]=strings.join("\n")};p.loadBytes=function(url){var string=ajax(url);var ret=[];for(var i=0;i<string.length;i++)ret.push(string.charCodeAt(i));return ret};function removeFirstArgument(args){return Array.prototype.slice.call(args,1)}p.matchAll=function(aString,aRegExp){var results=[],latest;var regexp=new RegExp(aRegExp,"g");while((latest=regexp.exec(aString))!==null){results.push(latest);if(latest[0].length===0)++regexp.lastIndex}return results.length>0?results:null};p.__contains=function(subject,subStr){if(typeof subject!=="string")return subject.contains.apply(subject,removeFirstArgument(arguments));return subject!==null&&subStr!==null&&typeof subStr==="string"&&subject.indexOf(subStr)>-1};p.__replaceAll=function(subject,regex,replacement){if(typeof subject!=="string")return subject.replaceAll.apply(subject,removeFirstArgument(arguments));return subject.replace(new RegExp(regex,"g"),replacement)};p.__replaceFirst=function(subject,regex,replacement){if(typeof subject!=="string")return subject.replaceFirst.apply(subject,removeFirstArgument(arguments));return subject.replace(new RegExp(regex,""),replacement)};p.__replace=function(subject,what,replacement){if(typeof subject!=="string")return subject.replace.apply(subject,removeFirstArgument(arguments));if(what instanceof RegExp)return subject.replace(what,replacement);if(typeof what!=="string")what=what.toString();if(what==="")return subject;var i=subject.indexOf(what);if(i<0)return subject;var j=0,result="";do{result+=subject.substring(j,i)+replacement;j=i+what.length}while((i=subject.indexOf(what,j))>=0);return result+subject.substring(j)};p.__equals=function(subject,other){if(subject.equals instanceof Function)return subject.equals.apply(subject,removeFirstArgument(arguments));return subject.valueOf()===other.valueOf()};p.__equalsIgnoreCase=function(subject,other){if(typeof subject!=="string")return subject.equalsIgnoreCase.apply(subject,removeFirstArgument(arguments));return subject.toLowerCase()===other.toLowerCase()};p.__toCharArray=function(subject){if(typeof subject!=="string")return subject.toCharArray.apply(subject,removeFirstArgument(arguments));var chars=[];for(var i=0,len=subject.length;i<len;++i)chars[i]=new Char(subject.charAt(i));return chars};p.__split=function(subject,regex,limit){if(typeof subject!=="string")return subject.split.apply(subject,removeFirstArgument(arguments));var pattern=new RegExp(regex);if(limit===undef||limit<1)return subject.split(pattern);var result=[],currSubject=subject,pos;while((pos=currSubject.search(pattern))!==-1&&result.length<limit-1){var match=pattern.exec(currSubject).toString();result.push(currSubject.substring(0,pos));currSubject=currSubject.substring(pos+match.length)}if(pos!==-1||currSubject!=="")result.push(currSubject);return result};p.__codePointAt=function(subject,idx){var code=subject.charCodeAt(idx),hi,low;if(55296<=code&&code<=56319){hi=code;low=subject.charCodeAt(idx+1);return(hi-55296)*1024+(low-56320)+65536}return code};p.match=function(str,regexp){return str.match(regexp)};p.__matches=function(str,regexp){return new RegExp(regexp).test(str)};p.__startsWith=function(subject,prefix,toffset){if(typeof subject!=="string")return subject.startsWith.apply(subject,removeFirstArgument(arguments));toffset=toffset||0;if(toffset<0||toffset>subject.length)return false;return prefix===""||prefix===subject?true:subject.indexOf(prefix)===toffset};p.__endsWith=function(subject,suffix){if(typeof subject!=="string")return subject.endsWith.apply(subject,removeFirstArgument(arguments));var suffixLen=suffix?suffix.length:0;return suffix===""||suffix===subject?true:subject.indexOf(suffix)===subject.length-suffixLen};p.__hashCode=function(subject){if(subject.hashCode instanceof Function)return subject.hashCode.apply(subject,removeFirstArgument(arguments));return virtHashCode(subject)};p.__printStackTrace=function(subject){p.println("Exception: "+subject.toString())};var logBuffer=[];p.println=function(message){var bufferLen=logBuffer.length;if(bufferLen){Processing.logger.log(logBuffer.join(""));logBuffer.length=0}if(arguments.length===0&&bufferLen===0)Processing.logger.log("");else if(arguments.length!==0)Processing.logger.log(message)};p.print=function(message){logBuffer.push(message)};p.str=function(val){if(val instanceof Array){var arr=[];for(var i=0;i<val.length;i++)arr.push(val[i].toString()+"");return arr}return val.toString()+""};p.trim=function(str){if(str instanceof Array){var arr=[];for(var i=0;i<str.length;i++)arr.push(str[i].replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,""));return arr}return str.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,"")};function booleanScalar(val){if(typeof val==="number")return val!==0;if(typeof val==="boolean")return val;if(typeof val==="string")return val.toLowerCase()==="true";if(val instanceof Char)return val.code===49||val.code===84||val.code===116}p.parseBoolean=function(val){if(val instanceof Array){var ret=[];for(var i=0;i<val.length;i++)ret.push(booleanScalar(val[i]));return ret}return booleanScalar(val)};p.parseByte=function(what){if(what instanceof Array){var bytes=[];for(var i=0;i<what.length;i++)bytes.push(0-(what[i]&128)|what[i]&127);return bytes}return 0-(what&128)|what&127};p.parseChar=function(key){if(typeof key==="number")return new Char(String.fromCharCode(key&65535));if(key instanceof Array){var ret=[];for(var i=0;i<key.length;i++)ret.push(new Char(String.fromCharCode(key[i]&65535)));return ret}throw"char() may receive only one argument of type int, byte, int[], or byte[]."};function floatScalar(val){if(typeof val==="number")return val;if(typeof val==="boolean")return val?1:0;if(typeof val==="string")return parseFloat(val);if(val instanceof Char)return val.code}p.parseFloat=function(val){if(val instanceof Array){var ret=[];for(var i=0;i<val.length;i++)ret.push(floatScalar(val[i]));return ret}return floatScalar(val)};function intScalar(val,radix){if(typeof val==="number")return val&4294967295;if(typeof val==="boolean")return val?1:0;if(typeof val==="string"){var number=parseInt(val,radix||10);return number&4294967295}if(val instanceof Char)return val.code}p.parseInt=function(val,radix){if(val instanceof Array){var ret=[];for(var i=0;i<val.length;i++)if(typeof val[i]==="string"&&!/^\s*[+\-]?\d+\s*$/.test(val[i]))ret.push(0);else ret.push(intScalar(val[i],radix));return ret}return intScalar(val,radix)};p.__int_cast=function(val){return 0|val};p.__instanceof=function(obj,type){if(typeof type!=="function")throw"Function is expected as type argument for instanceof operator";if(typeof obj==="string")return type===Object||type===String;if(obj instanceof type)return true;if(typeof obj!=="object"||obj===null)return false;var objType=obj.constructor;if(type.$isInterface){var interfaces=[];while(objType){if(objType.$interfaces)interfaces=interfaces.concat(objType.$interfaces);objType=objType.$base}while(interfaces.length>0){var i=interfaces.shift();if(i===type)return true;if(i.$interfaces)interfaces=interfaces.concat(i.$interfaces)}return false}while(objType.hasOwnProperty("$base")){objType=objType.$base;if(objType===type)return true}return false};p.abs=Math.abs;p.ceil=Math.ceil;p.constrain=function(aNumber,aMin,aMax){return aNumber>aMax?aMax:aNumber<aMin?aMin:aNumber};p.dist=function(){var dx,dy,dz;if(arguments.length===4){dx=arguments[0]-arguments[2];dy=arguments[1]-arguments[3];return Math.sqrt(dx*dx+dy*dy)}if(arguments.length===6){dx=arguments[0]-arguments[3];dy=arguments[1]-arguments[4];dz=arguments[2]-arguments[5];return Math.sqrt(dx*dx+dy*dy+dz*dz)}};p.exp=Math.exp;p.floor=Math.floor;p.lerp=function(value1,value2,amt){return(value2-value1)*amt+value1};p.log=Math.log;p.mag=function(a,b,c){if(c)return Math.sqrt(a*a+b*b+c*c);return Math.sqrt(a*a+b*b)};p.map=function(value,istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((value-istart)/(istop-istart))};p.max=function(){if(arguments.length===2)return arguments[0]<arguments[1]?arguments[1]:arguments[0];var numbers=arguments.length===1?arguments[0]:arguments;if(!("length"in numbers&&numbers.length>0))throw"Non-empty array is expected";var max=numbers[0],count=numbers.length;for(var i=1;i<count;++i)if(max<numbers[i])max=numbers[i];return max};p.min=function(){if(arguments.length===2)return arguments[0]<arguments[1]?arguments[0]:arguments[1];var numbers=arguments.length===1?arguments[0]:arguments;if(!("length"in numbers&&numbers.length>0))throw"Non-empty array is expected";var min=numbers[0],count=numbers.length;for(var i=1;i<count;++i)if(min>numbers[i])min=numbers[i];return min};p.norm=function(aNumber,low,high){return(aNumber-low)/(high-low)};p.pow=Math.pow;p.round=Math.round;p.sq=function(aNumber){return aNumber*aNumber};p.sqrt=Math.sqrt;p.acos=Math.acos;p.asin=Math.asin;p.atan=Math.atan;p.atan2=Math.atan2;p.cos=Math.cos;p.degrees=function(aAngle){return aAngle*180/Math.PI};p.radians=function(aAngle){return aAngle/180*Math.PI};p.sin=Math.sin;p.tan=Math.tan;var currentRandom=Math.random;p.random=function(){if(arguments.length===0)return currentRandom();if(arguments.length===1)return currentRandom()*arguments[0];var aMin=arguments[0],aMax=arguments[1];return currentRandom()*(aMax-aMin)+aMin};function Marsaglia(i1,i2){var z=i1||362436069,w=i2||521288629;var nextInt=function(){z=36969*(z&65535)+(z>>>16)&4294967295;w=18e3*(w&65535)+(w>>>16)&4294967295;return((z&65535)<<16|w&65535)&4294967295};this.nextDouble=function(){var i=nextInt()/4294967296;return i<0?1+i:i};this.nextInt=nextInt}Marsaglia.createRandomized=function(){var now=new Date;return new Marsaglia(now/6e4&4294967295,now&4294967295)};p.randomSeed=function(seed){currentRandom=new Marsaglia(seed).nextDouble};p.Random=function(seed){var haveNextNextGaussian=false,nextNextGaussian,random;this.nextGaussian=function(){if(haveNextNextGaussian){haveNextNextGaussian=false;return nextNextGaussian}var v1,v2,s;do{v1=2*random()-1;v2=2*random()-1;s=v1*v1+v2*v2}while(s>=1||s===0);var multiplier=Math.sqrt(-2*Math.log(s)/s);nextNextGaussian=v2*multiplier;haveNextNextGaussian=true;return v1*multiplier};random=seed===undef?Math.random:new Marsaglia(seed).nextDouble};function PerlinNoise(seed){var rnd=seed!==undef?new Marsaglia(seed):Marsaglia.createRandomized();var i,j;var perm=new Uint8Array(512);for(i=0;i<256;++i)perm[i]=i;for(i=0;i<256;++i){var t=perm[j=rnd.nextInt()&255];perm[j]=perm[i];perm[i]=t}for(i=0;i<256;++i)perm[i+256]=perm[i];function grad3d(i,x,y,z){var h=i&15;var u=h<8?x:y,v=h<4?y:h===12||h===14?x:z;return((h&1)===0?u:-u)+((h&2)===0?v:-v)}function grad2d(i,x,y){var v=(i&1)===0?x:y;return(i&2)===0?-v:v}function grad1d(i,x){return(i&1)===0?-x:x}function lerp(t,a,b){return a+t*(b-a)}this.noise3d=function(x,y,z){var X=Math.floor(x)&255,Y=Math.floor(y)&255,Z=Math.floor(z)&255;x-=Math.floor(x);y-=Math.floor(y);z-=Math.floor(z);var fx=(3-2*x)*x*x,fy=(3-2*y)*y*y,fz=(3-2*z)*z*z;var p0=perm[X]+Y,p00=perm[p0]+Z,p01=perm[p0+1]+Z,p1=perm[X+1]+Y,p10=perm[p1]+Z,p11=perm[p1+1]+Z;return lerp(fz,lerp(fy,lerp(fx,grad3d(perm[p00],x,y,z),grad3d(perm[p10],x-1,y,z)),lerp(fx,grad3d(perm[p01],x,y-1,z),grad3d(perm[p11],x-1,y-1,z))),lerp(fy,lerp(fx,grad3d(perm[p00+1],x,y,z-1),grad3d(perm[p10+1],x-1,y,z-1)),lerp(fx,grad3d(perm[p01+1],x,y-1,z-1),grad3d(perm[p11+1],x-1,y-1,z-1))))};this.noise2d=function(x,y){var X=Math.floor(x)&255,Y=Math.floor(y)&255;x-=Math.floor(x);y-=Math.floor(y);var fx=(3-2*x)*x*x,fy=(3-2*y)*y*y;var p0=perm[X]+Y,p1=perm[X+1]+Y;return lerp(fy,lerp(fx,grad2d(perm[p0],x,y),grad2d(perm[p1],x-1,y)),lerp(fx,grad2d(perm[p0+1],x,y-1),grad2d(perm[p1+1],x-1,y-1)))};this.noise1d=function(x){var X=Math.floor(x)&255;x-=Math.floor(x);var fx=(3-2*x)*x*x;return lerp(fx,grad1d(perm[X],x),grad1d(perm[X+1],x-1))}}var noiseProfile={generator:undef,octaves:4,fallout:.5,seed:undef};p.noise=function(x,y,z){if(noiseProfile.generator===undef)noiseProfile.generator=new PerlinNoise(noiseProfile.seed);var generator=noiseProfile.generator;var effect=1,k=1,sum=0;for(var i=0;i<noiseProfile.octaves;++i){effect*=noiseProfile.fallout;switch(arguments.length){case 1:sum+=effect*(1+generator.noise1d(k*x))/2;break;case 2:sum+=effect*(1+generator.noise2d(k*x,k*y))/2;break;case 3:sum+=effect*(1+generator.noise3d(k*x,k*y,k*z))/2;break}k*=2}return sum};p.noiseDetail=function(octaves,fallout){noiseProfile.octaves=octaves;if(fallout!==undef)noiseProfile.fallout=fallout};p.noiseSeed=function(seed){noiseProfile.seed=seed;noiseProfile.generator=undef};DrawingShared.prototype.size=function(aWidth,aHeight,aMode){if(doStroke)p.stroke(0);if(doFill)p.fill(255);var savedProperties={fillStyle:curContext.fillStyle,strokeStyle:curContext.strokeStyle,lineCap:curContext.lineCap,lineJoin:curContext.lineJoin};if(curElement.style.length>0){curElement.style.removeProperty("width");curElement.style.removeProperty("height")}curElement.width=p.width=aWidth||100;curElement.height=p.height=aHeight||100;for(var prop in savedProperties)if(savedProperties.hasOwnProperty(prop))curContext[prop]=savedProperties[prop];p.textFont(curTextFont);p.background();maxPixelsCached=Math.max(1e3,aWidth*aHeight*.05);p.externals.context=curContext;for(var i=0;i<720;i++){sinLUT[i]=p.sin(i*(Math.PI/180)*.5);cosLUT[i]=p.cos(i*(Math.PI/180)*.5)}};Drawing2D.prototype.size=function(aWidth,aHeight,aMode){if(curContext===undef){curContext=curElement.getContext("2d");userMatrixStack=new PMatrixStack;userReverseMatrixStack=new PMatrixStack;modelView=new PMatrix2D;modelViewInv=new PMatrix2D}DrawingShared.prototype.size.apply(this,arguments)};Drawing3D.prototype.size=function(){var size3DCalled=false;return function size(aWidth,aHeight,aMode){if(size3DCalled)throw"Multiple calls to size() for 3D renders are not allowed.";size3DCalled=true;function getGLContext(canvas){var ctxNames=["experimental-webgl","webgl","webkit-3d"],gl;for(var i=0,l=ctxNames.length;i<l;i++){gl=canvas.getContext(ctxNames[i],{antialias:false,preserveDrawingBuffer:true});if(gl)break}return gl}try{curElement.width=p.width=aWidth||100;curElement.height=p.height=aHeight||100;curContext=getGLContext(curElement);canTex=curContext.createTexture();textTex=curContext.createTexture()}catch(e_size){Processing.debug(e_size)}if(!curContext)throw"WebGL context is not supported on this browser.";curContext.viewport(0,0,curElement.width,curElement.height);curContext.enable(curContext.DEPTH_TEST);curContext.enable(curContext.BLEND);curContext.blendFunc(curContext.SRC_ALPHA,curContext.ONE_MINUS_SRC_ALPHA);programObject2D=createProgramObject(curContext,vertexShaderSrc2D,fragmentShaderSrc2D);programObjectUnlitShape=createProgramObject(curContext,vertexShaderSrcUnlitShape,fragmentShaderSrcUnlitShape);p.strokeWeight(1);programObject3D=createProgramObject(curContext,vertexShaderSrc3D,fragmentShaderSrc3D);curContext.useProgram(programObject3D);uniformi("usingTexture3d",programObject3D,"usingTexture",usingTexture);p.lightFalloff(1,0,0);p.shininess(1);p.ambient(255,255,255);p.specular(0,0,0);p.emissive(0,0,0);boxBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,boxBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,boxVerts,curContext.STATIC_DRAW);boxNormBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,boxNormBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,boxNorms,curContext.STATIC_DRAW);boxOutlineBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,boxOutlineBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,boxOutlineVerts,curContext.STATIC_DRAW);rectBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,rectBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,rectVerts,curContext.STATIC_DRAW);rectNormBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,rectNormBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,rectNorms,curContext.STATIC_DRAW);sphereBuffer=curContext.createBuffer();lineBuffer=curContext.createBuffer();fillBuffer=curContext.createBuffer();fillColorBuffer=curContext.createBuffer();strokeColorBuffer=curContext.createBuffer();shapeTexVBO=curContext.createBuffer();pointBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,pointBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([0,0,0]),curContext.STATIC_DRAW);textBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,textBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),curContext.STATIC_DRAW);textureBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ARRAY_BUFFER,textureBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),curContext.STATIC_DRAW);indexBuffer=curContext.createBuffer();curContext.bindBuffer(curContext.ELEMENT_ARRAY_BUFFER,indexBuffer);curContext.bufferData(curContext.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,2,3,0]),curContext.STATIC_DRAW);cam=new PMatrix3D;cameraInv=new PMatrix3D;modelView=new PMatrix3D;modelViewInv=new PMatrix3D;projection=new PMatrix3D;p.camera();p.perspective();userMatrixStack=new PMatrixStack;userReverseMatrixStack=new PMatrixStack;curveBasisMatrix=new PMatrix3D;curveToBezierMatrix=new PMatrix3D;curveDrawMatrix=new PMatrix3D;bezierDrawMatrix=new PMatrix3D;bezierBasisInverse=new PMatrix3D;bezierBasisMatrix=new PMatrix3D;bezierBasisMatrix.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);DrawingShared.prototype.size.apply(this,arguments)}}();Drawing2D.prototype.ambientLight=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.ambientLight=function(r,g,b,x,y,z){if(lightCount===8)throw"can only create "+8+" lights";var pos=new PVector(x,y,z);var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.mult(pos,pos);var col=color$4(r,g,b,0);var normalizedCol=[(col>>16&255)/255,(col>>8&255)/255,(col&255)/255];curContext.useProgram(programObject3D);uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol);uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array());uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",0);uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)};Drawing2D.prototype.directionalLight=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.directionalLight=function(r,g,b,nx,ny,nz){if(lightCount===8)throw"can only create "+8+" lights";curContext.useProgram(programObject3D);var mvm=new PMatrix3D;mvm.scale(1,-1,1);mvm.apply(modelView.array());mvm=mvm.array();var dir=[mvm[0]*nx+mvm[4]*ny+mvm[8]*nz,mvm[1]*nx+mvm[5]*ny+mvm[9]*nz,mvm[2]*nx+mvm[6]*ny+mvm[10]*nz];var col=color$4(r,g,b,0);var normalizedCol=[(col>>16&255)/255,(col>>8&255)/255,(col&255)/255];uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol);uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",dir);uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",1);uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)};Drawing2D.prototype.lightFalloff=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.lightFalloff=function(constant,linear,quadratic){curContext.useProgram(programObject3D);uniformf("uFalloff3d",programObject3D,"uFalloff",[constant,linear,quadratic])};Drawing2D.prototype.lightSpecular=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.lightSpecular=function(r,g,b){var col=color$4(r,g,b,0);var normalizedCol=[(col>>16&255)/255,(col>>8&255)/255,(col&255)/255];curContext.useProgram(programObject3D);uniformf("uSpecular3d",programObject3D,"uSpecular",normalizedCol)};p.lights=function(){p.ambientLight(128,128,128);p.directionalLight(128,128,128,0,0,-1);p.lightFalloff(1,0,0);p.lightSpecular(0,0,0)};Drawing2D.prototype.pointLight=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.pointLight=function(r,g,b,x,y,z){if(lightCount===8)throw"can only create "+8+" lights";var pos=new PVector(x,y,z);var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.mult(pos,pos);var col=color$4(r,g,b,0);var normalizedCol=[(col>>16&255)/255,(col>>8&255)/255,(col&255)/255];curContext.useProgram(programObject3D);uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol);uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array());uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",2);uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)};Drawing2D.prototype.noLights=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.noLights=function(){lightCount=0;curContext.useProgram(programObject3D);uniformi("uLightCount3d",programObject3D,"uLightCount",lightCount)};Drawing2D.prototype.spotLight=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.spotLight=function(r,g,b,x,y,z,nx,ny,nz,angle,concentration){if(lightCount===8)throw"can only create "+8+" lights";curContext.useProgram(programObject3D);var pos=new PVector(x,y,z);var mvm=new PMatrix3D;mvm.scale(1,-1,1);mvm.apply(modelView.array());mvm.mult(pos,pos);mvm=mvm.array();var dir=[mvm[0]*nx+mvm[4]*ny+mvm[8]*nz,mvm[1]*nx+mvm[5]*ny+mvm[9]*nz,mvm[2]*nx+mvm[6]*ny+mvm[10]*nz];var col=color$4(r,g,b,0);var normalizedCol=[(col>>16&255)/255,(col>>8&255)/255,(col&255)/255];uniformf("uLights.color.3d."+lightCount,programObject3D,"uLights"+lightCount+".color",normalizedCol);uniformf("uLights.position.3d."+lightCount,programObject3D,"uLights"+lightCount+".position",pos.array());uniformf("uLights.direction.3d."+lightCount,programObject3D,"uLights"+lightCount+".direction",dir);uniformf("uLights.concentration.3d."+lightCount,programObject3D,"uLights"+lightCount+".concentration",concentration);uniformf("uLights.angle.3d."+lightCount,programObject3D,"uLights"+lightCount+".angle",angle);uniformi("uLights.type.3d."+lightCount,programObject3D,"uLights"+lightCount+".type",3);uniformi("uLightCount3d",programObject3D,"uLightCount",++lightCount)};Drawing2D.prototype.beginCamera=function(){throw"beginCamera() is not available in 2D mode"};Drawing3D.prototype.beginCamera=function(){if(manipulatingCamera)throw"You cannot call beginCamera() again before calling endCamera()";manipulatingCamera=true;modelView=cameraInv;modelViewInv=cam};Drawing2D.prototype.endCamera=function(){throw"endCamera() is not available in 2D mode"};Drawing3D.prototype.endCamera=function(){if(!manipulatingCamera)throw"You cannot call endCamera() before calling beginCamera()";modelView.set(cam);modelViewInv.set(cameraInv);manipulatingCamera=false};p.camera=function(eyeX,eyeY,eyeZ,centerX,centerY,centerZ,upX,upY,upZ){if(eyeX===undef){cameraX=p.width/2;cameraY=p.height/2;cameraZ=cameraY/Math.tan(cameraFOV/2);eyeX=cameraX;eyeY=cameraY;eyeZ=cameraZ;centerX=cameraX;centerY=cameraY;centerZ=0;upX=0;upY=1;upZ=0}var z=new PVector(eyeX-centerX,eyeY-centerY,eyeZ-centerZ);var y=new PVector(upX,upY,upZ);z.normalize();var x=PVector.cross(y,z);y=PVector.cross(z,x);x.normalize();y.normalize();var xX=x.x,xY=x.y,xZ=x.z;var yX=y.x,yY=y.y,yZ=y.z;var zX=z.x,zY=z.y,zZ=z.z;cam.set(xX,xY,xZ,0,yX,yY,yZ,0,zX,zY,zZ,0,0,0,0,1);cam.translate(-eyeX,-eyeY,-eyeZ);cameraInv.reset();cameraInv.invApply(xX,xY,xZ,0,yX,yY,yZ,0,zX,zY,zZ,0,0,0,0,1);cameraInv.translate(eyeX,eyeY,eyeZ);modelView.set(cam);modelViewInv.set(cameraInv)};p.perspective=function(fov,aspect,near,far){if(arguments.length===0){cameraY=curElement.height/2;cameraZ=cameraY/Math.tan(cameraFOV/2);cameraNear=cameraZ/10;cameraFar=cameraZ*10;cameraAspect=p.width/p.height;fov=cameraFOV;aspect=cameraAspect;near=cameraNear;far=cameraFar}var yMax,yMin,xMax,xMin;yMax=near*Math.tan(fov/2);yMin=-yMax;xMax=yMax*aspect;xMin=yMin*aspect;p.frustum(xMin,xMax,yMin,yMax,near,far)};Drawing2D.prototype.frustum=function(){throw"Processing.js: frustum() is not supported in 2D mode"};Drawing3D.prototype.frustum=function(left,right,bottom,top,near,far){frustumMode=true;projection=new PMatrix3D;projection.set(2*near/(right-left),0,(right+left)/(right-left),0,0,2*near/(top-bottom),(top+bottom)/(top-bottom),0,0,0,-(far+near)/(far-near),-(2*far*near)/(far-near),0,0,-1,0);var proj=new PMatrix3D;proj.set(projection);proj.transpose();curContext.useProgram(programObject2D);uniformMatrix("projection2d",programObject2D,"uProjection",false,proj.array());curContext.useProgram(programObject3D);uniformMatrix("projection3d",programObject3D,"uProjection",false,proj.array());curContext.useProgram(programObjectUnlitShape);uniformMatrix("uProjectionUS",programObjectUnlitShape,"uProjection",false,proj.array())};p.ortho=function(left,right,bottom,top,near,far){if(arguments.length===0){left=0;right=p.width;bottom=0;top=p.height;near=-10;far=10}var x=2/(right-left);var y=2/(top-bottom);var z=-2/(far-near);var tx=-(right+left)/(right-left);var ty=-(top+bottom)/(top-bottom);var tz=-(far+near)/(far-near);projection=new PMatrix3D;projection.set(x,0,0,tx,0,y,0,ty,0,0,z,tz,0,0,0,1);var proj=new PMatrix3D;proj.set(projection);proj.transpose();curContext.useProgram(programObject2D);uniformMatrix("projection2d",programObject2D,"uProjection",false,proj.array());curContext.useProgram(programObject3D);uniformMatrix("projection3d",programObject3D,"uProjection",false,proj.array());curContext.useProgram(programObjectUnlitShape);uniformMatrix("uProjectionUS",programObjectUnlitShape,"uProjection",false,proj.array());frustumMode=false};p.printProjection=function(){projection.print()};p.printCamera=function(){cam.print()};Drawing2D.prototype.box=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.box=function(w,h,d){if(!h||!d)h=d=w;var model=new PMatrix3D;model.scale(w,h,d);var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();if(doFill){curContext.useProgram(programObject3D);uniformMatrix("model3d",programObject3D,"uModel",false,model.array());uniformMatrix("view3d",programObject3D,"uView",false,view.array());curContext.enable(curContext.POLYGON_OFFSET_FILL);curContext.polygonOffset(1,1);uniformf("color3d",programObject3D,"uColor",fillStyle);if(lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model);v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v);normalMatrix.invert();normalMatrix.transpose();uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",false,normalMatrix.array());vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,boxNormBuffer)}else disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal");vertexAttribPointer("aVertex3d",programObject3D,"aVertex",3,boxBuffer);disableVertexAttribPointer("aColor3d",programObject3D,"aColor");disableVertexAttribPointer("aTexture3d",programObject3D,"aTexture");curContext.drawArrays(curContext.TRIANGLES,0,boxVerts.length/3);curContext.disable(curContext.POLYGON_OFFSET_FILL)}if(lineWidth>0&&doStroke){curContext.useProgram(programObject2D);uniformMatrix("uModel2d",programObject2D,"uModel",false,model.array());uniformMatrix("uView2d",programObject2D,"uView",false,view.array());uniformf("uColor2d",programObject2D,"uColor",strokeStyle);uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",false);vertexAttribPointer("vertex2d",programObject2D,"aVertex",3,boxOutlineBuffer);disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord");curContext.drawArrays(curContext.LINES,0,boxOutlineVerts.length/3)}};var initSphere=function(){var i;sphereVerts=[];for(i=0;i<sphereDetailU;i++){sphereVerts.push(0);sphereVerts.push(-1);sphereVerts.push(0);sphereVerts.push(sphereX[i]);sphereVerts.push(sphereY[i]);sphereVerts.push(sphereZ[i])}sphereVerts.push(0);sphereVerts.push(-1);sphereVerts.push(0);sphereVerts.push(sphereX[0]);sphereVerts.push(sphereY[0]);sphereVerts.push(sphereZ[0]);var v1,v11,v2;var voff=0;for(i=2;i<sphereDetailV;i++){v1=v11=voff;voff+=sphereDetailU;v2=voff;for(var j=0;j<sphereDetailU;j++){sphereVerts.push(sphereX[v1]);sphereVerts.push(sphereY[v1]);sphereVerts.push(sphereZ[v1++]);sphereVerts.push(sphereX[v2]);sphereVerts.push(sphereY[v2]);sphereVerts.push(sphereZ[v2++])}v1=v11;v2=voff;sphereVerts.push(sphereX[v1]);sphereVerts.push(sphereY[v1]);sphereVerts.push(sphereZ[v1]);sphereVerts.push(sphereX[v2]);sphereVerts.push(sphereY[v2]);sphereVerts.push(sphereZ[v2])}for(i=0;i<sphereDetailU;i++){v2=voff+i;sphereVerts.push(sphereX[v2]);sphereVerts.push(sphereY[v2]);sphereVerts.push(sphereZ[v2]);sphereVerts.push(0);sphereVerts.push(1);sphereVerts.push(0)}sphereVerts.push(sphereX[voff]);sphereVerts.push(sphereY[voff]);sphereVerts.push(sphereZ[voff]);sphereVerts.push(0);sphereVerts.push(1);sphereVerts.push(0);curContext.bindBuffer(curContext.ARRAY_BUFFER,sphereBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(sphereVerts),curContext.STATIC_DRAW)};p.sphereDetail=function(ures,vres){var i;if(arguments.length===1)ures=vres=arguments[0];if(ures<3)ures=3;if(vres<2)vres=2;if(ures===sphereDetailU&&vres===sphereDetailV)return;var delta=720/ures;var cx=new Float32Array(ures);var cz=new Float32Array(ures);for(i=0;i<ures;i++){cx[i]=cosLUT[i*delta%720|0];cz[i]=sinLUT[i*delta%720|0]}var vertCount=ures*(vres-1)+2;var currVert=0;sphereX=new Float32Array(vertCount);sphereY=new Float32Array(vertCount);sphereZ=new Float32Array(vertCount);var angle_step=720*.5/vres;var angle=angle_step;for(i=1;i<vres;i++){var curradius=sinLUT[angle%720|0];var currY=-cosLUT[angle%720|0];for(var j=0;j<ures;j++){sphereX[currVert]=cx[j]*curradius;sphereY[currVert]=currY;sphereZ[currVert++]=cz[j]*curradius}angle+=angle_step}sphereDetailU=ures;sphereDetailV=vres;initSphere()};Drawing2D.prototype.sphere=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.sphere=function(){var sRad=arguments[0];if(sphereDetailU<3||sphereDetailV<2)p.sphereDetail(30);var model=new PMatrix3D;model.scale(sRad,sRad,sRad);var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();if(doFill){if(lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model);v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v);normalMatrix.invert();normalMatrix.transpose();uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",false,normalMatrix.array());vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,sphereBuffer)}else disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal");curContext.useProgram(programObject3D);disableVertexAttribPointer("aTexture3d",programObject3D,"aTexture");uniformMatrix("uModel3d",programObject3D,"uModel",false,model.array());uniformMatrix("uView3d",programObject3D,"uView",false,view.array());vertexAttribPointer("aVertex3d",programObject3D,"aVertex",3,sphereBuffer);disableVertexAttribPointer("aColor3d",programObject3D,"aColor");curContext.enable(curContext.POLYGON_OFFSET_FILL);curContext.polygonOffset(1,1);uniformf("uColor3d",programObject3D,"uColor",fillStyle);curContext.drawArrays(curContext.TRIANGLE_STRIP,0,sphereVerts.length/3);curContext.disable(curContext.POLYGON_OFFSET_FILL)}if(lineWidth>0&&doStroke){curContext.useProgram(programObject2D);uniformMatrix("uModel2d",programObject2D,"uModel",false,model.array());uniformMatrix("uView2d",programObject2D,"uView",false,view.array());vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,sphereBuffer);disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord");uniformf("uColor2d",programObject2D,"uColor",strokeStyle);uniformi("uIsDrawingText",programObject2D,"uIsDrawingText",false);curContext.drawArrays(curContext.LINE_STRIP,0,sphereVerts.length/3)}};p.modelX=function(x,y,z){var mv=modelView.array();var ci=cameraInv.array();var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var ox=ci[0]*ax+ci[1]*ay+ci[2]*az+ci[3]*aw;var ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return ow!==0?ox/ow:ox};p.modelY=function(x,y,z){var mv=modelView.array();
var ci=cameraInv.array();var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var oy=ci[4]*ax+ci[5]*ay+ci[6]*az+ci[7]*aw;var ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return ow!==0?oy/ow:oy};p.modelZ=function(x,y,z){var mv=modelView.array();var ci=cameraInv.array();var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var oz=ci[8]*ax+ci[9]*ay+ci[10]*az+ci[11]*aw;var ow=ci[12]*ax+ci[13]*ay+ci[14]*az+ci[15]*aw;return ow!==0?oz/ow:oz};Drawing2D.prototype.ambient=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.ambient=function(v1,v2,v3){curContext.useProgram(programObject3D);uniformi("uUsingMat3d",programObject3D,"uUsingMat",true);var col=p.color(v1,v2,v3);uniformf("uMaterialAmbient3d",programObject3D,"uMaterialAmbient",p.color.toGLArray(col).slice(0,3))};Drawing2D.prototype.emissive=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.emissive=function(v1,v2,v3){curContext.useProgram(programObject3D);uniformi("uUsingMat3d",programObject3D,"uUsingMat",true);var col=p.color(v1,v2,v3);uniformf("uMaterialEmissive3d",programObject3D,"uMaterialEmissive",p.color.toGLArray(col).slice(0,3))};Drawing2D.prototype.shininess=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.shininess=function(shine){curContext.useProgram(programObject3D);uniformi("uUsingMat3d",programObject3D,"uUsingMat",true);uniformf("uShininess3d",programObject3D,"uShininess",shine)};Drawing2D.prototype.specular=DrawingShared.prototype.a3DOnlyFunction;Drawing3D.prototype.specular=function(v1,v2,v3){curContext.useProgram(programObject3D);uniformi("uUsingMat3d",programObject3D,"uUsingMat",true);var col=p.color(v1,v2,v3);uniformf("uMaterialSpecular3d",programObject3D,"uMaterialSpecular",p.color.toGLArray(col).slice(0,3))};p.screenX=function(x,y,z){var mv=modelView.array();if(mv.length===16){var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var pj=projection.array();var ox=pj[0]*ax+pj[1]*ay+pj[2]*az+pj[3]*aw;var ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;if(ow!==0)ox/=ow;return p.width*(1+ox)/2}return modelView.multX(x,y)};p.screenY=function screenY(x,y,z){var mv=modelView.array();if(mv.length===16){var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var pj=projection.array();var oy=pj[4]*ax+pj[5]*ay+pj[6]*az+pj[7]*aw;var ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;if(ow!==0)oy/=ow;return p.height*(1+oy)/2}return modelView.multY(x,y)};p.screenZ=function screenZ(x,y,z){var mv=modelView.array();if(mv.length!==16)return 0;var pj=projection.array();var ax=mv[0]*x+mv[1]*y+mv[2]*z+mv[3];var ay=mv[4]*x+mv[5]*y+mv[6]*z+mv[7];var az=mv[8]*x+mv[9]*y+mv[10]*z+mv[11];var aw=mv[12]*x+mv[13]*y+mv[14]*z+mv[15];var oz=pj[8]*ax+pj[9]*ay+pj[10]*az+pj[11]*aw;var ow=pj[12]*ax+pj[13]*ay+pj[14]*az+pj[15]*aw;if(ow!==0)oz/=ow;return(oz+1)/2};DrawingShared.prototype.fill=function(){var color=p.color(arguments[0],arguments[1],arguments[2],arguments[3]);if(color===currentFillColor&&doFill)return;doFill=true;currentFillColor=color};Drawing2D.prototype.fill=function(){DrawingShared.prototype.fill.apply(this,arguments);isFillDirty=true};Drawing3D.prototype.fill=function(){DrawingShared.prototype.fill.apply(this,arguments);fillStyle=p.color.toGLArray(currentFillColor)};function executeContextFill(){if(doFill){if(isFillDirty){curContext.fillStyle=p.color.toString(currentFillColor);isFillDirty=false}curContext.fill()}}p.noFill=function(){doFill=false};DrawingShared.prototype.stroke=function(){var color=p.color(arguments[0],arguments[1],arguments[2],arguments[3]);if(color===currentStrokeColor&&doStroke)return;doStroke=true;currentStrokeColor=color};Drawing2D.prototype.stroke=function(){DrawingShared.prototype.stroke.apply(this,arguments);isStrokeDirty=true};Drawing3D.prototype.stroke=function(){DrawingShared.prototype.stroke.apply(this,arguments);strokeStyle=p.color.toGLArray(currentStrokeColor)};function executeContextStroke(){if(doStroke){if(isStrokeDirty){curContext.strokeStyle=p.color.toString(currentStrokeColor);isStrokeDirty=false}curContext.stroke()}}p.noStroke=function(){doStroke=false};DrawingShared.prototype.strokeWeight=function(w){lineWidth=w};Drawing2D.prototype.strokeWeight=function(w){DrawingShared.prototype.strokeWeight.apply(this,arguments);curContext.lineWidth=w};Drawing3D.prototype.strokeWeight=function(w){DrawingShared.prototype.strokeWeight.apply(this,arguments);curContext.useProgram(programObject2D);uniformf("pointSize2d",programObject2D,"uPointSize",w);curContext.useProgram(programObjectUnlitShape);uniformf("pointSizeUnlitShape",programObjectUnlitShape,"uPointSize",w);curContext.lineWidth(w)};p.strokeCap=function(value){drawing.$ensureContext().lineCap=value};p.strokeJoin=function(value){drawing.$ensureContext().lineJoin=value};Drawing2D.prototype.smooth=function(){renderSmooth=true;var style=curElement.style;style.setProperty("image-rendering","optimizeQuality","important");style.setProperty("-ms-interpolation-mode","bicubic","important");if(curContext.hasOwnProperty("mozImageSmoothingEnabled"))curContext.mozImageSmoothingEnabled=true};Drawing3D.prototype.smooth=function(){renderSmooth=true};Drawing2D.prototype.noSmooth=function(){renderSmooth=false;var style=curElement.style;style.setProperty("image-rendering","optimizeSpeed","important");style.setProperty("image-rendering","-moz-crisp-edges","important");style.setProperty("image-rendering","-webkit-optimize-contrast","important");style.setProperty("image-rendering","optimize-contrast","important");style.setProperty("-ms-interpolation-mode","nearest-neighbor","important");if(curContext.hasOwnProperty("mozImageSmoothingEnabled"))curContext.mozImageSmoothingEnabled=false};Drawing3D.prototype.noSmooth=function(){renderSmooth=false};Drawing2D.prototype.point=function(x,y){if(!doStroke)return;x=Math.round(x);y=Math.round(y);curContext.fillStyle=p.color.toString(currentStrokeColor);isFillDirty=true;if(lineWidth>1){curContext.beginPath();curContext.arc(x,y,lineWidth/2,0,6.283185307179586,false);curContext.fill()}else curContext.fillRect(x,y,1,1)};Drawing3D.prototype.point=function(x,y,z){var model=new PMatrix3D;model.translate(x,y,z||0);model.transpose();var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();curContext.useProgram(programObject2D);uniformMatrix("uModel2d",programObject2D,"uModel",false,model.array());uniformMatrix("uView2d",programObject2D,"uView",false,view.array());if(lineWidth>0&&doStroke){uniformf("uColor2d",programObject2D,"uColor",strokeStyle);uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",false);uniformi("uSmooth2d",programObject2D,"uSmooth",renderSmooth);vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,pointBuffer);disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord");curContext.drawArrays(curContext.POINTS,0,1)}};p.beginShape=function(type){curShape=type;curvePoints=[];vertArray=[]};Drawing2D.prototype.vertex=function(x,y,moveTo){var vert=[];if(firstVert)firstVert=false;vert["isVert"]=true;vert[0]=x;vert[1]=y;vert[2]=0;vert[3]=0;vert[4]=0;vert[5]=currentFillColor;vert[6]=currentStrokeColor;vertArray.push(vert);if(moveTo)vertArray[vertArray.length-1]["moveTo"]=moveTo};Drawing3D.prototype.vertex=function(x,y,z,u,v){var vert=[];if(firstVert)firstVert=false;vert["isVert"]=true;if(v===undef&&usingTexture){v=u;u=z;z=0}if(u!==undef&&v!==undef){if(curTextureMode===2){u/=curTexture.width;v/=curTexture.height}u=u>1?1:u;u=u<0?0:u;v=v>1?1:v;v=v<0?0:v}vert[0]=x;vert[1]=y;vert[2]=z||0;vert[3]=u||0;vert[4]=v||0;vert[5]=fillStyle[0];vert[6]=fillStyle[1];vert[7]=fillStyle[2];vert[8]=fillStyle[3];vert[9]=strokeStyle[0];vert[10]=strokeStyle[1];vert[11]=strokeStyle[2];vert[12]=strokeStyle[3];vert[13]=normalX;vert[14]=normalY;vert[15]=normalZ;vertArray.push(vert)};var point3D=function(vArray,cArray){var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();curContext.useProgram(programObjectUnlitShape);uniformMatrix("uViewUS",programObjectUnlitShape,"uView",false,view.array());uniformi("uSmoothUS",programObjectUnlitShape,"uSmooth",renderSmooth);vertexAttribPointer("aVertexUS",programObjectUnlitShape,"aVertex",3,pointBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW);vertexAttribPointer("aColorUS",programObjectUnlitShape,"aColor",4,fillColorBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW);curContext.drawArrays(curContext.POINTS,0,vArray.length/3)};var line3D=function(vArray,mode,cArray){var ctxMode;if(mode==="LINES")ctxMode=curContext.LINES;else if(mode==="LINE_LOOP")ctxMode=curContext.LINE_LOOP;else ctxMode=curContext.LINE_STRIP;var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();curContext.useProgram(programObjectUnlitShape);uniformMatrix("uViewUS",programObjectUnlitShape,"uView",false,view.array());vertexAttribPointer("aVertexUS",programObjectUnlitShape,"aVertex",3,lineBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW);vertexAttribPointer("aColorUS",programObjectUnlitShape,"aColor",4,strokeColorBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW);curContext.drawArrays(ctxMode,0,vArray.length/3)};var fill3D=function(vArray,mode,cArray,tArray){var ctxMode;if(mode==="TRIANGLES")ctxMode=curContext.TRIANGLES;else if(mode==="TRIANGLE_FAN")ctxMode=curContext.TRIANGLE_FAN;else ctxMode=curContext.TRIANGLE_STRIP;var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();curContext.useProgram(programObject3D);uniformMatrix("model3d",programObject3D,"uModel",false,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);uniformMatrix("view3d",programObject3D,"uView",false,view.array());curContext.enable(curContext.POLYGON_OFFSET_FILL);curContext.polygonOffset(1,1);uniformf("color3d",programObject3D,"uColor",[-1,0,0,0]);vertexAttribPointer("vertex3d",programObject3D,"aVertex",3,fillBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(vArray),curContext.STREAM_DRAW);if(usingTexture&&curTint!==null)curTint3d(cArray);vertexAttribPointer("aColor3d",programObject3D,"aColor",4,fillColorBuffer);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(cArray),curContext.STREAM_DRAW);disableVertexAttribPointer("aNormal3d",programObject3D,"aNormal");if(usingTexture){uniformi("uUsingTexture3d",programObject3D,"uUsingTexture",usingTexture);vertexAttribPointer("aTexture3d",programObject3D,"aTexture",2,shapeTexVBO);curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(tArray),curContext.STREAM_DRAW)}curContext.drawArrays(ctxMode,0,vArray.length/3);curContext.disable(curContext.POLYGON_OFFSET_FILL)};function fillStrokeClose(){executeContextFill();executeContextStroke();curContext.closePath()}Drawing2D.prototype.endShape=function(mode){if(vertArray.length===0)return;var closeShape=mode===2;if(closeShape)vertArray.push(vertArray[0]);var lineVertArray=[];var fillVertArray=[];var colorVertArray=[];var strokeVertArray=[];var texVertArray=[];var cachedVertArray;firstVert=true;var i,j,k;var vertArrayLength=vertArray.length;for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)fillVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=5;j<9;j++)colorVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=9;j<13;j++)strokeVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];texVertArray.push(cachedVertArray[3]);texVertArray.push(cachedVertArray[4])}if(isCurve&&(curShape===20||curShape===undef)){if(vertArrayLength>3){var b=[],s=1-curTightness;curContext.beginPath();curContext.moveTo(vertArray[1][0],vertArray[1][1]);for(i=1;i+2<vertArrayLength;i++){cachedVertArray=vertArray[i];b[0]=[cachedVertArray[0],cachedVertArray[1]];b[1]=[cachedVertArray[0]+(s*vertArray[i+1][0]-s*vertArray[i-1][0])/6,cachedVertArray[1]+(s*vertArray[i+1][1]-s*vertArray[i-1][1])/6];b[2]=[vertArray[i+1][0]+(s*vertArray[i][0]-s*vertArray[i+2][0])/6,vertArray[i+1][1]+(s*vertArray[i][1]-s*vertArray[i+2][1])/6];b[3]=[vertArray[i+1][0],vertArray[i+1][1]];curContext.bezierCurveTo(b[1][0],b[1][1],b[2][0],b[2][1],b[3][0],b[3][1])}fillStrokeClose()}}else if(isBezier&&(curShape===20||curShape===undef)){curContext.beginPath();for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];if(vertArray[i]["isVert"])if(vertArray[i]["moveTo"])curContext.moveTo(cachedVertArray[0],cachedVertArray[1]);else curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);else curContext.bezierCurveTo(vertArray[i][0],vertArray[i][1],vertArray[i][2],vertArray[i][3],vertArray[i][4],vertArray[i][5])}fillStrokeClose()}else if(curShape===2)for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];if(doStroke)p.stroke(cachedVertArray[6]);p.point(cachedVertArray[0],cachedVertArray[1])}else if(curShape===4)for(i=0;i+1<vertArrayLength;i+=2){cachedVertArray=vertArray[i];if(doStroke)p.stroke(vertArray[i+1][6]);p.line(cachedVertArray[0],cachedVertArray[1],vertArray[i+1][0],vertArray[i+1][1])}else if(curShape===9)for(i=0;i+2<vertArrayLength;i+=3){cachedVertArray=vertArray[i];curContext.beginPath();curContext.moveTo(cachedVertArray[0],cachedVertArray[1]);curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1]);curContext.lineTo(vertArray[i+2][0],vertArray[i+2][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);if(doFill){p.fill(vertArray[i+2][5]);executeContextFill()}if(doStroke){p.stroke(vertArray[i+2][6]);executeContextStroke()}curContext.closePath()}else if(curShape===10)for(i=0;i+1<vertArrayLength;i++){cachedVertArray=vertArray[i];curContext.beginPath();curContext.moveTo(vertArray[i+1][0],vertArray[i+1][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);if(doStroke)p.stroke(vertArray[i+1][6]);if(doFill)p.fill(vertArray[i+1][5]);if(i+2<vertArrayLength){curContext.lineTo(vertArray[i+2][0],vertArray[i+2][1]);if(doStroke)p.stroke(vertArray[i+2][6]);if(doFill)p.fill(vertArray[i+2][5])}fillStrokeClose()}else if(curShape===11){if(vertArrayLength>2){curContext.beginPath();curContext.moveTo(vertArray[0][0],vertArray[0][1]);curContext.lineTo(vertArray[1][0],vertArray[1][1]);curContext.lineTo(vertArray[2][0],vertArray[2][1]);if(doFill){p.fill(vertArray[2][5]);executeContextFill()}if(doStroke){p.stroke(vertArray[2][6]);executeContextStroke()}curContext.closePath();for(i=3;i<vertArrayLength;i++){cachedVertArray=vertArray[i];curContext.beginPath();curContext.moveTo(vertArray[0][0],vertArray[0][1]);curContext.lineTo(vertArray[i-1][0],vertArray[i-1][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);if(doFill){p.fill(cachedVertArray[5]);executeContextFill()}if(doStroke){p.stroke(cachedVertArray[6]);executeContextStroke()}curContext.closePath()}}}else if(curShape===16)for(i=0;i+3<vertArrayLength;i+=4){cachedVertArray=vertArray[i];curContext.beginPath();curContext.moveTo(cachedVertArray[0],cachedVertArray[1]);for(j=1;j<4;j++)curContext.lineTo(vertArray[i+j][0],vertArray[i+j][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);if(doFill){p.fill(vertArray[i+3][5]);executeContextFill()}if(doStroke){p.stroke(vertArray[i+3][6]);executeContextStroke()}curContext.closePath()}else if(curShape===17){if(vertArrayLength>3)for(i=0;i+1<vertArrayLength;i+=2){cachedVertArray=vertArray[i];curContext.beginPath();if(i+3<vertArrayLength){curContext.moveTo(vertArray[i+2][0],vertArray[i+2][1]);curContext.lineTo(cachedVertArray[0],cachedVertArray[1]);curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1]);curContext.lineTo(vertArray[i+3][0],vertArray[i+3][1]);if(doFill)p.fill(vertArray[i+3][5]);if(doStroke)p.stroke(vertArray[i+3][6])}else{curContext.moveTo(cachedVertArray[0],cachedVertArray[1]);curContext.lineTo(vertArray[i+1][0],vertArray[i+1][1])}fillStrokeClose()}}else{curContext.beginPath();curContext.moveTo(vertArray[0][0],vertArray[0][1]);for(i=1;i<vertArrayLength;i++){cachedVertArray=vertArray[i];if(cachedVertArray["isVert"])if(cachedVertArray["moveTo"])curContext.moveTo(cachedVertArray[0],cachedVertArray[1]);else curContext.lineTo(cachedVertArray[0],cachedVertArray[1])}fillStrokeClose()}isCurve=false;isBezier=false;curveVertArray=[];curveVertCount=0;if(closeShape)vertArray.pop()};Drawing3D.prototype.endShape=function(mode){if(vertArray.length===0)return;var closeShape=mode===2;var lineVertArray=[];var fillVertArray=[];var colorVertArray=[];var strokeVertArray=[];var texVertArray=[];var cachedVertArray;firstVert=true;var i,j,k;var vertArrayLength=vertArray.length;for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)fillVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=5;j<9;j++)colorVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=9;j<13;j++)strokeVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];texVertArray.push(cachedVertArray[3]);texVertArray.push(cachedVertArray[4])}if(closeShape){fillVertArray.push(vertArray[0][0]);fillVertArray.push(vertArray[0][1]);fillVertArray.push(vertArray[0][2]);for(i=5;i<9;i++)colorVertArray.push(vertArray[0][i]);for(i=9;i<13;i++)strokeVertArray.push(vertArray[0][i]);texVertArray.push(vertArray[0][3]);texVertArray.push(vertArray[0][4])}if(isCurve&&(curShape===20||curShape===undef)){lineVertArray=fillVertArray;if(doStroke)line3D(lineVertArray,null,strokeVertArray);if(doFill)fill3D(fillVertArray,null,colorVertArray)}else if(isBezier&&(curShape===20||curShape===undef)){lineVertArray=fillVertArray;lineVertArray.splice(lineVertArray.length-3);strokeVertArray.splice(strokeVertArray.length-4);if(doStroke)line3D(lineVertArray,null,strokeVertArray);if(doFill)fill3D(fillVertArray,"TRIANGLES",colorVertArray)}else{if(curShape===2){for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)lineVertArray.push(cachedVertArray[j])}point3D(lineVertArray,strokeVertArray)}else if(curShape===4){for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)lineVertArray.push(cachedVertArray[j])}for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=5;j<9;j++)colorVertArray.push(cachedVertArray[j])}line3D(lineVertArray,"LINES",strokeVertArray)}else if(curShape===9){if(vertArrayLength>2)for(i=0;i+2<vertArrayLength;i+=3){fillVertArray=[];texVertArray=[];lineVertArray=[];colorVertArray=[];strokeVertArray=[];for(j=0;j<3;j++)for(k=0;k<3;k++){lineVertArray.push(vertArray[i+j][k]);fillVertArray.push(vertArray[i+j][k])}for(j=0;j<3;j++)for(k=3;k<5;k++)texVertArray.push(vertArray[i+j][k]);for(j=0;j<3;j++)for(k=5;k<9;k++){colorVertArray.push(vertArray[i+j][k]);strokeVertArray.push(vertArray[i+j][k+4])}if(doStroke)line3D(lineVertArray,"LINE_LOOP",strokeVertArray);if(doFill||usingTexture)fill3D(fillVertArray,"TRIANGLES",colorVertArray,texVertArray)}}else if(curShape===10){if(vertArrayLength>2)for(i=0;i+2<vertArrayLength;i++){lineVertArray=[];fillVertArray=[];strokeVertArray=[];colorVertArray=[];texVertArray=[];for(j=0;j<3;j++)for(k=0;k<3;k++){lineVertArray.push(vertArray[i+j][k]);fillVertArray.push(vertArray[i+j][k])}for(j=0;j<3;j++)for(k=3;k<5;k++)texVertArray.push(vertArray[i+j][k]);for(j=0;j<3;j++)for(k=5;k<9;k++){strokeVertArray.push(vertArray[i+j][k+4]);colorVertArray.push(vertArray[i+j][k])}if(doFill||usingTexture)fill3D(fillVertArray,"TRIANGLE_STRIP",colorVertArray,texVertArray);if(doStroke)line3D(lineVertArray,"LINE_LOOP",strokeVertArray)}}else if(curShape===11){if(vertArrayLength>2){for(i=0;i<3;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)lineVertArray.push(cachedVertArray[j])}for(i=0;i<3;i++){cachedVertArray=vertArray[i];for(j=9;j<13;j++)strokeVertArray.push(cachedVertArray[j])}if(doStroke)line3D(lineVertArray,"LINE_LOOP",strokeVertArray);for(i=2;i+1<vertArrayLength;i++){lineVertArray=[];strokeVertArray=[];lineVertArray.push(vertArray[0][0]);lineVertArray.push(vertArray[0][1]);lineVertArray.push(vertArray[0][2]);strokeVertArray.push(vertArray[0][9]);strokeVertArray.push(vertArray[0][10]);strokeVertArray.push(vertArray[0][11]);strokeVertArray.push(vertArray[0][12]);for(j=0;j<2;j++)for(k=0;k<3;k++)lineVertArray.push(vertArray[i+j][k]);for(j=0;j<2;j++)for(k=9;k<13;k++)strokeVertArray.push(vertArray[i+j][k]);if(doStroke)line3D(lineVertArray,"LINE_STRIP",strokeVertArray)}if(doFill||usingTexture)fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray,texVertArray)}}else if(curShape===16)for(i=0;i+3<vertArrayLength;i+=4){lineVertArray=[];for(j=0;j<4;j++){cachedVertArray=vertArray[i+j];for(k=0;k<3;k++)lineVertArray.push(cachedVertArray[k])}if(doStroke)line3D(lineVertArray,"LINE_LOOP",strokeVertArray);if(doFill){fillVertArray=[];colorVertArray=[];texVertArray=[];for(j=0;j<3;j++)fillVertArray.push(vertArray[i][j]);for(j=5;j<9;j++)colorVertArray.push(vertArray[i][j]);for(j=0;j<3;j++)fillVertArray.push(vertArray[i+1][j]);for(j=5;j<9;j++)colorVertArray.push(vertArray[i+1][j]);for(j=0;j<3;j++)fillVertArray.push(vertArray[i+3][j]);for(j=5;j<9;j++)colorVertArray.push(vertArray[i+3][j]);for(j=0;j<3;j++)fillVertArray.push(vertArray[i+2][j]);for(j=5;j<9;j++)colorVertArray.push(vertArray[i+2][j]);if(usingTexture){texVertArray.push(vertArray[i+0][3]);texVertArray.push(vertArray[i+0][4]);texVertArray.push(vertArray[i+1][3]);texVertArray.push(vertArray[i+1][4]);texVertArray.push(vertArray[i+3][3]);texVertArray.push(vertArray[i+3][4]);texVertArray.push(vertArray[i+2][3]);texVertArray.push(vertArray[i+2][4])}fill3D(fillVertArray,"TRIANGLE_STRIP",colorVertArray,texVertArray)}}else if(curShape===17){var tempArray=[];if(vertArrayLength>3){for(i=0;i<2;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)lineVertArray.push(cachedVertArray[j])}for(i=0;i<2;i++){cachedVertArray=vertArray[i];for(j=9;j<13;j++)strokeVertArray.push(cachedVertArray[j])}line3D(lineVertArray,"LINE_STRIP",strokeVertArray);if(vertArrayLength>4&&vertArrayLength%2>0){tempArray=fillVertArray.splice(fillVertArray.length-3);vertArray.pop()}for(i=0;i+3<vertArrayLength;i+=2){lineVertArray=[];strokeVertArray=[];for(j=0;j<3;j++)lineVertArray.push(vertArray[i+1][j]);for(j=0;j<3;j++)lineVertArray.push(vertArray[i+3][j]);for(j=0;j<3;j++)lineVertArray.push(vertArray[i+2][j]);for(j=0;j<3;j++)lineVertArray.push(vertArray[i+0][j]);for(j=9;j<13;j++)strokeVertArray.push(vertArray[i+1][j]);for(j=9;j<13;j++)strokeVertArray.push(vertArray[i+3][j]);for(j=9;j<13;j++)strokeVertArray.push(vertArray[i+2][j]);for(j=9;j<13;j++)strokeVertArray.push(vertArray[i+0][j]);if(doStroke)line3D(lineVertArray,"LINE_STRIP",strokeVertArray)}if(doFill||usingTexture)fill3D(fillVertArray,"TRIANGLE_LIST",colorVertArray,texVertArray)}}else if(vertArrayLength===1){for(j=0;j<3;j++)lineVertArray.push(vertArray[0][j]);for(j=9;j<13;j++)strokeVertArray.push(vertArray[0][j]);point3D(lineVertArray,strokeVertArray)}else{for(i=0;i<vertArrayLength;i++){cachedVertArray=vertArray[i];for(j=0;j<3;j++)lineVertArray.push(cachedVertArray[j]);for(j=5;j<9;j++)strokeVertArray.push(cachedVertArray[j])}if(doStroke&&closeShape)line3D(lineVertArray,"LINE_LOOP",strokeVertArray);else if(doStroke&&!closeShape)line3D(lineVertArray,"LINE_STRIP",strokeVertArray);if(doFill||usingTexture)fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray,texVertArray)}usingTexture=false;curContext.useProgram(programObject3D);uniformi("usingTexture3d",programObject3D,"uUsingTexture",usingTexture)}isCurve=false;isBezier=false;curveVertArray=[];curveVertCount=0};var splineForward=function(segments,matrix){var f=1/segments;var ff=f*f;var fff=ff*f;matrix.set(0,0,0,1,fff,ff,f,0,6*fff,2*ff,0,0,6*fff,0,0,0)};var curveInit=function(){if(!curveDrawMatrix){curveBasisMatrix=new PMatrix3D;curveDrawMatrix=new PMatrix3D;curveInited=true}var s=curTightness;curveBasisMatrix.set((s-1)/2,(s+3)/2,(-3-s)/2,(1-s)/2,1-s,(-5-s)/2,s+2,(s-1)/2,(s-1)/2,0,(1-s)/2,0,0,1,0,0);splineForward(curveDet,curveDrawMatrix);if(!bezierBasisInverse)curveToBezierMatrix=new PMatrix3D;curveToBezierMatrix.set(curveBasisMatrix);curveToBezierMatrix.preApply(bezierBasisInverse);curveDrawMatrix.apply(curveBasisMatrix)};Drawing2D.prototype.bezierVertex=function(){isBezier=true;var vert=[];if(firstVert)throw"vertex() must be used at least once before calling bezierVertex()";for(var i=0;i<arguments.length;i++)vert[i]=arguments[i];vertArray.push(vert);vertArray[vertArray.length-1]["isVert"]=false};Drawing3D.prototype.bezierVertex=function(){isBezier=true;var vert=[];if(firstVert)throw"vertex() must be used at least once before calling bezierVertex()";if(arguments.length===9){if(bezierDrawMatrix===undef)bezierDrawMatrix=new PMatrix3D;var lastPoint=vertArray.length-1;splineForward(bezDetail,bezierDrawMatrix);bezierDrawMatrix.apply(bezierBasisMatrix);var draw=bezierDrawMatrix.array();var x1=vertArray[lastPoint][0],y1=vertArray[lastPoint][1],z1=vertArray[lastPoint][2];var xplot1=draw[4]*x1+draw[5]*arguments[0]+draw[6]*arguments[3]+draw[7]*arguments[6];var xplot2=draw[8]*x1+draw[9]*arguments[0]+draw[10]*arguments[3]+draw[11]*arguments[6];var xplot3=draw[12]*x1+draw[13]*arguments[0]+draw[14]*arguments[3]+draw[15]*arguments[6];var yplot1=draw[4]*y1+draw[5]*arguments[1]+draw[6]*arguments[4]+draw[7]*arguments[7];var yplot2=draw[8]*y1+draw[9]*arguments[1]+draw[10]*arguments[4]+draw[11]*arguments[7];var yplot3=draw[12]*y1+draw[13]*arguments[1]+draw[14]*arguments[4]+draw[15]*arguments[7];var zplot1=draw[4]*z1+draw[5]*arguments[2]+draw[6]*arguments[5]+draw[7]*arguments[8];var zplot2=draw[8]*z1+draw[9]*arguments[2]+draw[10]*arguments[5]+draw[11]*arguments[8];var zplot3=draw[12]*z1+draw[13]*arguments[2]+draw[14]*arguments[5]+draw[15]*arguments[8];for(var j=0;j<bezDetail;j++){x1+=xplot1;xplot1+=xplot2;xplot2+=xplot3;y1+=yplot1;yplot1+=yplot2;yplot2+=yplot3;z1+=zplot1;zplot1+=zplot2;zplot2+=zplot3;p.vertex(x1,y1,z1)}p.vertex(arguments[6],arguments[7],arguments[8])}};p.texture=function(pimage){var curContext=drawing.$ensureContext();if(pimage.__texture)curContext.bindTexture(curContext.TEXTURE_2D,pimage.__texture);else if(pimage.localName==="canvas"){curContext.bindTexture(curContext.TEXTURE_2D,canTex);curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,pimage);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR);curContext.generateMipmap(curContext.TEXTURE_2D);curTexture.width=pimage.width;curTexture.height=pimage.height}else{var texture=curContext.createTexture(),cvs=document.createElement("canvas"),cvsTextureCtx=cvs.getContext("2d"),pot;if(pimage.width&pimage.width-1===0)cvs.width=pimage.width;else{pot=1;while(pot<pimage.width)pot*=2;cvs.width=pot}if(pimage.height&pimage.height-1===0)cvs.height=pimage.height;else{pot=1;while(pot<pimage.height)pot*=2;cvs.height=pot}cvsTextureCtx.drawImage(pimage.sourceImg,0,0,pimage.width,pimage.height,0,0,cvs.width,cvs.height);curContext.bindTexture(curContext.TEXTURE_2D,texture);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR_MIPMAP_LINEAR);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_T,curContext.CLAMP_TO_EDGE);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_S,curContext.CLAMP_TO_EDGE);curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,cvs);curContext.generateMipmap(curContext.TEXTURE_2D);pimage.__texture=texture;curTexture.width=pimage.width;curTexture.height=pimage.height}usingTexture=true;curContext.useProgram(programObject3D);uniformi("usingTexture3d",programObject3D,"uUsingTexture",usingTexture)};p.textureMode=function(mode){curTextureMode=mode};var curveVertexSegment=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){var x0=x2;var y0=y2;var z0=z2;var draw=curveDrawMatrix.array();var xplot1=draw[4]*x1+draw[5]*x2+draw[6]*x3+draw[7]*x4;var xplot2=draw[8]*x1+draw[9]*x2+draw[10]*x3+draw[11]*x4;var xplot3=draw[12]*x1+draw[13]*x2+draw[14]*x3+draw[15]*x4;var yplot1=draw[4]*y1+draw[5]*y2+draw[6]*y3+draw[7]*y4;var yplot2=draw[8]*y1+draw[9]*y2+draw[10]*y3+draw[11]*y4;var yplot3=draw[12]*y1+draw[13]*y2+draw[14]*y3+draw[15]*y4;var zplot1=draw[4]*z1+draw[5]*z2+draw[6]*z3+draw[7]*z4;var zplot2=draw[8]*z1+draw[9]*z2+draw[10]*z3+draw[11]*z4;var zplot3=draw[12]*z1+draw[13]*z2+draw[14]*z3+draw[15]*z4;p.vertex(x0,y0,z0);for(var j=0;j<curveDet;j++){x0+=xplot1;xplot1+=xplot2;xplot2+=xplot3;y0+=yplot1;yplot1+=yplot2;yplot2+=yplot3;z0+=zplot1;zplot1+=zplot2;zplot2+=zplot3;p.vertex(x0,y0,z0)}};Drawing2D.prototype.curveVertex=function(x,y){isCurve=true;p.vertex(x,y)};Drawing3D.prototype.curveVertex=function(x,y,z){isCurve=true;if(!curveInited)curveInit();var vert=[];vert[0]=x;vert[1]=y;vert[2]=z;curveVertArray.push(vert);curveVertCount++;if(curveVertCount>3)curveVertexSegment(curveVertArray[curveVertCount-4][0],curveVertArray[curveVertCount-4][1],curveVertArray[curveVertCount-4][2],curveVertArray[curveVertCount-3][0],curveVertArray[curveVertCount-3][1],curveVertArray[curveVertCount-3][2],curveVertArray[curveVertCount-2][0],curveVertArray[curveVertCount-2][1],curveVertArray[curveVertCount-2][2],curveVertArray[curveVertCount-1][0],curveVertArray[curveVertCount-1][1],curveVertArray[curveVertCount-1][2])};Drawing2D.prototype.curve=function(x1,y1,x2,y2,x3,y3,x4,y4){p.beginShape();p.curveVertex(x1,y1);p.curveVertex(x2,y2);p.curveVertex(x3,y3);p.curveVertex(x4,y4);p.endShape()};Drawing3D.prototype.curve=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){if(z4!==undef){p.beginShape();p.curveVertex(x1,y1,z1);p.curveVertex(x2,y2,z2);p.curveVertex(x3,y3,z3);p.curveVertex(x4,y4,z4);p.endShape();return}p.beginShape();p.curveVertex(x1,y1);p.curveVertex(z1,x2);p.curveVertex(y2,z2);p.curveVertex(x3,y3);p.endShape()};p.curveTightness=function(tightness){curTightness=tightness};p.curveDetail=function(detail){curveDet=detail;curveInit()};p.rectMode=function(aRectMode){curRectMode=aRectMode};p.imageMode=function(mode){switch(mode){case 0:imageModeConvert=imageModeCorner;break;case 1:imageModeConvert=imageModeCorners;break;case 3:imageModeConvert=imageModeCenter;break;default:throw"Invalid imageMode"}};p.ellipseMode=function(aEllipseMode){curEllipseMode=aEllipseMode};p.arc=function(x,y,width,height,start,stop){if(width<=0||stop<start)return;if(curEllipseMode===1){width=width-x;height=height-y}else if(curEllipseMode===2){x=x-width;y=y-height;width=width*2;height=height*2}else if(curEllipseMode===3){x=x-width/2;y=y-height/2}while(start<0){start+=6.283185307179586;stop+=6.283185307179586}if(stop-start>6.283185307179586){start=0;stop=6.283185307179586}var hr=width/2,vr=height/2,centerX=x+hr,centerY=y+vr,startLUT=0|.5+start*p.RAD_TO_DEG*2,stopLUT=0|.5+stop*p.RAD_TO_DEG*2,i,j;if(doFill){var savedStroke=doStroke;doStroke=false;p.beginShape();p.vertex(centerX,centerY);for(i=startLUT;i<=stopLUT;i++){j=i%720;p.vertex(centerX+cosLUT[j]*hr,centerY+sinLUT[j]*vr)}p.endShape(2);doStroke=savedStroke}if(doStroke){var savedFill=doFill;doFill=false;p.beginShape();for(i=startLUT;i<=stopLUT;i++){j=i%720;p.vertex(centerX+cosLUT[j]*hr,centerY+sinLUT[j]*vr)}p.endShape();doFill=savedFill}};Drawing2D.prototype.line=function(x1,y1,x2,y2){if(!doStroke)return;x1=Math.round(x1);x2=Math.round(x2);y1=Math.round(y1);y2=Math.round(y2);if(x1===x2&&y1===y2){p.point(x1,y1);return}var swap=undef,lineCap=undef,drawCrisp=true,currentModelView=modelView.array(),identityMatrix=[1,0,0,0,1,0];for(var i=0;i<6&&drawCrisp;i++)drawCrisp=currentModelView[i]===identityMatrix[i];
if(drawCrisp){if(x1===x2){if(y1>y2){swap=y1;y1=y2;y2=swap}y2++;if(lineWidth%2===1)curContext.translate(.5,0)}else if(y1===y2){if(x1>x2){swap=x1;x1=x2;x2=swap}x2++;if(lineWidth%2===1)curContext.translate(0,.5)}if(lineWidth===1){lineCap=curContext.lineCap;curContext.lineCap="butt"}}curContext.beginPath();curContext.moveTo(x1||0,y1||0);curContext.lineTo(x2||0,y2||0);executeContextStroke();if(drawCrisp){if(x1===x2&&lineWidth%2===1)curContext.translate(-.5,0);else if(y1===y2&&lineWidth%2===1)curContext.translate(0,-.5);if(lineWidth===1)curContext.lineCap=lineCap}};Drawing3D.prototype.line=function(x1,y1,z1,x2,y2,z2){if(y2===undef||z2===undef){z2=0;y2=x2;x2=z1;z1=0}if(x1===x2&&y1===y2&&z1===z2){p.point(x1,y1,z1);return}var lineVerts=[x1,y1,z1,x2,y2,z2];var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();if(lineWidth>0&&doStroke){curContext.useProgram(programObject2D);uniformMatrix("uModel2d",programObject2D,"uModel",false,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);uniformMatrix("uView2d",programObject2D,"uView",false,view.array());uniformf("uColor2d",programObject2D,"uColor",strokeStyle);uniformi("uIsDrawingText",programObject2D,"uIsDrawingText",false);vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,lineBuffer);disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord");curContext.bufferData(curContext.ARRAY_BUFFER,new Float32Array(lineVerts),curContext.STREAM_DRAW);curContext.drawArrays(curContext.LINES,0,2)}};Drawing2D.prototype.bezier=function(){if(arguments.length!==8)throw"You must use 8 parameters for bezier() in 2D mode";p.beginShape();p.vertex(arguments[0],arguments[1]);p.bezierVertex(arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);p.endShape()};Drawing3D.prototype.bezier=function(){if(arguments.length!==12)throw"You must use 12 parameters for bezier() in 3D mode";p.beginShape();p.vertex(arguments[0],arguments[1],arguments[2]);p.bezierVertex(arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]);p.endShape()};p.bezierDetail=function(detail){bezDetail=detail};p.bezierPoint=function(a,b,c,d,t){return(1-t)*(1-t)*(1-t)*a+3*(1-t)*(1-t)*t*b+3*(1-t)*t*t*c+t*t*t*d};p.bezierTangent=function(a,b,c,d,t){return 3*t*t*(-a+3*b-3*c+d)+6*t*(a-2*b+c)+3*(-a+b)};p.curvePoint=function(a,b,c,d,t){return.5*(2*b+(-a+c)*t+(2*a-5*b+4*c-d)*t*t+(-a+3*b-3*c+d)*t*t*t)};p.curveTangent=function(a,b,c,d,t){return.5*(-a+c+2*(2*a-5*b+4*c-d)*t+3*(-a+3*b-3*c+d)*t*t)};p.triangle=function(x1,y1,x2,y2,x3,y3){p.beginShape(9);p.vertex(x1,y1,0);p.vertex(x2,y2,0);p.vertex(x3,y3,0);p.endShape()};p.quad=function(x1,y1,x2,y2,x3,y3,x4,y4){p.beginShape(16);p.vertex(x1,y1,0);p.vertex(x2,y2,0);p.vertex(x3,y3,0);p.vertex(x4,y4,0);p.endShape()};var roundedRect$2d=function(x,y,width,height,tl,tr,br,bl){if(bl===undef){tr=tl;br=tl;bl=tl}var halfWidth=width/2,halfHeight=height/2;if(tl>halfWidth||tl>halfHeight)tl=Math.min(halfWidth,halfHeight);if(tr>halfWidth||tr>halfHeight)tr=Math.min(halfWidth,halfHeight);if(br>halfWidth||br>halfHeight)br=Math.min(halfWidth,halfHeight);if(bl>halfWidth||bl>halfHeight)bl=Math.min(halfWidth,halfHeight);if(!doFill||doStroke)curContext.translate(.5,.5);curContext.beginPath();curContext.moveTo(x+tl,y);curContext.lineTo(x+width-tr,y);curContext.quadraticCurveTo(x+width,y,x+width,y+tr);curContext.lineTo(x+width,y+height-br);curContext.quadraticCurveTo(x+width,y+height,x+width-br,y+height);curContext.lineTo(x+bl,y+height);curContext.quadraticCurveTo(x,y+height,x,y+height-bl);curContext.lineTo(x,y+tl);curContext.quadraticCurveTo(x,y,x+tl,y);if(!doFill||doStroke)curContext.translate(-.5,-.5);executeContextFill();executeContextStroke()};Drawing2D.prototype.rect=function(x,y,width,height,tl,tr,br,bl){if(!width&&!height)return;if(curRectMode===1){width-=x;height-=y}else if(curRectMode===2){width*=2;height*=2;x-=width/2;y-=height/2}else if(curRectMode===3){x-=width/2;y-=height/2}x=Math.round(x);y=Math.round(y);width=Math.round(width);height=Math.round(height);if(tl!==undef){roundedRect$2d(x,y,width,height,tl,tr,br,bl);return}if(doStroke&&lineWidth%2===1)curContext.translate(.5,.5);curContext.beginPath();curContext.rect(x,y,width,height);executeContextFill();executeContextStroke();if(doStroke&&lineWidth%2===1)curContext.translate(-.5,-.5)};Drawing3D.prototype.rect=function(x,y,width,height,tl,tr,br,bl){if(tl!==undef)throw"rect() with rounded corners is not supported in 3D mode";if(curRectMode===1){width-=x;height-=y}else if(curRectMode===2){width*=2;height*=2;x-=width/2;y-=height/2}else if(curRectMode===3){x-=width/2;y-=height/2}var model=new PMatrix3D;model.translate(x,y,0);model.scale(width,height,1);model.transpose();var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();if(lineWidth>0&&doStroke){curContext.useProgram(programObject2D);uniformMatrix("uModel2d",programObject2D,"uModel",false,model.array());uniformMatrix("uView2d",programObject2D,"uView",false,view.array());uniformf("uColor2d",programObject2D,"uColor",strokeStyle);uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",false);vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,rectBuffer);disableVertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord");curContext.drawArrays(curContext.LINE_LOOP,0,rectVerts.length/3)}if(doFill){curContext.useProgram(programObject3D);uniformMatrix("uModel3d",programObject3D,"uModel",false,model.array());uniformMatrix("uView3d",programObject3D,"uView",false,view.array());curContext.enable(curContext.POLYGON_OFFSET_FILL);curContext.polygonOffset(1,1);uniformf("color3d",programObject3D,"uColor",fillStyle);if(lightCount>0){var v=new PMatrix3D;v.set(view);var m=new PMatrix3D;m.set(model);v.mult(m);var normalMatrix=new PMatrix3D;normalMatrix.set(v);normalMatrix.invert();normalMatrix.transpose();uniformMatrix("uNormalTransform3d",programObject3D,"uNormalTransform",false,normalMatrix.array());vertexAttribPointer("aNormal3d",programObject3D,"aNormal",3,rectNormBuffer)}else disableVertexAttribPointer("normal3d",programObject3D,"aNormal");vertexAttribPointer("vertex3d",programObject3D,"aVertex",3,rectBuffer);curContext.drawArrays(curContext.TRIANGLE_FAN,0,rectVerts.length/3);curContext.disable(curContext.POLYGON_OFFSET_FILL)}};Drawing2D.prototype.ellipse=function(x,y,width,height){x=x||0;y=y||0;if(width<=0&&height<=0)return;if(curEllipseMode===2){width*=2;height*=2}else if(curEllipseMode===1){width=width-x;height=height-y;x+=width/2;y+=height/2}else if(curEllipseMode===0){x+=width/2;y+=height/2}if(width===height){curContext.beginPath();curContext.arc(x,y,width/2,0,6.283185307179586,false);executeContextFill();executeContextStroke()}else{var w=width/2,h=height/2,C=.5522847498307933,c_x=C*w,c_y=C*h;p.beginShape();p.vertex(x+w,y);p.bezierVertex(x+w,y-c_y,x+c_x,y-h,x,y-h);p.bezierVertex(x-c_x,y-h,x-w,y-c_y,x-w,y);p.bezierVertex(x-w,y+c_y,x-c_x,y+h,x,y+h);p.bezierVertex(x+c_x,y+h,x+w,y+c_y,x+w,y);p.endShape()}};Drawing3D.prototype.ellipse=function(x,y,width,height){x=x||0;y=y||0;if(width<=0&&height<=0)return;if(curEllipseMode===2){width*=2;height*=2}else if(curEllipseMode===1){width=width-x;height=height-y;x+=width/2;y+=height/2}else if(curEllipseMode===0){x+=width/2;y+=height/2}var w=width/2,h=height/2,C=.5522847498307933,c_x=C*w,c_y=C*h;p.beginShape();p.vertex(x+w,y);p.bezierVertex(x+w,y-c_y,0,x+c_x,y-h,0,x,y-h,0);p.bezierVertex(x-c_x,y-h,0,x-w,y-c_y,0,x-w,y,0);p.bezierVertex(x-w,y+c_y,0,x-c_x,y+h,0,x,y+h,0);p.bezierVertex(x+c_x,y+h,0,x+w,y+c_y,0,x+w,y,0);p.endShape();if(doFill){var xAv=0,yAv=0,i,j;for(i=0;i<vertArray.length;i++){xAv+=vertArray[i][0];yAv+=vertArray[i][1]}xAv/=vertArray.length;yAv/=vertArray.length;var vert=[],fillVertArray=[],colorVertArray=[];vert[0]=xAv;vert[1]=yAv;vert[2]=0;vert[3]=0;vert[4]=0;vert[5]=fillStyle[0];vert[6]=fillStyle[1];vert[7]=fillStyle[2];vert[8]=fillStyle[3];vert[9]=strokeStyle[0];vert[10]=strokeStyle[1];vert[11]=strokeStyle[2];vert[12]=strokeStyle[3];vert[13]=normalX;vert[14]=normalY;vert[15]=normalZ;vertArray.unshift(vert);for(i=0;i<vertArray.length;i++){for(j=0;j<3;j++)fillVertArray.push(vertArray[i][j]);for(j=5;j<9;j++)colorVertArray.push(vertArray[i][j])}fill3D(fillVertArray,"TRIANGLE_FAN",colorVertArray)}};p.normal=function(nx,ny,nz){if(arguments.length!==3||!(typeof nx==="number"&&typeof ny==="number"&&typeof nz==="number"))throw"normal() requires three numeric arguments.";normalX=nx;normalY=ny;normalZ=nz;if(curShape!==0)if(normalMode===0)normalMode=1;else if(normalMode===1)normalMode=2};p.save=function(file,img){if(img!==undef)return window.open(img.toDataURL(),"_blank");return window.open(p.externals.canvas.toDataURL(),"_blank")};var saveNumber=0;p.saveFrame=function(file){if(file===undef)file="screen-####.png";var frameFilename=file.replace(/#+/,function(all){var s=""+saveNumber++;while(s.length<all.length)s="0"+s;return s});p.save(frameFilename)};var utilityContext2d=document.createElement("canvas").getContext("2d");var canvasDataCache=[undef,undef,undef];function getCanvasData(obj,w,h){var canvasData=canvasDataCache.shift();if(canvasData===undef){canvasData={};canvasData.canvas=document.createElement("canvas");canvasData.context=canvasData.canvas.getContext("2d")}canvasDataCache.push(canvasData);var canvas=canvasData.canvas,context=canvasData.context,width=w||obj.width,height=h||obj.height;canvas.width=width;canvas.height=height;if(!obj)context.clearRect(0,0,width,height);else if("data"in obj)context.putImageData(obj,0,0);else{context.clearRect(0,0,width,height);context.drawImage(obj,0,0,width,height)}return canvasData}function buildPixelsObject(pImage){return{getLength:function(aImg){return function(){if(aImg.isRemote)throw"Image is loaded remotely. Cannot get length.";else return aImg.imageData.data.length?aImg.imageData.data.length/4:0}}(pImage),getPixel:function(aImg){return function(i){var offset=i*4,data=aImg.imageData.data;if(aImg.isRemote)throw"Image is loaded remotely. Cannot get pixels.";return(data[offset+3]&255)<<24|(data[offset]&255)<<16|(data[offset+1]&255)<<8|data[offset+2]&255}}(pImage),setPixel:function(aImg){return function(i,c){var offset=i*4,data=aImg.imageData.data;if(aImg.isRemote)throw"Image is loaded remotely. Cannot set pixel.";data[offset+0]=c>>16&255;data[offset+1]=c>>8&255;data[offset+2]=c&255;data[offset+3]=c>>24&255;aImg.__isDirty=true}}(pImage),toArray:function(aImg){return function(){var arr=[],data=aImg.imageData.data,length=aImg.width*aImg.height;if(aImg.isRemote)throw"Image is loaded remotely. Cannot get pixels.";for(var i=0,offset=0;i<length;i++,offset+=4)arr.push((data[offset+3]&255)<<24|(data[offset]&255)<<16|(data[offset+1]&255)<<8|data[offset+2]&255);return arr}}(pImage),set:function(aImg){return function(arr){var offset,data,c;if(this.isRemote)throw"Image is loaded remotely. Cannot set pixels.";data=aImg.imageData.data;for(var i=0,aL=arr.length;i<aL;i++){c=arr[i];offset=i*4;data[offset+0]=c>>16&255;data[offset+1]=c>>8&255;data[offset+2]=c&255;data[offset+3]=c>>24&255}aImg.__isDirty=true}}(pImage)}}var PImage=function(aWidth,aHeight,aFormat){this.__isDirty=false;if(aWidth instanceof HTMLImageElement)this.fromHTMLImageData(aWidth);else if(aHeight||aFormat){this.width=aWidth||1;this.height=aHeight||1;var canvas=this.sourceImg=document.createElement("canvas");canvas.width=this.width;canvas.height=this.height;var imageData=this.imageData=canvas.getContext("2d").createImageData(this.width,this.height);this.format=aFormat===2||aFormat===4?aFormat:1;if(this.format===1)for(var i=3,data=this.imageData.data,len=data.length;i<len;i+=4)data[i]=255;this.__isDirty=true;this.updatePixels()}else{this.width=0;this.height=0;this.imageData=utilityContext2d.createImageData(1,1);this.format=2}this.pixels=buildPixelsObject(this)};PImage.prototype={__isPImage:true,updatePixels:function(){var canvas=this.sourceImg;if(canvas&&canvas instanceof HTMLCanvasElement&&this.__isDirty)canvas.getContext("2d").putImageData(this.imageData,0,0);this.__isDirty=false},fromHTMLImageData:function(htmlImg){var canvasData=getCanvasData(htmlImg);try{var imageData=canvasData.context.getImageData(0,0,htmlImg.width,htmlImg.height);this.fromImageData(imageData)}catch(e){if(htmlImg.width&&htmlImg.height){this.isRemote=true;this.width=htmlImg.width;this.height=htmlImg.height}}this.sourceImg=htmlImg},get:function(x,y,w,h){if(!arguments.length)return p.get(this);if(arguments.length===2)return p.get(x,y,this);if(arguments.length===4)return p.get(x,y,w,h,this)},set:function(x,y,c){p.set(x,y,c,this);this.__isDirty=true},blend:function(srcImg,x,y,width,height,dx,dy,dwidth,dheight,MODE){if(arguments.length===9)p.blend(this,srcImg,x,y,width,height,dx,dy,dwidth,dheight,this);else if(arguments.length===10)p.blend(srcImg,x,y,width,height,dx,dy,dwidth,dheight,MODE,this);delete this.sourceImg},copy:function(srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,dheight){if(arguments.length===8)p.blend(this,srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,0,this);else if(arguments.length===9)p.blend(srcImg,sx,sy,swidth,sheight,dx,dy,dwidth,dheight,0,this);delete this.sourceImg},filter:function(mode,param){if(arguments.length===2)p.filter(mode,param,this);else if(arguments.length===1)p.filter(mode,null,this);delete this.sourceImg},save:function(file){p.save(file,this)},resize:function(w,h){if(this.isRemote)throw"Image is loaded remotely. Cannot resize.";if(this.width!==0||this.height!==0){if(w===0&&h!==0)w=Math.floor(this.width/this.height*h);else if(h===0&&w!==0)h=Math.floor(this.height/this.width*w);var canvas=getCanvasData(this.imageData).canvas;var imageData=getCanvasData(canvas,w,h).context.getImageData(0,0,w,h);this.fromImageData(imageData)}},mask:function(mask){var obj=this.toImageData(),i,size;if(mask instanceof PImage||mask.__isPImage)if(mask.width===this.width&&mask.height===this.height){mask=mask.toImageData();for(i=2,size=this.width*this.height*4;i<size;i+=4)obj.data[i+1]=mask.data[i]}else throw"mask must have the same dimensions as PImage.";else if(mask instanceof Array)if(this.width*this.height===mask.length)for(i=0,size=mask.length;i<size;++i)obj.data[i*4+3]=mask[i];else throw"mask array must be the same length as PImage pixels array.";this.fromImageData(obj)},loadPixels:nop,toImageData:function(){if(this.isRemote)return this.sourceImg;if(!this.__isDirty)return this.imageData;var canvasData=getCanvasData(this.sourceImg);return canvasData.context.getImageData(0,0,this.width,this.height)},toDataURL:function(){if(this.isRemote)throw"Image is loaded remotely. Cannot create dataURI.";var canvasData=getCanvasData(this.imageData);return canvasData.canvas.toDataURL()},fromImageData:function(canvasImg){var w=canvasImg.width,h=canvasImg.height,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");this.width=canvas.width=w;this.height=canvas.height=h;ctx.putImageData(canvasImg,0,0);this.format=2;this.imageData=canvasImg;this.sourceImg=canvas}};p.PImage=PImage;p.createImage=function(w,h,mode){return new PImage(w,h,mode)};p.loadImage=function(file,type,callback){if(type)file=file+"."+type;var pimg;if(curSketch.imageCache.images[file]){pimg=new PImage(curSketch.imageCache.images[file]);pimg.loaded=true;return pimg}pimg=new PImage;var img=document.createElement("img");pimg.sourceImg=img;img.onload=function(aImage,aPImage,aCallback){var image=aImage;var pimg=aPImage;var callback=aCallback;return function(){pimg.fromHTMLImageData(image);pimg.loaded=true;if(callback)callback()}}(img,pimg,callback);img.src=file;return pimg};p.requestImage=p.loadImage;function get$2(x,y){var data;if(x>=p.width||x<0||y<0||y>=p.height)return 0;if(isContextReplaced){var offset=((0|x)+p.width*(0|y))*4;data=p.imageData.data;return(data[offset+3]&255)<<24|(data[offset]&255)<<16|(data[offset+1]&255)<<8|data[offset+2]&255}data=p.toImageData(0|x,0|y,1,1).data;return(data[3]&255)<<24|(data[0]&255)<<16|(data[1]&255)<<8|data[2]&255}function get$3(x,y,img){if(img.isRemote)throw"Image is loaded remotely. Cannot get x,y.";var offset=y*img.width*4+x*4,data=img.imageData.data;return(data[offset+3]&255)<<24|(data[offset]&255)<<16|(data[offset+1]&255)<<8|data[offset+2]&255}function get$4(x,y,w,h){var c=new PImage(w,h,2);c.fromImageData(p.toImageData(x,y,w,h));return c}function get$5(x,y,w,h,img){if(img.isRemote)throw"Image is loaded remotely. Cannot get x,y,w,h.";var c=new PImage(w,h,2),cData=c.imageData.data,imgWidth=img.width,imgHeight=img.height,imgData=img.imageData.data;var startRow=Math.max(0,-y),startColumn=Math.max(0,-x),stopRow=Math.min(h,imgHeight-y),stopColumn=Math.min(w,imgWidth-x);for(var i=startRow;i<stopRow;++i){var sourceOffset=((y+i)*imgWidth+(x+startColumn))*4;var targetOffset=(i*w+startColumn)*4;for(var j=startColumn;j<stopColumn;++j){cData[targetOffset++]=imgData[sourceOffset++];cData[targetOffset++]=imgData[sourceOffset++];cData[targetOffset++]=imgData[sourceOffset++];cData[targetOffset++]=imgData[sourceOffset++]}}c.__isDirty=true;return c}p.get=function(x,y,w,h,img){if(img!==undefined)return get$5(x,y,w,h,img);if(h!==undefined)return get$4(x,y,w,h);if(w!==undefined)return get$3(x,y,w);if(y!==undefined)return get$2(x,y);if(x!==undefined)return get$5(0,0,x.width,x.height,x);return get$4(0,0,p.width,p.height)};p.createGraphics=function(w,h,render){var pg=new Processing;pg.size(w,h,render);pg.background(0,0);return pg};function resetContext(){if(isContextReplaced){curContext=originalContext;isContextReplaced=false;p.updatePixels()}}function SetPixelContextWrapper(){function wrapFunction(newContext,name){function wrapper(){resetContext();curContext[name].apply(curContext,arguments)}newContext[name]=wrapper}function wrapProperty(newContext,name){function getter(){resetContext();return curContext[name]}function setter(value){resetContext();curContext[name]=value}p.defineProperty(newContext,name,{get:getter,set:setter})}for(var n in curContext)if(typeof curContext[n]==="function")wrapFunction(this,n);else wrapProperty(this,n)}function replaceContext(){if(isContextReplaced)return;p.loadPixels();if(proxyContext===null){originalContext=curContext;proxyContext=new SetPixelContextWrapper}isContextReplaced=true;curContext=proxyContext;setPixelsCached=0}function set$3(x,y,c){if(x<p.width&&x>=0&&y>=0&&y<p.height){replaceContext();p.pixels.setPixel((0|x)+p.width*(0|y),c);if(++setPixelsCached>maxPixelsCached)resetContext()}}function set$4(x,y,obj,img){if(img.isRemote)throw"Image is loaded remotely. Cannot set x,y.";var c=p.color.toArray(obj);var offset=y*img.width*4+x*4;var data=img.imageData.data;data[offset]=c[0];data[offset+1]=c[1];data[offset+2]=c[2];data[offset+3]=c[3]}p.set=function(x,y,obj,img){var color,oldFill;if(arguments.length===3)if(typeof obj==="number")set$3(x,y,obj);else{if(obj instanceof PImage||obj.__isPImage)p.image(obj,x,y)}else if(arguments.length===4)set$4(x,y,obj,img)};p.imageData={};p.pixels={getLength:function(){return p.imageData.data.length?p.imageData.data.length/4:0},getPixel:function(i){var offset=i*4,data=p.imageData.data;return data[offset+3]<<24&4278190080|data[offset+0]<<16&16711680|data[offset+1]<<8&65280|data[offset+2]&255},setPixel:function(i,c){var offset=i*4,data=p.imageData.data;data[offset+0]=(c&16711680)>>>16;data[offset+1]=(c&65280)>>>8;data[offset+2]=c&255;data[offset+3]=(c&4278190080)>>>24},toArray:function(){var arr=[],length=p.imageData.width*p.imageData.height,data=p.imageData.data;for(var i=0,offset=0;i<length;i++,offset+=4)arr.push(data[offset+3]<<24&4278190080|data[offset+0]<<16&16711680|data[offset+1]<<8&65280|data[offset+2]&255);return arr},set:function(arr){for(var i=0,aL=arr.length;i<aL;i++)this.setPixel(i,arr[i])}};p.loadPixels=function(){p.imageData=drawing.$ensureContext().getImageData(0,0,p.width,p.height)};p.updatePixels=function(){if(p.imageData)drawing.$ensureContext().putImageData(p.imageData,0,0)};p.hint=function(which){var curContext=drawing.$ensureContext();if(which===4){curContext.disable(curContext.DEPTH_TEST);curContext.depthMask(false);curContext.clear(curContext.DEPTH_BUFFER_BIT)}else if(which===-4){curContext.enable(curContext.DEPTH_TEST);curContext.depthMask(true)}else if(which===-1||which===2)renderSmooth=true;else if(which===1)renderSmooth=false};var backgroundHelper=function(arg1,arg2,arg3,arg4){var obj;if(arg1 instanceof PImage||arg1.__isPImage){obj=arg1;if(!obj.loaded)throw"Error using image in background(): PImage not loaded.";if(obj.width!==p.width||obj.height!==p.height)throw"Background image must be the same dimensions as the canvas."}else obj=p.color(arg1,arg2,arg3,arg4);backgroundObj=obj};Drawing2D.prototype.background=function(arg1,arg2,arg3,arg4){if(arg1!==undef)backgroundHelper(arg1,arg2,arg3,arg4);if(backgroundObj instanceof PImage||backgroundObj.__isPImage){saveContext();curContext.setTransform(1,0,0,1,0,0);p.image(backgroundObj,0,0);restoreContext()}else{saveContext();curContext.setTransform(1,0,0,1,0,0);if(p.alpha(backgroundObj)!==colorModeA)curContext.clearRect(0,0,p.width,p.height);curContext.fillStyle=p.color.toString(backgroundObj);curContext.fillRect(0,0,p.width,p.height);isFillDirty=true;restoreContext()}};Drawing3D.prototype.background=function(arg1,arg2,arg3,arg4){if(arguments.length>0)backgroundHelper(arg1,arg2,arg3,arg4);var c=p.color.toGLArray(backgroundObj);curContext.clearColor(c[0],c[1],c[2],c[3]);curContext.clear(curContext.COLOR_BUFFER_BIT|curContext.DEPTH_BUFFER_BIT)};Drawing2D.prototype.image=function(img,x,y,w,h){x=Math.round(x);y=Math.round(y);if(img.width>0){var wid=w||img.width;var hgt=h||img.height;var bounds=imageModeConvert(x||0,y||0,w||img.width,h||img.height,arguments.length<4);var fastImage=!!img.sourceImg&&curTint===null;if(fastImage){var htmlElement=img.sourceImg;if(img.__isDirty)img.updatePixels();curContext.drawImage(htmlElement,0,0,htmlElement.width,htmlElement.height,bounds.x,bounds.y,bounds.w,bounds.h)}else{var obj=img.toImageData();if(curTint!==null){curTint(obj);img.__isDirty=true}curContext.drawImage(getCanvasData(obj).canvas,0,0,img.width,img.height,bounds.x,bounds.y,bounds.w,bounds.h)}}};Drawing3D.prototype.image=function(img,x,y,w,h){if(img.width>0){x=Math.round(x);y=Math.round(y);w=w||img.width;h=h||img.height;p.beginShape(p.QUADS);p.texture(img);p.vertex(x,y,0,0,0);p.vertex(x,y+h,0,0,h);p.vertex(x+w,y+h,0,w,h);p.vertex(x+w,y,0,w,0);p.endShape()}};p.tint=function(a1,a2,a3,a4){var tintColor=p.color(a1,a2,a3,a4);var r=p.red(tintColor)/colorModeX;var g=p.green(tintColor)/colorModeY;var b=p.blue(tintColor)/colorModeZ;var a=p.alpha(tintColor)/colorModeA;curTint=function(obj){var data=obj.data,length=4*obj.width*obj.height;for(var i=0;i<length;){data[i++]*=r;data[i++]*=g;data[i++]*=b;data[i++]*=a}};curTint3d=function(data){for(var i=0;i<data.length;){data[i++]=r;data[i++]=g;data[i++]=b;data[i++]=a}}};p.noTint=function(){curTint=null;curTint3d=null};p.copy=function(src,sx,sy,sw,sh,dx,dy,dw,dh){if(dh===undef){dh=dw;dw=dy;dy=dx;dx=sh;sh=sw;sw=sy;sy=sx;sx=src;src=p}p.blend(src,sx,sy,sw,sh,dx,dy,dw,dh,0)};p.blend=function(src,sx,sy,sw,sh,dx,dy,dw,dh,mode,pimgdest){if(src.isRemote)throw"Image is loaded remotely. Cannot blend image.";if(mode===undef){mode=dh;dh=dw;dw=dy;dy=dx;dx=sh;sh=sw;sw=sy;sy=sx;sx=src;src=p}var sx2=sx+sw,sy2=sy+sh,dx2=dx+dw,dy2=dy+dh,dest=pimgdest||p;if(pimgdest===undef||mode===undef)p.loadPixels();src.loadPixels();if(src===p&&p.intersect(sx,sy,sx2,sy2,dx,dy,dx2,dy2))p.blit_resize(p.get(sx,sy,sx2-sx,sy2-sy),0,0,sx2-sx-1,sy2-sy-1,dest.imageData.data,dest.width,dest.height,dx,dy,dx2,dy2,mode);else p.blit_resize(src,sx,sy,sx2,sy2,dest.imageData.data,dest.width,dest.height,dx,dy,dx2,dy2,mode);if(pimgdest===undef)p.updatePixels()};var buildBlurKernel=function(r){var radius=p.floor(r*3.5),i,radiusi;radius=radius<1?1:radius<248?radius:248;if(p.shared.blurRadius!==radius){p.shared.blurRadius=radius;p.shared.blurKernelSize=1+(p.shared.blurRadius<<1);p.shared.blurKernel=new Float32Array(p.shared.blurKernelSize);var sharedBlurKernal=p.shared.blurKernel;var sharedBlurKernelSize=p.shared.blurKernelSize;var sharedBlurRadius=p.shared.blurRadius;for(i=0;i<sharedBlurKernelSize;i++)sharedBlurKernal[i]=0;var radiusiSquared=(radius-1)*(radius-1);for(i=1;i<radius;i++)sharedBlurKernal[radius+i]=sharedBlurKernal[radiusi]=radiusiSquared;sharedBlurKernal[radius]=radius*radius}};var blurARGB=function(r,aImg){var sum,cr,cg,cb,ca,c,m;var read,ri,ym,ymi,bk0;var wh=aImg.pixels.getLength();var r2=new Float32Array(wh);var g2=new Float32Array(wh);var b2=new Float32Array(wh);var a2=new Float32Array(wh);var yi=0;var x,y,i,offset;buildBlurKernel(r);var aImgHeight=aImg.height;var aImgWidth=aImg.width;var sharedBlurKernelSize=p.shared.blurKernelSize;var sharedBlurRadius=p.shared.blurRadius;var sharedBlurKernal=p.shared.blurKernel;var pix=aImg.imageData.data;for(y=0;y<aImgHeight;y++){for(x=0;x<aImgWidth;x++){cb=cg=cr=ca=sum=0;read=x-sharedBlurRadius;if(read<0){bk0=-read;read=0}else{if(read>=aImgWidth)break;bk0=0}for(i=bk0;i<sharedBlurKernelSize;i++){if(read>=aImgWidth)break;offset=(read+yi)*4;m=sharedBlurKernal[i];ca+=m*pix[offset+3];cr+=m*pix[offset];cg+=m*pix[offset+1];cb+=m*pix[offset+2];sum+=m;read++}ri=yi+x;a2[ri]=ca/sum;r2[ri]=cr/sum;g2[ri]=cg/sum;b2[ri]=cb/sum}yi+=aImgWidth}yi=0;ym=-sharedBlurRadius;ymi=ym*aImgWidth;for(y=0;y<aImgHeight;y++){for(x=0;x<aImgWidth;x++){cb=cg=cr=ca=sum=0;if(ym<0){bk0=ri=-ym;read=x}else{if(ym>=aImgHeight)break;bk0=0;ri=ym;read=x+ymi}for(i=bk0;i<sharedBlurKernelSize;i++){if(ri>=aImgHeight)break;m=sharedBlurKernal[i];ca+=m*a2[read];cr+=m*r2[read];cg+=m*g2[read];cb+=m*b2[read];sum+=m;ri++;read+=aImgWidth}offset=(x+yi)*4;pix[offset]=cr/sum;pix[offset+1]=cg/sum;pix[offset+2]=cb/sum;pix[offset+3]=ca/sum}yi+=aImgWidth;ymi+=aImgWidth;ym++}};var dilate=function(isInverted,aImg){var currIdx=0;var maxIdx=aImg.pixels.getLength();var out=new Int32Array(maxIdx);var currRowIdx,maxRowIdx,colOrig,colOut,currLum;var idxRight,idxLeft,idxUp,idxDown,colRight,colLeft,colUp,colDown,lumRight,lumLeft,lumUp,lumDown;if(!isInverted)while(currIdx<maxIdx){currRowIdx=currIdx;maxRowIdx=currIdx+aImg.width;while(currIdx<maxRowIdx){colOrig=colOut=aImg.pixels.getPixel(currIdx);idxLeft=currIdx-1;idxRight=currIdx+1;idxUp=currIdx-aImg.width;idxDown=currIdx+aImg.width;if(idxLeft<currRowIdx)idxLeft=currIdx;if(idxRight>=maxRowIdx)idxRight=currIdx;if(idxUp<0)idxUp=0;if(idxDown>=maxIdx)idxDown=currIdx;colUp=aImg.pixels.getPixel(idxUp);colLeft=aImg.pixels.getPixel(idxLeft);colDown=aImg.pixels.getPixel(idxDown);colRight=aImg.pixels.getPixel(idxRight);currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(colOrig&255);lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(colLeft&255);lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(colRight&255);lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(colUp&255);lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(colDown&255);if(lumLeft>currLum){colOut=colLeft;currLum=lumLeft}if(lumRight>currLum){colOut=colRight;currLum=lumRight}if(lumUp>currLum){colOut=colUp;currLum=lumUp}if(lumDown>currLum){colOut=colDown;currLum=lumDown}out[currIdx++]=colOut}}else while(currIdx<maxIdx){currRowIdx=currIdx;maxRowIdx=currIdx+aImg.width;while(currIdx<maxRowIdx){colOrig=colOut=aImg.pixels.getPixel(currIdx);idxLeft=currIdx-1;idxRight=currIdx+1;idxUp=currIdx-aImg.width;idxDown=currIdx+aImg.width;if(idxLeft<currRowIdx)idxLeft=currIdx;if(idxRight>=maxRowIdx)idxRight=currIdx;if(idxUp<0)idxUp=0;if(idxDown>=maxIdx)idxDown=currIdx;colUp=aImg.pixels.getPixel(idxUp);colLeft=aImg.pixels.getPixel(idxLeft);colDown=aImg.pixels.getPixel(idxDown);colRight=aImg.pixels.getPixel(idxRight);currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(colOrig&255);lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(colLeft&255);lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(colRight&255);lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(colUp&255);lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(colDown&255);if(lumLeft<currLum){colOut=colLeft;currLum=lumLeft}if(lumRight<currLum){colOut=colRight;currLum=lumRight}if(lumUp<currLum){colOut=colUp;currLum=lumUp}if(lumDown<currLum){colOut=colDown;currLum=lumDown}out[currIdx++]=colOut}}aImg.pixels.set(out)};p.filter=function(kind,param,aImg){var img,col,lum,i;if(arguments.length===3){aImg.loadPixels();img=aImg}else{p.loadPixels();img=p}if(param===undef)param=null;if(img.isRemote)throw"Image is loaded remotely. Cannot filter image.";var imglen=img.pixels.getLength();switch(kind){case 11:var radius=param||1;blurARGB(radius,img);break;case 12:if(img.format===4){for(i=0;i<imglen;i++){col=255-img.pixels.getPixel(i);img.pixels.setPixel(i,4278190080|col<<16|col<<8|col)}img.format=1}else for(i=0;i<imglen;i++){col=img.pixels.getPixel(i);lum=77*(col>>16&255)+151*(col>>8&255)+28*(col&255)>>8;img.pixels.setPixel(i,col&4278190080|lum<<16|lum<<8|lum)}break;case 13:for(i=0;i<imglen;i++)img.pixels.setPixel(i,img.pixels.getPixel(i)^16777215);break;case 15:if(param===null)throw"Use filter(POSTERIZE, int levels) instead of filter(POSTERIZE)";var levels=p.floor(param);if(levels<2||levels>255)throw"Levels must be between 2 and 255 for filter(POSTERIZE, levels)";var levels1=levels-1;for(i=0;i<imglen;i++){var rlevel=img.pixels.getPixel(i)>>16&255;var glevel=img.pixels.getPixel(i)>>8&255;var blevel=img.pixels.getPixel(i)&255;rlevel=(rlevel*levels>>8)*255/levels1;glevel=(glevel*levels>>8)*255/levels1;blevel=(blevel*levels>>8)*255/levels1;img.pixels.setPixel(i,4278190080&img.pixels.getPixel(i)|rlevel<<16|glevel<<8|blevel)}break;case 14:for(i=0;i<imglen;i++)img.pixels.setPixel(i,img.pixels.getPixel(i)|4278190080);img.format=1;break;case 16:if(param===null)param=.5;if(param<0||param>1)throw"Level must be between 0 and 1 for filter(THRESHOLD, level)";var thresh=p.floor(param*255);for(i=0;i<imglen;i++){var max=p.max((img.pixels.getPixel(i)&16711680)>>16,p.max((img.pixels.getPixel(i)&65280)>>8,img.pixels.getPixel(i)&255));img.pixels.setPixel(i,img.pixels.getPixel(i)&4278190080|(max<thresh?0:16777215))}break;case 17:dilate(true,img);break;case 18:dilate(false,img);break}img.updatePixels()};p.shared={fracU:0,ifU:0,fracV:0,ifV:0,u1:0,u2:0,v1:0,v2:0,sX:0,sY:0,iw:0,iw1:0,ih1:0,ul:0,ll:0,ur:0,lr:0,cUL:0,cLL:0,cUR:0,cLR:0,srcXOffset:0,srcYOffset:0,r:0,g:0,b:0,a:0,srcBuffer:null,blurRadius:0,blurKernelSize:0,blurKernel:null};p.intersect=function(sx1,sy1,sx2,sy2,dx1,dy1,dx2,dy2){var sw=sx2-sx1+1;var sh=sy2-sy1+1;var dw=dx2-dx1+1;var dh=dy2-dy1+1;if(dx1<sx1){dw+=dx1-sx1;if(dw>sw)dw=sw}else{var w=sw+sx1-dx1;if(dw>w)dw=w}if(dy1<sy1){dh+=dy1-sy1;if(dh>sh)dh=sh}else{var h=sh+sy1-dy1;if(dh>h)dh=h}return!(dw<=0||dh<=0)};var blendFuncs={};blendFuncs[1]=p.modes.blend;blendFuncs[2]=p.modes.add;blendFuncs[4]=p.modes.subtract;blendFuncs[8]=p.modes.lightest;blendFuncs[16]=p.modes.darkest;blendFuncs[0]=p.modes.replace;blendFuncs[32]=p.modes.difference;blendFuncs[64]=p.modes.exclusion;blendFuncs[128]=p.modes.multiply;blendFuncs[256]=p.modes.screen;blendFuncs[512]=p.modes.overlay;blendFuncs[1024]=p.modes.hard_light;blendFuncs[2048]=p.modes.soft_light;blendFuncs[4096]=p.modes.dodge;blendFuncs[8192]=p.modes.burn;p.blit_resize=function(img,srcX1,srcY1,srcX2,srcY2,destPixels,screenW,screenH,destX1,destY1,destX2,destY2,mode){var x,y;if(srcX1<0)srcX1=0;if(srcY1<0)srcY1=0;if(srcX2>=img.width)srcX2=img.width-1;if(srcY2>=img.height)srcY2=img.height-1;var srcW=srcX2-srcX1;var srcH=srcY2-srcY1;var destW=destX2-destX1;var destH=destY2-destY1;if(destW<=0||destH<=0||srcW<=0||srcH<=0||destX1>=screenW||destY1>=screenH||srcX1>=img.width||srcY1>=img.height)return;var dx=Math.floor(srcW/destW*32768);var dy=Math.floor(srcH/destH*32768);var pshared=p.shared;pshared.srcXOffset=Math.floor(destX1<0?-destX1*dx:srcX1*32768);pshared.srcYOffset=Math.floor(destY1<0?-destY1*dy:srcY1*32768);if(destX1<0){destW+=destX1;destX1=0}if(destY1<0){destH+=destY1;destY1=0}destW=Math.min(destW,screenW-destX1);destH=Math.min(destH,screenH-destY1);var destOffset=destY1*screenW+destX1;var destColor;pshared.srcBuffer=img.imageData.data;pshared.iw=img.width;pshared.iw1=img.width-1;pshared.ih1=img.height-1;var filterBilinear=p.filter_bilinear,filterNewScanline=p.filter_new_scanline,blendFunc=blendFuncs[mode],blendedColor,idx,cULoffset,cURoffset,cLLoffset,cLRoffset,ALPHA_MASK=4278190080,RED_MASK=16711680,GREEN_MASK=65280,BLUE_MASK=255,PREC_MAXVAL=32767,PRECISIONB=15,PREC_RED_SHIFT=1,PREC_ALPHA_SHIFT=9,srcBuffer=pshared.srcBuffer,min=Math.min;
for(y=0;y<destH;y++){pshared.sX=pshared.srcXOffset;pshared.fracV=pshared.srcYOffset&PREC_MAXVAL;pshared.ifV=PREC_MAXVAL-pshared.fracV;pshared.v1=(pshared.srcYOffset>>PRECISIONB)*pshared.iw;pshared.v2=min((pshared.srcYOffset>>PRECISIONB)+1,pshared.ih1)*pshared.iw;for(x=0;x<destW;x++){idx=(destOffset+x)*4;destColor=destPixels[idx+3]<<24&ALPHA_MASK|destPixels[idx]<<16&RED_MASK|destPixels[idx+1]<<8&GREEN_MASK|destPixels[idx+2]&BLUE_MASK;pshared.fracU=pshared.sX&PREC_MAXVAL;pshared.ifU=PREC_MAXVAL-pshared.fracU;pshared.ul=pshared.ifU*pshared.ifV>>PRECISIONB;pshared.ll=pshared.ifU*pshared.fracV>>PRECISIONB;pshared.ur=pshared.fracU*pshared.ifV>>PRECISIONB;pshared.lr=pshared.fracU*pshared.fracV>>PRECISIONB;pshared.u1=pshared.sX>>PRECISIONB;pshared.u2=min(pshared.u1+1,pshared.iw1);cULoffset=(pshared.v1+pshared.u1)*4;cURoffset=(pshared.v1+pshared.u2)*4;cLLoffset=(pshared.v2+pshared.u1)*4;cLRoffset=(pshared.v2+pshared.u2)*4;pshared.cUL=srcBuffer[cULoffset+3]<<24&ALPHA_MASK|srcBuffer[cULoffset]<<16&RED_MASK|srcBuffer[cULoffset+1]<<8&GREEN_MASK|srcBuffer[cULoffset+2]&BLUE_MASK;pshared.cUR=srcBuffer[cURoffset+3]<<24&ALPHA_MASK|srcBuffer[cURoffset]<<16&RED_MASK|srcBuffer[cURoffset+1]<<8&GREEN_MASK|srcBuffer[cURoffset+2]&BLUE_MASK;pshared.cLL=srcBuffer[cLLoffset+3]<<24&ALPHA_MASK|srcBuffer[cLLoffset]<<16&RED_MASK|srcBuffer[cLLoffset+1]<<8&GREEN_MASK|srcBuffer[cLLoffset+2]&BLUE_MASK;pshared.cLR=srcBuffer[cLRoffset+3]<<24&ALPHA_MASK|srcBuffer[cLRoffset]<<16&RED_MASK|srcBuffer[cLRoffset+1]<<8&GREEN_MASK|srcBuffer[cLRoffset+2]&BLUE_MASK;pshared.r=pshared.ul*((pshared.cUL&RED_MASK)>>16)+pshared.ll*((pshared.cLL&RED_MASK)>>16)+pshared.ur*((pshared.cUR&RED_MASK)>>16)+pshared.lr*((pshared.cLR&RED_MASK)>>16)<<PREC_RED_SHIFT&RED_MASK;pshared.g=pshared.ul*(pshared.cUL&GREEN_MASK)+pshared.ll*(pshared.cLL&GREEN_MASK)+pshared.ur*(pshared.cUR&GREEN_MASK)+pshared.lr*(pshared.cLR&GREEN_MASK)>>>PRECISIONB&GREEN_MASK;pshared.b=pshared.ul*(pshared.cUL&BLUE_MASK)+pshared.ll*(pshared.cLL&BLUE_MASK)+pshared.ur*(pshared.cUR&BLUE_MASK)+pshared.lr*(pshared.cLR&BLUE_MASK)>>>PRECISIONB;pshared.a=pshared.ul*((pshared.cUL&ALPHA_MASK)>>>24)+pshared.ll*((pshared.cLL&ALPHA_MASK)>>>24)+pshared.ur*((pshared.cUR&ALPHA_MASK)>>>24)+pshared.lr*((pshared.cLR&ALPHA_MASK)>>>24)<<PREC_ALPHA_SHIFT&ALPHA_MASK;blendedColor=blendFunc(destColor,pshared.a|pshared.r|pshared.g|pshared.b);destPixels[idx]=(blendedColor&RED_MASK)>>>16;destPixels[idx+1]=(blendedColor&GREEN_MASK)>>>8;destPixels[idx+2]=blendedColor&BLUE_MASK;destPixels[idx+3]=(blendedColor&ALPHA_MASK)>>>24;pshared.sX+=dx}destOffset+=screenW;pshared.srcYOffset+=dy}};p.loadFont=function(name,size){if(name===undef)throw"font name required in loadFont.";if(name.indexOf(".svg")===-1){if(size===undef)size=curTextFont.size;return PFont.get(name,size)}var font=p.loadGlyphs(name);return{name:name,css:"12px sans-serif",glyph:true,units_per_em:font.units_per_em,horiz_adv_x:1/font.units_per_em*font.horiz_adv_x,ascent:font.ascent,descent:font.descent,width:function(str){var width=0;var len=str.length;for(var i=0;i<len;i++)try{width+=parseFloat(p.glyphLook(p.glyphTable[name],str[i]).horiz_adv_x)}catch(e){Processing.debug(e)}return width/p.glyphTable[name].units_per_em}}};p.createFont=function(name,size){return p.loadFont(name,size)};p.textFont=function(pfont,size){if(size!==undef){if(!pfont.glyph)pfont=PFont.get(pfont.name,size);curTextSize=size}curTextFont=pfont;curFontName=curTextFont.name;curTextAscent=curTextFont.ascent;curTextDescent=curTextFont.descent;curTextLeading=curTextFont.leading;var curContext=drawing.$ensureContext();curContext.font=curTextFont.css};p.textSize=function(size){curTextFont=PFont.get(curFontName,size);curTextSize=size;curTextAscent=curTextFont.ascent;curTextDescent=curTextFont.descent;curTextLeading=curTextFont.leading;var curContext=drawing.$ensureContext();curContext.font=curTextFont.css};p.textAscent=function(){return curTextAscent};p.textDescent=function(){return curTextDescent};p.textLeading=function(leading){curTextLeading=leading};p.textAlign=function(xalign,yalign){horizontalTextAlignment=xalign;verticalTextAlignment=yalign||0};function toP5String(obj){if(obj instanceof String)return obj;if(typeof obj==="number"){if(obj===(0|obj))return obj.toString();return p.nf(obj,0,3)}if(obj===null||obj===undef)return"";return obj.toString()}Drawing2D.prototype.textWidth=function(str){var lines=toP5String(str).split(/\r?\n/g),width=0;var i,linesCount=lines.length;curContext.font=curTextFont.css;for(i=0;i<linesCount;++i)width=Math.max(width,curTextFont.measureTextWidth(lines[i]));return width|0};Drawing3D.prototype.textWidth=function(str){var lines=toP5String(str).split(/\r?\n/g),width=0;var i,linesCount=lines.length;if(textcanvas===undef)textcanvas=document.createElement("canvas");var textContext=textcanvas.getContext("2d");textContext.font=curTextFont.css;for(i=0;i<linesCount;++i)width=Math.max(width,textContext.measureText(lines[i]).width);return width|0};p.glyphLook=function(font,chr){try{switch(chr){case"1":return font.one;case"2":return font.two;case"3":return font.three;case"4":return font.four;case"5":return font.five;case"6":return font.six;case"7":return font.seven;case"8":return font.eight;case"9":return font.nine;case"0":return font.zero;case" ":return font.space;case"$":return font.dollar;case"!":return font.exclam;case'"':return font.quotedbl;case"#":return font.numbersign;case"%":return font.percent;case"&":return font.ampersand;case"'":return font.quotesingle;case"(":return font.parenleft;case")":return font.parenright;case"*":return font.asterisk;case"+":return font.plus;case",":return font.comma;case"-":return font.hyphen;case".":return font.period;case"/":return font.slash;case"_":return font.underscore;case":":return font.colon;case";":return font.semicolon;case"<":return font.less;case"=":return font.equal;case">":return font.greater;case"?":return font.question;case"@":return font.at;case"[":return font.bracketleft;case"\\":return font.backslash;case"]":return font.bracketright;case"^":return font.asciicircum;case"`":return font.grave;case"{":return font.braceleft;case"|":return font.bar;case"}":return font.braceright;case"~":return font.asciitilde;default:return font[chr]}}catch(e){Processing.debug(e)}};Drawing2D.prototype.text$line=function(str,x,y,z,align){var textWidth=0,xOffset=0;if(!curTextFont.glyph){if(str&&"fillText"in curContext){if(isFillDirty){curContext.fillStyle=p.color.toString(currentFillColor);isFillDirty=false}if(align===39||align===3){textWidth=curTextFont.measureTextWidth(str);if(align===39)xOffset=-textWidth;else xOffset=-textWidth/2}curContext.fillText(str,x+xOffset,y)}}else{var font=p.glyphTable[curFontName];saveContext();curContext.translate(x,y+curTextSize);if(align===39||align===3){textWidth=font.width(str);if(align===39)xOffset=-textWidth;else xOffset=-textWidth/2}var upem=font.units_per_em,newScale=1/upem*curTextSize;curContext.scale(newScale,newScale);for(var i=0,len=str.length;i<len;i++)try{p.glyphLook(font,str[i]).draw()}catch(e){Processing.debug(e)}restoreContext()}};Drawing3D.prototype.text$line=function(str,x,y,z,align){if(textcanvas===undef)textcanvas=document.createElement("canvas");var oldContext=curContext;curContext=textcanvas.getContext("2d");curContext.font=curTextFont.css;var textWidth=curTextFont.measureTextWidth(str);textcanvas.width=textWidth;textcanvas.height=curTextSize;curContext=textcanvas.getContext("2d");curContext.font=curTextFont.css;curContext.textBaseline="top";Drawing2D.prototype.text$line(str,0,0,0,37);var aspect=textcanvas.width/textcanvas.height;curContext=oldContext;curContext.bindTexture(curContext.TEXTURE_2D,textTex);curContext.texImage2D(curContext.TEXTURE_2D,0,curContext.RGBA,curContext.RGBA,curContext.UNSIGNED_BYTE,textcanvas);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MAG_FILTER,curContext.LINEAR);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_MIN_FILTER,curContext.LINEAR);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_T,curContext.CLAMP_TO_EDGE);curContext.texParameteri(curContext.TEXTURE_2D,curContext.TEXTURE_WRAP_S,curContext.CLAMP_TO_EDGE);var xOffset=0;if(align===39)xOffset=-textWidth;else if(align===3)xOffset=-textWidth/2;var model=new PMatrix3D;var scalefactor=curTextSize*.5;model.translate(x+xOffset-scalefactor/2,y-scalefactor,z);model.scale(-aspect*scalefactor,-scalefactor,scalefactor);model.translate(-1,-1,-1);model.transpose();var view=new PMatrix3D;view.scale(1,-1,1);view.apply(modelView.array());view.transpose();curContext.useProgram(programObject2D);vertexAttribPointer("aVertex2d",programObject2D,"aVertex",3,textBuffer);vertexAttribPointer("aTextureCoord2d",programObject2D,"aTextureCoord",2,textureBuffer);uniformi("uSampler2d",programObject2D,"uSampler",[0]);uniformi("uIsDrawingText2d",programObject2D,"uIsDrawingText",true);uniformMatrix("uModel2d",programObject2D,"uModel",false,model.array());uniformMatrix("uView2d",programObject2D,"uView",false,view.array());uniformf("uColor2d",programObject2D,"uColor",fillStyle);curContext.bindBuffer(curContext.ELEMENT_ARRAY_BUFFER,indexBuffer);curContext.drawElements(curContext.TRIANGLES,6,curContext.UNSIGNED_SHORT,0)};function text$4(str,x,y,z){var lines,linesCount;if(str.indexOf("\n")<0){lines=[str];linesCount=1}else{lines=str.split(/\r?\n/g);linesCount=lines.length}var yOffset=0;if(verticalTextAlignment===101)yOffset=curTextAscent+curTextDescent;else if(verticalTextAlignment===3)yOffset=curTextAscent/2-(linesCount-1)*curTextLeading/2;else if(verticalTextAlignment===102)yOffset=-(curTextDescent+(linesCount-1)*curTextLeading);for(var i=0;i<linesCount;++i){var line=lines[i];drawing.text$line(line,x,y+yOffset,z,horizontalTextAlignment);yOffset+=curTextLeading}}function text$6(str,x,y,width,height,z){if(str.length===0||width===0||height===0)return;if(curTextSize>height)return;var spaceMark=-1;var start=0;var lineWidth=0;var drawCommands=[];for(var charPos=0,len=str.length;charPos<len;charPos++){var currentChar=str[charPos];var spaceChar=currentChar===" ";var letterWidth=curTextFont.measureTextWidth(currentChar);if(currentChar!=="\n"&&lineWidth+letterWidth<=width){if(spaceChar)spaceMark=charPos;lineWidth+=letterWidth}else{if(spaceMark+1===start)if(charPos>0)spaceMark=charPos;else return;if(currentChar==="\n"){drawCommands.push({text:str.substring(start,charPos),width:lineWidth});start=charPos+1}else{drawCommands.push({text:str.substring(start,spaceMark+1),width:lineWidth});start=spaceMark+1}lineWidth=0;charPos=start-1}}if(start<len)drawCommands.push({text:str.substring(start),width:lineWidth});var xOffset=1,yOffset=curTextAscent;if(horizontalTextAlignment===3)xOffset=width/2;else if(horizontalTextAlignment===39)xOffset=width;var linesCount=drawCommands.length,visibleLines=Math.min(linesCount,Math.floor(height/curTextLeading));if(verticalTextAlignment===101)yOffset=curTextAscent+curTextDescent;else if(verticalTextAlignment===3)yOffset=height/2-curTextLeading*(visibleLines/2-1);else if(verticalTextAlignment===102)yOffset=curTextDescent+curTextLeading;var command,drawCommand,leading;for(command=0;command<linesCount;command++){leading=command*curTextLeading;if(yOffset+leading>height-curTextDescent)break;drawCommand=drawCommands[command];drawing.text$line(drawCommand.text,x+xOffset,y+yOffset+leading,z,horizontalTextAlignment)}}p.text=function(){if(textMode===5)return;if(arguments.length===3)text$4(toP5String(arguments[0]),arguments[1],arguments[2],0);else if(arguments.length===4)text$4(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3]);else if(arguments.length===5)text$6(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],0);else if(arguments.length===6)text$6(toP5String(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};p.textMode=function(mode){textMode=mode};p.loadGlyphs=function(url){var x,y,cx,cy,nx,ny,d,a,lastCom,lenC,horiz_adv_x,getXY="[0-9\\-]+",path;var regex=function(needle,hay){var i=0,results=[],latest,regexp=new RegExp(needle,"g");latest=results[i]=regexp.exec(hay);while(latest){i++;latest=results[i]=regexp.exec(hay)}return results};var buildPath=function(d){var c=regex("[A-Za-z][0-9\\- ]+|Z",d);var beforePathDraw=function(){saveContext();return drawing.$ensureContext()};var afterPathDraw=function(){executeContextFill();executeContextStroke();restoreContext()};path="return {draw:function(){var curContext=beforePathDraw();curContext.beginPath();";x=0;y=0;cx=0;cy=0;nx=0;ny=0;d=0;a=0;lastCom="";lenC=c.length-1;for(var j=0;j<lenC;j++){var com=c[j][0],xy=regex(getXY,com);switch(com[0]){case"M":x=parseFloat(xy[0][0]);y=parseFloat(xy[1][0]);path+="curContext.moveTo("+x+","+-y+");";break;case"L":x=parseFloat(xy[0][0]);y=parseFloat(xy[1][0]);path+="curContext.lineTo("+x+","+-y+");";break;case"H":x=parseFloat(xy[0][0]);path+="curContext.lineTo("+x+","+-y+");";break;case"V":y=parseFloat(xy[0][0]);path+="curContext.lineTo("+x+","+-y+");";break;case"T":nx=parseFloat(xy[0][0]);ny=parseFloat(xy[1][0]);if(lastCom==="Q"||lastCom==="T"){d=Math.sqrt(Math.pow(x-cx,2)+Math.pow(cy-y,2));a=Math.PI+Math.atan2(cx-x,cy-y);cx=x+Math.sin(a)*d;cy=y+Math.cos(a)*d}else{cx=x;cy=y}path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");";x=nx;y=ny;break;case"Q":cx=parseFloat(xy[0][0]);cy=parseFloat(xy[1][0]);nx=parseFloat(xy[2][0]);ny=parseFloat(xy[3][0]);path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");";x=nx;y=ny;break;case"Z":path+="curContext.closePath();";break}lastCom=com[0]}path+="afterPathDraw();";path+="curContext.translate("+horiz_adv_x+",0);";path+="}}";return new Function("beforePathDraw","afterPathDraw",path)(beforePathDraw,afterPathDraw)};var parseSVGFont=function(svg){var font=svg.getElementsByTagName("font");p.glyphTable[url].horiz_adv_x=font[0].getAttribute("horiz-adv-x");var font_face=svg.getElementsByTagName("font-face")[0];p.glyphTable[url].units_per_em=parseFloat(font_face.getAttribute("units-per-em"));p.glyphTable[url].ascent=parseFloat(font_face.getAttribute("ascent"));p.glyphTable[url].descent=parseFloat(font_face.getAttribute("descent"));var glyph=svg.getElementsByTagName("glyph"),len=glyph.length;for(var i=0;i<len;i++){var unicode=glyph[i].getAttribute("unicode");var name=glyph[i].getAttribute("glyph-name");horiz_adv_x=glyph[i].getAttribute("horiz-adv-x");if(horiz_adv_x===null)horiz_adv_x=p.glyphTable[url].horiz_adv_x;d=glyph[i].getAttribute("d");if(d!==undef){path=buildPath(d);p.glyphTable[url][name]={name:name,unicode:unicode,horiz_adv_x:horiz_adv_x,draw:path.draw}}}};var loadXML=function(){var xmlDoc;try{xmlDoc=document.implementation.createDocument("","",null)}catch(e_fx_op){Processing.debug(e_fx_op.message);return}try{xmlDoc.async=false;xmlDoc.load(url);parseSVGFont(xmlDoc.getElementsByTagName("svg")[0])}catch(e_sf_ch){Processing.debug(e_sf_ch);try{var xmlhttp=new window.XMLHttpRequest;xmlhttp.open("GET",url,false);xmlhttp.send(null);parseSVGFont(xmlhttp.responseXML.documentElement)}catch(e){Processing.debug(e_sf_ch)}}};p.glyphTable[url]={};loadXML(url);return p.glyphTable[url]};p.param=function(name){var attributeName="data-processing-"+name;if(curElement.hasAttribute(attributeName))return curElement.getAttribute(attributeName);for(var i=0,len=curElement.childNodes.length;i<len;++i){var item=curElement.childNodes.item(i);if(item.nodeType!==1||item.tagName.toLowerCase()!=="param")continue;if(item.getAttribute("name")===name)return item.getAttribute("value")}if(curSketch.params.hasOwnProperty(name))return curSketch.params[name];return null};function wireDimensionalFunctions(mode){if(mode==="3D")drawing=new Drawing3D;else if(mode==="2D")drawing=new Drawing2D;else drawing=new DrawingPre;for(var i in DrawingPre.prototype)if(DrawingPre.prototype.hasOwnProperty(i)&&i.indexOf("$")<0)p[i]=drawing[i];drawing.$init()}function createDrawingPreFunction(name){return function(){wireDimensionalFunctions("2D");return drawing[name].apply(this,arguments)}}DrawingPre.prototype.translate=createDrawingPreFunction("translate");DrawingPre.prototype.transform=createDrawingPreFunction("transform");DrawingPre.prototype.scale=createDrawingPreFunction("scale");DrawingPre.prototype.pushMatrix=createDrawingPreFunction("pushMatrix");DrawingPre.prototype.popMatrix=createDrawingPreFunction("popMatrix");DrawingPre.prototype.resetMatrix=createDrawingPreFunction("resetMatrix");DrawingPre.prototype.applyMatrix=createDrawingPreFunction("applyMatrix");DrawingPre.prototype.rotate=createDrawingPreFunction("rotate");DrawingPre.prototype.rotateZ=createDrawingPreFunction("rotateZ");DrawingPre.prototype.shearX=createDrawingPreFunction("shearX");DrawingPre.prototype.shearY=createDrawingPreFunction("shearY");DrawingPre.prototype.redraw=createDrawingPreFunction("redraw");DrawingPre.prototype.toImageData=createDrawingPreFunction("toImageData");DrawingPre.prototype.ambientLight=createDrawingPreFunction("ambientLight");DrawingPre.prototype.directionalLight=createDrawingPreFunction("directionalLight");DrawingPre.prototype.lightFalloff=createDrawingPreFunction("lightFalloff");DrawingPre.prototype.lightSpecular=createDrawingPreFunction("lightSpecular");DrawingPre.prototype.pointLight=createDrawingPreFunction("pointLight");DrawingPre.prototype.noLights=createDrawingPreFunction("noLights");DrawingPre.prototype.spotLight=createDrawingPreFunction("spotLight");DrawingPre.prototype.beginCamera=createDrawingPreFunction("beginCamera");DrawingPre.prototype.endCamera=createDrawingPreFunction("endCamera");DrawingPre.prototype.frustum=createDrawingPreFunction("frustum");DrawingPre.prototype.box=createDrawingPreFunction("box");DrawingPre.prototype.sphere=createDrawingPreFunction("sphere");DrawingPre.prototype.ambient=createDrawingPreFunction("ambient");DrawingPre.prototype.emissive=createDrawingPreFunction("emissive");DrawingPre.prototype.shininess=createDrawingPreFunction("shininess");DrawingPre.prototype.specular=createDrawingPreFunction("specular");DrawingPre.prototype.fill=createDrawingPreFunction("fill");DrawingPre.prototype.stroke=createDrawingPreFunction("stroke");DrawingPre.prototype.strokeWeight=createDrawingPreFunction("strokeWeight");DrawingPre.prototype.smooth=createDrawingPreFunction("smooth");DrawingPre.prototype.noSmooth=createDrawingPreFunction("noSmooth");DrawingPre.prototype.point=createDrawingPreFunction("point");DrawingPre.prototype.vertex=createDrawingPreFunction("vertex");DrawingPre.prototype.endShape=createDrawingPreFunction("endShape");DrawingPre.prototype.bezierVertex=createDrawingPreFunction("bezierVertex");DrawingPre.prototype.curveVertex=createDrawingPreFunction("curveVertex");DrawingPre.prototype.curve=createDrawingPreFunction("curve");DrawingPre.prototype.line=createDrawingPreFunction("line");DrawingPre.prototype.bezier=createDrawingPreFunction("bezier");DrawingPre.prototype.rect=createDrawingPreFunction("rect");DrawingPre.prototype.ellipse=createDrawingPreFunction("ellipse");DrawingPre.prototype.background=createDrawingPreFunction("background");DrawingPre.prototype.image=createDrawingPreFunction("image");DrawingPre.prototype.textWidth=createDrawingPreFunction("textWidth");DrawingPre.prototype.text$line=createDrawingPreFunction("text$line");DrawingPre.prototype.$ensureContext=createDrawingPreFunction("$ensureContext");DrawingPre.prototype.$newPMatrix=createDrawingPreFunction("$newPMatrix");DrawingPre.prototype.size=function(aWidth,aHeight,aMode){wireDimensionalFunctions(aMode===2?"3D":"2D");p.size(aWidth,aHeight,aMode)};DrawingPre.prototype.$init=nop;Drawing2D.prototype.$init=function(){p.size(p.width,p.height);curContext.lineCap="round";p.noSmooth();p.disableContextMenu()};Drawing3D.prototype.$init=function(){p.use3DContext=true;p.disableContextMenu()};DrawingShared.prototype.$ensureContext=function(){return curContext};function calculateOffset(curElement,event){var element=curElement,offsetX=0,offsetY=0;p.pmouseX=p.mouseX;p.pmouseY=p.mouseY;if(element.offsetParent){do{offsetX+=element.offsetLeft;offsetY+=element.offsetTop}while(!!(element=element.offsetParent))}element=curElement;do{offsetX-=element.scrollLeft||0;offsetY-=element.scrollTop||0}while(!!(element=element.parentNode));offsetX+=stylePaddingLeft;offsetY+=stylePaddingTop;offsetX+=styleBorderLeft;offsetY+=styleBorderTop;offsetX+=window.pageXOffset;offsetY+=window.pageYOffset;return{X:offsetX,Y:offsetY}}function updateMousePosition(curElement,event){var offset=calculateOffset(curElement,event);p.mouseX=event.pageX-offset.X;p.mouseY=event.pageY-offset.Y}function addTouchEventOffset(t){var offset=calculateOffset(t.changedTouches[0].target,t.changedTouches[0]),i;for(i=0;i<t.touches.length;i++){var touch=t.touches[i];touch.offsetX=touch.pageX-offset.X;touch.offsetY=touch.pageY-offset.Y}for(i=0;i<t.targetTouches.length;i++){var targetTouch=t.targetTouches[i];targetTouch.offsetX=targetTouch.pageX-offset.X;targetTouch.offsetY=targetTouch.pageY-offset.Y}for(i=0;i<t.changedTouches.length;i++){var changedTouch=t.changedTouches[i];changedTouch.offsetX=changedTouch.pageX-offset.X;changedTouch.offsetY=changedTouch.pageY-offset.Y}return t}attachEventHandler(curElement,"touchstart",function(t){curElement.setAttribute("style","-webkit-user-select: none");curElement.setAttribute("onclick","void(0)");curElement.setAttribute("style","-webkit-tap-highlight-color:rgba(0,0,0,0)");for(var i=0,ehl=eventHandlers.length;i<ehl;i++){var type=eventHandlers[i].type;if(type==="mouseout"||type==="mousemove"||type==="mousedown"||type==="mouseup"||type==="DOMMouseScroll"||type==="mousewheel"||type==="touchstart")detachEventHandler(eventHandlers[i])}if(p.touchStart!==undef||p.touchMove!==undef||p.touchEnd!==undef||p.touchCancel!==undef){attachEventHandler(curElement,"touchstart",function(t){if(p.touchStart!==undef){t=addTouchEventOffset(t);p.touchStart(t)}});attachEventHandler(curElement,"touchmove",function(t){if(p.touchMove!==undef){t.preventDefault();t=addTouchEventOffset(t);p.touchMove(t)}});attachEventHandler(curElement,"touchend",function(t){if(p.touchEnd!==undef){t=addTouchEventOffset(t);p.touchEnd(t)}});attachEventHandler(curElement,"touchcancel",function(t){if(p.touchCancel!==undef){t=addTouchEventOffset(t);p.touchCancel(t)}})}else{attachEventHandler(curElement,"touchstart",function(e){updateMousePosition(curElement,e.touches[0]);p.__mousePressed=true;p.mouseDragging=false;p.mouseButton=37;if(typeof p.mousePressed==="function")p.mousePressed()});attachEventHandler(curElement,"touchmove",function(e){e.preventDefault();updateMousePosition(curElement,e.touches[0]);if(typeof p.mouseMoved==="function"&&!p.__mousePressed)p.mouseMoved();if(typeof p.mouseDragged==="function"&&p.__mousePressed){p.mouseDragged();p.mouseDragging=true}});attachEventHandler(curElement,"touchend",function(e){p.__mousePressed=false;if(typeof p.mouseClicked==="function"&&!p.mouseDragging)p.mouseClicked();if(typeof p.mouseReleased==="function")p.mouseReleased()})}curElement.dispatchEvent(t)});(function(){var enabled=true,contextMenu=function(e){e.preventDefault();e.stopPropagation()};p.disableContextMenu=function(){if(!enabled)return;attachEventHandler(curElement,"contextmenu",contextMenu);enabled=false};p.enableContextMenu=function(){if(enabled)return;detachEventHandler({elem:curElement,type:"contextmenu",fn:contextMenu});enabled=true}})();attachEventHandler(curElement,"mousemove",function(e){updateMousePosition(curElement,e);if(typeof p.mouseMoved==="function"&&!p.__mousePressed)p.mouseMoved();if(typeof p.mouseDragged==="function"&&p.__mousePressed){p.mouseDragged();p.mouseDragging=true}});attachEventHandler(curElement,"mouseout",function(e){if(typeof p.mouseOut==="function")p.mouseOut()});attachEventHandler(curElement,"mouseover",function(e){updateMousePosition(curElement,e);if(typeof p.mouseOver==="function")p.mouseOver()});curElement.onmousedown=function(){curElement.focus();return false};attachEventHandler(curElement,"mousedown",function(e){p.__mousePressed=true;p.mouseDragging=false;switch(e.which){case 1:p.mouseButton=37;break;case 2:p.mouseButton=3;break;case 3:p.mouseButton=39;break}if(typeof p.mousePressed==="function")p.mousePressed()});attachEventHandler(curElement,"mouseup",function(e){p.__mousePressed=false;if(typeof p.mouseClicked==="function"&&!p.mouseDragging)p.mouseClicked();if(typeof p.mouseReleased==="function")p.mouseReleased()});var mouseWheelHandler=function(e){var delta=0;if(e.wheelDelta){delta=e.wheelDelta/120;if(window.opera)delta=-delta}else if(e.detail)delta=-e.detail/3;p.mouseScroll=delta;if(delta&&typeof p.mouseScrolled==="function")p.mouseScrolled()};attachEventHandler(document,"DOMMouseScroll",mouseWheelHandler);attachEventHandler(document,"mousewheel",mouseWheelHandler);if(!curElement.getAttribute("tabindex"))curElement.setAttribute("tabindex",0);function getKeyCode(e){var code=e.which||e.keyCode;switch(code){case 13:return 10;case 91:case 93:case 224:return 157;case 57392:return 17;case 46:return 127;case 45:return 155}return code}function getKeyChar(e){var c=e.which||e.keyCode;var anyShiftPressed=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;switch(c){case 13:c=anyShiftPressed?13:10;break;case 8:c=anyShiftPressed?127:8;break}return new Char(c)}function suppressKeyEvent(e){if(typeof e.preventDefault==="function")e.preventDefault();else if(typeof e.stopPropagation==="function")e.stopPropagation();return false}function updateKeyPressed(){var ch;for(ch in pressedKeysMap)if(pressedKeysMap.hasOwnProperty(ch)){p.__keyPressed=true;return}p.__keyPressed=false}function resetKeyPressed(){p.__keyPressed=false;pressedKeysMap=[];lastPressedKeyCode=null}function simulateKeyTyped(code,c){pressedKeysMap[code]=c;lastPressedKeyCode=null;p.key=c;p.keyCode=code;p.keyPressed();p.keyCode=0;p.keyTyped();updateKeyPressed()}function handleKeydown(e){var code=getKeyCode(e);if(code===127){simulateKeyTyped(code,new Char(127));return}if(codedKeys.indexOf(code)<0){lastPressedKeyCode=code;return}var c=new Char(65535);p.key=c;p.keyCode=code;pressedKeysMap[code]=c;p.keyPressed();lastPressedKeyCode=null;updateKeyPressed();return suppressKeyEvent(e)}function handleKeypress(e){if(lastPressedKeyCode===null)return;var code=lastPressedKeyCode,c=getKeyChar(e);simulateKeyTyped(code,c);return suppressKeyEvent(e)}function handleKeyup(e){var code=getKeyCode(e),c=pressedKeysMap[code];if(c===undef)return;p.key=c;p.keyCode=code;p.keyReleased();delete pressedKeysMap[code];updateKeyPressed()}if(!pgraphicsMode){if(aCode instanceof Processing.Sketch)curSketch=aCode;else if(typeof aCode==="function")curSketch=new Processing.Sketch(aCode);else if(!aCode)curSketch=new Processing.Sketch(function(){});else curSketch=Processing.compile(aCode);p.externals.sketch=curSketch;wireDimensionalFunctions();curElement.onfocus=function(){p.focused=true};curElement.onblur=function(){p.focused=false;if(!curSketch.options.globalKeyEvents)resetKeyPressed()};if(curSketch.options.pauseOnBlur){attachEventHandler(window,"focus",function(){if(doLoop)p.loop()});attachEventHandler(window,"blur",function(){if(doLoop&&loopStarted){p.noLoop();doLoop=true}resetKeyPressed()})}var keyTrigger=curSketch.options.globalKeyEvents?window:curElement;attachEventHandler(keyTrigger,"keydown",handleKeydown);attachEventHandler(keyTrigger,"keypress",handleKeypress);attachEventHandler(keyTrigger,"keyup",handleKeyup);for(var i in Processing.lib)if(Processing.lib.hasOwnProperty(i))if(Processing.lib[i].hasOwnProperty("attach"))Processing.lib[i].attach(p);else if(Processing.lib[i]instanceof Function)Processing.lib[i].call(this);var retryInterval=100;var executeSketch=function(processing){if(!(curSketch.imageCache.pending||PFont.preloading.pending(retryInterval))){if(window.opera){var link,element,operaCache=curSketch.imageCache.operaCache;for(link in operaCache)if(operaCache.hasOwnProperty(link)){element=operaCache[link];if(element!==null)document.body.removeChild(element);delete operaCache[link]}}curSketch.attach(processing,defaultScope);curSketch.onLoad(processing);if(processing.setup){processing.setup();processing.resetMatrix();curSketch.onSetup()}resetContext();if(processing.draw)if(!doLoop)processing.redraw();else processing.loop()}else window.setTimeout(function(){executeSketch(processing)},retryInterval)};addInstance(this);executeSketch(p)}else{curSketch=new Processing.Sketch;wireDimensionalFunctions();p.size=function(w,h,render){if(render&&render===2)wireDimensionalFunctions("3D");else wireDimensionalFunctions("2D");p.size(w,h,render)}}};Processing.debug=debug;Processing.prototype=defaultScope;function getGlobalMembers(){var names=["abs","acos","alpha","ambient","ambientLight","append","applyMatrix","arc","arrayCopy","asin","atan","atan2","background","beginCamera","beginDraw","beginShape","bezier","bezierDetail","bezierPoint","bezierTangent","bezierVertex","binary","blend","blendColor","blit_resize","blue","box","breakShape","brightness","camera","ceil","Character","color","colorMode","concat","constrain","copy","cos","createFont","createGraphics","createImage","cursor","curve","curveDetail","curvePoint","curveTangent","curveTightness","curveVertex","day","degrees","directionalLight","disableContextMenu","dist","draw","ellipse","ellipseMode","emissive","enableContextMenu","endCamera","endDraw","endShape","exit","exp","expand","externals","fill","filter","floor","focused","frameCount","frameRate","frustum","get","glyphLook","glyphTable","green","height","hex","hint","hour","hue","image","imageMode","intersect","join","key","keyCode","keyPressed","keyReleased","keyTyped","lerp","lerpColor","lightFalloff","lights","lightSpecular","line","link","loadBytes","loadFont","loadGlyphs","loadImage","loadPixels","loadShape","loadXML","loadStrings","log","loop","mag","map","match","matchAll","max","millis","min","minute","mix","modelX","modelY","modelZ","modes","month","mouseButton","mouseClicked","mouseDragged","mouseMoved","mouseOut","mouseOver","mousePressed","mouseReleased","mouseScroll","mouseScrolled","mouseX","mouseY","name","nf","nfc","nfp","nfs","noCursor","noFill","noise","noiseDetail","noiseSeed","noLights","noLoop","norm","normal","noSmooth","noStroke","noTint","ortho","param","parseBoolean","parseByte","parseChar","parseFloat","parseInt","peg","perspective","PImage","pixels","PMatrix2D","PMatrix3D","PMatrixStack","pmouseX","pmouseY","point","pointLight","popMatrix","popStyle","pow","print","printCamera","println","printMatrix","printProjection","PShape","PShapeSVG","pushMatrix","pushStyle","quad","radians","random","Random","randomSeed","rect","rectMode","red","redraw","requestImage","resetMatrix","reverse","rotate","rotateX","rotateY","rotateZ","round","saturation","save","saveFrame","saveStrings","scale","screenX","screenY","screenZ","second","set","setup","shape","shapeMode","shared","shearX","shearY","shininess","shorten","sin","size","smooth","sort","specular","sphere","sphereDetail","splice","split","splitTokens","spotLight","sq","sqrt","status","str","stroke","strokeCap","strokeJoin","strokeWeight","subset","tan","text","textAlign","textAscent","textDescent","textFont","textLeading","textMode","textSize","texture","textureMode","textWidth","tint","toImageData","touchCancel","touchEnd","touchMove","touchStart","translate","transform","triangle","trim","unbinary","unhex","updatePixels","use3DContext","vertex","width","XMLElement","XML","year","__contains","__equals","__equalsIgnoreCase","__frameRate","__hashCode","__int_cast","__instanceof","__keyPressed","__mousePressed","__printStackTrace","__replace","__replaceAll","__replaceFirst","__toCharArray","__split","__codePointAt","__startsWith","__endsWith","__matches"];var members={};var i,l;for(i=0,l=names.length;i<l;++i)members[names[i]]=null;for(var lib in Processing.lib)if(Processing.lib.hasOwnProperty(lib))if(Processing.lib[lib].exports){var exportedNames=Processing.lib[lib].exports;for(i=0,l=exportedNames.length;i<l;++i)members[exportedNames[i]]=null}return members}function parseProcessing(code){var globalMembers=getGlobalMembers();function splitToAtoms(code){var atoms=[];var items=code.split(/([\{\[\(\)\]\}])/);var result=items[0];
var stack=[];for(var i=1;i<items.length;i+=2){var item=items[i];if(item==="["||item==="{"||item==="("){stack.push(result);result=item}else if(item==="]"||item==="}"||item===")"){var kind=item==="}"?"A":item===")"?"B":"C";var index=atoms.length;atoms.push(result+item);result=stack.pop()+'"'+kind+(index+1)+'"'}result+=items[i+1]}atoms.unshift(result);return atoms}function injectStrings(code,strings){return code.replace(/'(\d+)'/g,function(all,index){var val=strings[index];if(val.charAt(0)==="/")return val;return/^'((?:[^'\\\n])|(?:\\.[0-9A-Fa-f]*))'$/.test(val)?"(new $p.Character("+val+"))":val})}function trimSpaces(string){var m1=/^\s*/.exec(string),result;if(m1[0].length===string.length)result={left:m1[0],middle:"",right:""};else{var m2=/\s*$/.exec(string);result={left:m1[0],middle:string.substring(m1[0].length,m2.index),right:m2[0]}}result.untrim=function(t){return this.left+t+this.right};return result}function trim(string){return string.replace(/^\s+/,"").replace(/\s+$/,"")}function appendToLookupTable(table,array){for(var i=0,l=array.length;i<l;++i)table[array[i]]=null;return table}function isLookupTableEmpty(table){for(var i in table)if(table.hasOwnProperty(i))return false;return true}function getAtomIndex(templ){return templ.substring(2,templ.length-1)}var codeWoExtraCr=code.replace(/\r\n?|\n\r/g,"\n");var strings=[];var codeWoStrings=codeWoExtraCr.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')|(([\[\(=|&!\^:?]\s*)(\/(?![*\/])(?:[^\/\\\n]|\\.)*\/[gim]*)\b)|(\/\/[^\n]*\n)|(\/\*(?:(?!\*\/)(?:.|\n))*\*\/)/g,function(all,quoted,aposed,regexCtx,prefix,regex,singleComment,comment){var index;if(quoted||aposed){index=strings.length;strings.push(all);return"'"+index+"'"}if(regexCtx){index=strings.length;strings.push(regex);return prefix+"'"+index+"'"}return comment!==""?" ":"\n"});codeWoStrings=codeWoStrings.replace(/__x([0-9A-F]{4})/g,function(all,hexCode){return"__x005F_x"+hexCode});codeWoStrings=codeWoStrings.replace(/\$/g,"__x0024");var genericsWereRemoved;var codeWoGenerics=codeWoStrings;var replaceFunc=function(all,before,types,after){if(!!before||!!after)return all;genericsWereRemoved=true;return""};do{genericsWereRemoved=false;codeWoGenerics=codeWoGenerics.replace(/([<]?)<\s*((?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?(?:\s*,\s*(?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?)*)\s*>([=]?)/g,replaceFunc)}while(genericsWereRemoved);var atoms=splitToAtoms(codeWoGenerics);var replaceContext;var declaredClasses={},currentClassId,classIdSeed=0;function addAtom(text,type){var lastIndex=atoms.length;atoms.push(text);return'"'+type+lastIndex+'"'}function generateClassId(){return"class"+ ++classIdSeed}function appendClass(class_,classId,scopeId){class_.classId=classId;class_.scopeId=scopeId;declaredClasses[classId]=class_}var transformClassBody,transformInterfaceBody,transformStatementsBlock,transformStatements,transformMain,transformExpression;var classesRegex=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)(class|interface)\s+([A-Za-z_$][\w$]*\b)(\s+extends\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?(\s+implements\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?\s*("A\d+")/g;var methodsRegex=/\b((?:(?:public|private|final|protected|static|abstract|synchronized)\s+)*)((?!(?:else|new|return|throw|function|public|private|protected)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+"|;)/g;var fieldTest=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:else|new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*(?:"C\d+"\s*)*([=,]|$)/;var cstrsRegex=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+")/g;var attrAndTypeRegex=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*/;var functionsRegex=/\bfunction(?:\s+([A-Za-z_$][\w$]*))?\s*("B\d+")\s*("A\d+")/g;function extractClassesAndMethods(code){var s=code;s=s.replace(classesRegex,function(all){return addAtom(all,"E")});s=s.replace(methodsRegex,function(all){return addAtom(all,"D")});s=s.replace(functionsRegex,function(all){return addAtom(all,"H")});return s}function extractConstructors(code,className){var result=code.replace(cstrsRegex,function(all,attr,name,params,throws_,body){if(name!==className)return all;return addAtom(all,"G")});return result}function AstParam(name){this.name=name}AstParam.prototype.toString=function(){return this.name};function AstParams(params,methodArgsParam){this.params=params;this.methodArgsParam=methodArgsParam}AstParams.prototype.getNames=function(){var names=[];for(var i=0,l=this.params.length;i<l;++i)names.push(this.params[i].name);return names};AstParams.prototype.prependMethodArgs=function(body){if(!this.methodArgsParam)return body;return"{\nvar "+this.methodArgsParam.name+" = Array.prototype.slice.call(arguments, "+this.params.length+");\n"+body.substring(1)};AstParams.prototype.toString=function(){if(this.params.length===0)return"()";var result="(";for(var i=0,l=this.params.length;i<l;++i)result+=this.params[i]+", ";return result.substring(0,result.length-2)+")"};function transformParams(params){var paramsWoPars=trim(params.substring(1,params.length-1));var result=[],methodArgsParam=null;if(paramsWoPars!==""){var paramList=paramsWoPars.split(",");for(var i=0;i<paramList.length;++i){var param=/\b([A-Za-z_$][\w$]*\b)(\s*"[ABC][\d]*")*\s*$/.exec(paramList[i]);if(i===paramList.length-1&&paramList[i].indexOf("...")>=0){methodArgsParam=new AstParam(param[1]);break}result.push(new AstParam(param[1]))}}return new AstParams(result,methodArgsParam)}function preExpressionTransform(expr){var s=expr;s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"C\d+")+\s*("A\d+")/g,function(all,type,init){return init});s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"B\d+")\s*("A\d+")/g,function(all,type,init){return addAtom(all,"F")});s=s.replace(functionsRegex,function(all){return addAtom(all,"H")});s=s.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*("C\d+"(?:\s*"C\d+")*)/g,function(all,type,index){var args=index.replace(/"C(\d+)"/g,function(all,j){return atoms[j]}).replace(/\[\s*\]/g,"[null]").replace(/\s*\]\s*\[\s*/g,", ");var arrayInitializer="{"+args.substring(1,args.length-1)+"}";var createArrayArgs="('"+type+"', "+addAtom(arrayInitializer,"A")+")";return"$p.createJavaArray"+addAtom(createArrayArgs,"B")});s=s.replace(/(\.\s*length)\s*"B\d+"/g,"$1");s=s.replace(/#([0-9A-Fa-f]{6})\b/g,function(all,digits){return"0xFF"+digits});s=s.replace(/"B(\d+)"(\s*(?:[\w$']|"B))/g,function(all,index,next){var atom=atoms[index];if(!/^\(\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\s*(?:"C\d+"\s*)*\)$/.test(atom))return all;if(/^\(\s*int\s*\)$/.test(atom))return"(int)"+next;var indexParts=atom.split(/"C(\d+)"/g);if(indexParts.length>1)if(!/^\[\s*\]$/.test(atoms[indexParts[1]]))return all;return""+next});s=s.replace(/\(int\)([^,\]\)\}\?\:\*\+\-\/\^\|\%\&\~<\>\=]+)/g,function(all,arg){var trimmed=trimSpaces(arg);return trimmed.untrim("__int_cast("+trimmed.middle+")")});s=s.replace(/\bsuper(\s*"B\d+")/g,"$$superCstr$1").replace(/\bsuper(\s*\.)/g,"$$super$1");s=s.replace(/\b0+((\d*)(?:\.[\d*])?(?:[eE][\-\+]?\d+)?[fF]?)\b/,function(all,numberWo0,intPart){if(numberWo0===intPart)return all;return intPart===""?"0"+numberWo0:numberWo0});s=s.replace(/\b(\.?\d+\.?)[fF]\b/g,"$1");s=s.replace(/([^\s])%([^=\s])/g,"$1 % $2");s=s.replace(/\b(frameRate|keyPressed|mousePressed)\b(?!\s*"B)/g,"__$1");s=s.replace(/\b(boolean|byte|char|float|int)\s*"B/g,function(all,name){return"parse"+name.substring(0,1).toUpperCase()+name.substring(1)+'"B'});s=s.replace(/\bpixels\b\s*(("C(\d+)")|\.length)?(\s*=(?!=)([^,\]\)\}]+))?/g,function(all,indexOrLength,index,atomIndex,equalsPart,rightSide){if(index){var atom=atoms[atomIndex];if(equalsPart)return"pixels.setPixel"+addAtom("("+atom.substring(1,atom.length-1)+","+rightSide+")","B");return"pixels.getPixel"+addAtom("("+atom.substring(1,atom.length-1)+")","B")}if(indexOrLength)return"pixels.getLength"+addAtom("()","B");if(equalsPart)return"pixels.set"+addAtom("("+rightSide+")","B");return"pixels.toArray"+addAtom("()","B")});var repeatJavaReplacement;function replacePrototypeMethods(all,subject,method,atomIndex){var atom=atoms[atomIndex];repeatJavaReplacement=true;var trimmed=trimSpaces(atom.substring(1,atom.length-1));return"__"+method+(trimmed.middle===""?addAtom("("+subject.replace(/\.\s*$/,"")+")","B"):addAtom("("+subject.replace(/\.\s*$/,"")+","+trimmed.middle+")","B"))}do{repeatJavaReplacement=false;s=s.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*\.\s*(?:[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*\.\s*)*)(replace|replaceAll|replaceFirst|contains|equals|equalsIgnoreCase|hashCode|toCharArray|printStackTrace|split|startsWith|endsWith|codePointAt|matches)\s*"B(\d+)"/g,replacePrototypeMethods)}while(repeatJavaReplacement);function replaceInstanceof(all,subject,type){repeatJavaReplacement=true;return"__instanceof"+addAtom("("+subject+", "+type+")","B")}do{repeatJavaReplacement=false;s=s.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*(?:\.\s*[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*)*)instanceof\s+([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)/g,replaceInstanceof)}while(repeatJavaReplacement);s=s.replace(/\bthis(\s*"B\d+")/g,"$$constr$1");return s}function AstInlineClass(baseInterfaceName,body){this.baseInterfaceName=baseInterfaceName;this.body=body;body.owner=this}AstInlineClass.prototype.toString=function(){return"new ("+this.body+")"};function transformInlineClass(class_){var m=new RegExp(/\bnew\s*([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)\s*"B\d+"\s*"A(\d+)"/).exec(class_);var oldClassId=currentClassId,newClassId=generateClassId();currentClassId=newClassId;var uniqueClassName=m[1]+"$"+newClassId;var inlineClass=new AstInlineClass(uniqueClassName,transformClassBody(atoms[m[2]],uniqueClassName,"","implements "+m[1]));appendClass(inlineClass,newClassId,oldClassId);currentClassId=oldClassId;return inlineClass}function AstFunction(name,params,body){this.name=name;this.params=params;this.body=body}AstFunction.prototype.toString=function(){var oldContext=replaceContext;var names=appendToLookupTable({"this":null},this.params.getNames());replaceContext=function(subject){return names.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var result="function";if(this.name)result+=" "+this.name;var body=this.params.prependMethodArgs(this.body.toString());result+=this.params+" "+body;replaceContext=oldContext;return result};function transformFunction(class_){var m=new RegExp(/\b([A-Za-z_$][\w$]*)\s*"B(\d+)"\s*"A(\d+)"/).exec(class_);return new AstFunction(m[1]!=="function"?m[1]:null,transformParams(atoms[m[2]]),transformStatementsBlock(atoms[m[3]]))}function AstInlineObject(members){this.members=members}AstInlineObject.prototype.toString=function(){var oldContext=replaceContext;replaceContext=function(subject){return subject.name==="this"?"this":oldContext(subject)};var result="";for(var i=0,l=this.members.length;i<l;++i){if(this.members[i].label)result+=this.members[i].label+": ";result+=this.members[i].value.toString()+", "}replaceContext=oldContext;return result.substring(0,result.length-2)};function transformInlineObject(obj){var members=obj.split(",");for(var i=0;i<members.length;++i){var label=members[i].indexOf(":");if(label<0)members[i]={value:transformExpression(members[i])};else members[i]={label:trim(members[i].substring(0,label)),value:transformExpression(trim(members[i].substring(label+1)))}}return new AstInlineObject(members)}function expandExpression(expr){if(expr.charAt(0)==="("||expr.charAt(0)==="[")return expr.charAt(0)+expandExpression(expr.substring(1,expr.length-1))+expr.charAt(expr.length-1);if(expr.charAt(0)==="{"){if(/^\{\s*(?:[A-Za-z_$][\w$]*|'\d+')\s*:/.test(expr))return"{"+addAtom(expr.substring(1,expr.length-1),"I")+"}";return"["+expandExpression(expr.substring(1,expr.length-1))+"]"}var trimmed=trimSpaces(expr);var result=preExpressionTransform(trimmed.middle);result=result.replace(/"[ABC](\d+)"/g,function(all,index){return expandExpression(atoms[index])});return trimmed.untrim(result)}function replaceContextInVars(expr){return expr.replace(/(\.\s*)?((?:\b[A-Za-z_]|\$)[\w$]*)(\s*\.\s*([A-Za-z_$][\w$]*)(\s*\()?)?/g,function(all,memberAccessSign,identifier,suffix,subMember,callSign){if(memberAccessSign)return all;var subject={name:identifier,member:subMember,callSign:!!callSign};return replaceContext(subject)+(suffix===undef?"":suffix)})}function AstExpression(expr,transforms){this.expr=expr;this.transforms=transforms}AstExpression.prototype.toString=function(){var transforms=this.transforms;var expr=replaceContextInVars(this.expr);return expr.replace(/"!(\d+)"/g,function(all,index){return transforms[index].toString()})};transformExpression=function(expr){var transforms=[];var s=expandExpression(expr);s=s.replace(/"H(\d+)"/g,function(all,index){transforms.push(transformFunction(atoms[index]));return'"!'+(transforms.length-1)+'"'});s=s.replace(/"F(\d+)"/g,function(all,index){transforms.push(transformInlineClass(atoms[index]));return'"!'+(transforms.length-1)+'"'});s=s.replace(/"I(\d+)"/g,function(all,index){transforms.push(transformInlineObject(atoms[index]));return'"!'+(transforms.length-1)+'"'});return new AstExpression(s,transforms)};function AstVarDefinition(name,value,isDefault){this.name=name;this.value=value;this.isDefault=isDefault}AstVarDefinition.prototype.toString=function(){return this.name+" = "+this.value};function transformVarDefinition(def,defaultTypeValue){var eqIndex=def.indexOf("=");var name,value,isDefault;if(eqIndex<0){name=def;value=defaultTypeValue;isDefault=true}else{name=def.substring(0,eqIndex);value=transformExpression(def.substring(eqIndex+1));isDefault=false}return new AstVarDefinition(trim(name.replace(/(\s*"C\d+")+/g,"")),value,isDefault)}function getDefaultValueForType(type){if(type==="int"||type==="float")return"0";if(type==="boolean")return"false";if(type==="color")return"0x00000000";return"null"}function AstVar(definitions,varType){this.definitions=definitions;this.varType=varType}AstVar.prototype.getNames=function(){var names=[];for(var i=0,l=this.definitions.length;i<l;++i)names.push(this.definitions[i].name);return names};AstVar.prototype.toString=function(){return"var "+this.definitions.join(",")};function AstStatement(expression){this.expression=expression}AstStatement.prototype.toString=function(){return this.expression.toString()};function transformStatement(statement){if(fieldTest.test(statement)){var attrAndType=attrAndTypeRegex.exec(statement);var definitions=statement.substring(attrAndType[0].length).split(",");var defaultTypeValue=getDefaultValueForType(attrAndType[2]);for(var i=0;i<definitions.length;++i)definitions[i]=transformVarDefinition(definitions[i],defaultTypeValue);return new AstVar(definitions,attrAndType[2])}return new AstStatement(transformExpression(statement))}function AstForExpression(initStatement,condition,step){this.initStatement=initStatement;this.condition=condition;this.step=step}AstForExpression.prototype.toString=function(){return"("+this.initStatement+"; "+this.condition+"; "+this.step+")"};function AstForInExpression(initStatement,container){this.initStatement=initStatement;this.container=container}AstForInExpression.prototype.toString=function(){var init=this.initStatement.toString();if(init.indexOf("=")>=0)init=init.substring(0,init.indexOf("="));return"("+init+" in "+this.container+")"};function AstForEachExpression(initStatement,container){this.initStatement=initStatement;this.container=container}AstForEachExpression.iteratorId=0;AstForEachExpression.prototype.toString=function(){var init=this.initStatement.toString();var iterator="$it"+AstForEachExpression.iteratorId++;var variableName=init.replace(/^\s*var\s*/,"").split("=")[0];var initIteratorAndVariable="var "+iterator+" = new $p.ObjectIterator("+this.container+"), "+variableName+" = void(0)";var nextIterationCondition=iterator+".hasNext() && (("+variableName+" = "+iterator+".next()) || true)";return"("+initIteratorAndVariable+"; "+nextIterationCondition+";)"};function transformForExpression(expr){var content;if(/\bin\b/.test(expr)){content=expr.substring(1,expr.length-1).split(/\bin\b/g);return new AstForInExpression(transformStatement(trim(content[0])),transformExpression(content[1]))}if(expr.indexOf(":")>=0&&expr.indexOf(";")<0){content=expr.substring(1,expr.length-1).split(":");return new AstForEachExpression(transformStatement(trim(content[0])),transformExpression(content[1]))}content=expr.substring(1,expr.length-1).split(";");return new AstForExpression(transformStatement(trim(content[0])),transformExpression(content[1]),transformExpression(content[2]))}function sortByWeight(array){array.sort(function(a,b){return b.weight-a.weight})}function AstInnerInterface(name,body,isStatic){this.name=name;this.body=body;this.isStatic=isStatic;body.owner=this}AstInnerInterface.prototype.toString=function(){return""+this.body};function AstInnerClass(name,body,isStatic){this.name=name;this.body=body;this.isStatic=isStatic;body.owner=this}AstInnerClass.prototype.toString=function(){return""+this.body};function transformInnerClass(class_){var m=classesRegex.exec(class_);classesRegex.lastIndex=0;var isStatic=m[1].indexOf("static")>=0;var body=atoms[getAtomIndex(m[6])],innerClass;var oldClassId=currentClassId,newClassId=generateClassId();currentClassId=newClassId;if(m[2]==="interface")innerClass=new AstInnerInterface(m[3],transformInterfaceBody(body,m[3],m[4]),isStatic);else innerClass=new AstInnerClass(m[3],transformClassBody(body,m[3],m[4],m[5]),isStatic);appendClass(innerClass,newClassId,oldClassId);currentClassId=oldClassId;return innerClass}function AstClassMethod(name,params,body,isStatic){this.name=name;this.params=params;this.body=body;this.isStatic=isStatic}AstClassMethod.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames());var oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var body=this.params.prependMethodArgs(this.body.toString());var result="function "+this.methodId+this.params+" "+body+"\n";replaceContext=oldContext;return result};function transformClassMethod(method){var m=methodsRegex.exec(method);methodsRegex.lastIndex=0;var isStatic=m[1].indexOf("static")>=0;var body=m[6]!==";"?atoms[getAtomIndex(m[6])]:"{}";return new AstClassMethod(m[3],transformParams(atoms[getAtomIndex(m[4])]),transformStatementsBlock(body),isStatic)}function AstClassField(definitions,fieldType,isStatic){this.definitions=definitions;this.fieldType=fieldType;this.isStatic=isStatic}AstClassField.prototype.getNames=function(){var names=[];for(var i=0,l=this.definitions.length;i<l;++i)names.push(this.definitions[i].name);return names};AstClassField.prototype.toString=function(){var thisPrefix=replaceContext({name:"[this]"});if(this.isStatic){var className=this.owner.name;var staticDeclarations=[];for(var i=0,l=this.definitions.length;i<l;++i){var definition=this.definitions[i];var name=definition.name,staticName=className+"."+name;var declaration="if("+staticName+" === void(0)) {\n"+" "+staticName+" = "+definition.value+"; }\n"+"$p.defineProperty("+thisPrefix+", "+"'"+name+"', { get: function(){return "+staticName+";}, "+"set: function(val){"+staticName+" = val;} });\n";staticDeclarations.push(declaration)}return staticDeclarations.join("")}return thisPrefix+"."+this.definitions.join("; "+thisPrefix+".")};function transformClassField(statement){var attrAndType=attrAndTypeRegex.exec(statement);var isStatic=attrAndType[1].indexOf("static")>=0;var definitions=statement.substring(attrAndType[0].length).split(/,\s*/g);var defaultTypeValue=getDefaultValueForType(attrAndType[2]);for(var i=0;i<definitions.length;++i)definitions[i]=transformVarDefinition(definitions[i],defaultTypeValue);return new AstClassField(definitions,attrAndType[2],isStatic)}function AstConstructor(params,body){this.params=params;this.body=body}AstConstructor.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames());var oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var prefix="function $constr_"+this.params.params.length+this.params.toString();var body=this.params.prependMethodArgs(this.body.toString());if(!/\$(superCstr|constr)\b/.test(body))body="{\n$superCstr();\n"+body.substring(1);replaceContext=oldContext;return prefix+body+"\n"};function transformConstructor(cstr){var m=new RegExp(/"B(\d+)"\s*"A(\d+)"/).exec(cstr);var params=transformParams(atoms[m[1]]);return new AstConstructor(params,transformStatementsBlock(atoms[m[2]]))}function AstInterfaceBody(name,interfacesNames,methodsNames,fields,innerClasses,misc){var i,l;this.name=name;this.interfacesNames=interfacesNames;this.methodsNames=methodsNames;this.fields=fields;this.innerClasses=innerClasses;this.misc=misc;for(i=0,l=fields.length;i<l;++i)fields[i].owner=this}AstInterfaceBody.prototype.getMembers=function(classFields,classMethods,classInners){if(this.owner.base)this.owner.base.body.getMembers(classFields,classMethods,classInners);var i,j,l,m;for(i=0,l=this.fields.length;i<l;++i){var fieldNames=this.fields[i].getNames();for(j=0,m=fieldNames.length;j<m;++j)classFields[fieldNames[j]]=this.fields[i]}for(i=0,l=this.methodsNames.length;i<l;++i){var methodName=this.methodsNames[i];classMethods[methodName]=true}for(i=0,l=this.innerClasses.length;i<l;++i){var innerClass=this.innerClasses[i];classInners[innerClass.name]=innerClass}};AstInterfaceBody.prototype.toString=function(){function getScopeLevel(p){var i=0;while(p){++i;p=p.scope}return i}var scopeLevel=getScopeLevel(this.owner);var className=this.name;var staticDefinitions="";var metadata="";var thisClassFields={},thisClassMethods={},thisClassInners={};this.getMembers(thisClassFields,thisClassMethods,thisClassInners);var i,l,j,m;if(this.owner.interfaces){var resolvedInterfaces=[],resolvedInterface;for(i=0,l=this.interfacesNames.length;i<l;++i){if(!this.owner.interfaces[i])continue;resolvedInterface=replaceContext({name:this.interfacesNames[i]});resolvedInterfaces.push(resolvedInterface);staticDefinitions+="$p.extendInterfaceMembers("+className+", "+resolvedInterface+");\n"}metadata+=className+".$interfaces = ["+resolvedInterfaces.join(", ")+"];\n"}metadata+=className+".$isInterface = true;\n";metadata+=className+".$methods = ['"+this.methodsNames.join("', '")+"'];\n";sortByWeight(this.innerClasses);for(i=0,l=this.innerClasses.length;i<l;++i){var innerClass=this.innerClasses[i];if(innerClass.isStatic)staticDefinitions+=className+"."+innerClass.name+" = "+innerClass+";\n"}for(i=0,l=this.fields.length;i<l;++i){var field=this.fields[i];if(field.isStatic)staticDefinitions+=className+"."+field.definitions.join(";\n"+className+".")+";\n"}return"(function() {\n"+"function "+className+"() { throw 'Unable to create the interface'; }\n"+staticDefinitions+metadata+"return "+className+";\n"+"})()"};transformInterfaceBody=function(body,name,baseInterfaces){var declarations=body.substring(1,body.length-1);declarations=extractClassesAndMethods(declarations);declarations=extractConstructors(declarations,name);var methodsNames=[],classes=[];declarations=declarations.replace(/"([DE])(\d+)"/g,function(all,type,index){if(type==="D")methodsNames.push(index);else if(type==="E")classes.push(index);return""});var fields=declarations.split(/;(?:\s*;)*/g);var baseInterfaceNames;var i,l;if(baseInterfaces!==undef)baseInterfaceNames=baseInterfaces.replace(/^\s*extends\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g);for(i=0,l=methodsNames.length;i<l;++i){var method=transformClassMethod(atoms[methodsNames[i]]);methodsNames[i]=method.name}for(i=0,l=fields.length-1;i<l;++i){var field=trimSpaces(fields[i]);fields[i]=transformClassField(field.middle)}var tail=fields.pop();for(i=0,l=classes.length;i<l;++i)classes[i]=transformInnerClass(atoms[classes[i]]);return new AstInterfaceBody(name,baseInterfaceNames,methodsNames,fields,classes,{tail:tail})};function AstClassBody(name,baseClassName,interfacesNames,functions,methods,fields,cstrs,innerClasses,misc){var i,l;this.name=name;this.baseClassName=baseClassName;this.interfacesNames=interfacesNames;this.functions=functions;this.methods=methods;this.fields=fields;this.cstrs=cstrs;this.innerClasses=innerClasses;this.misc=misc;for(i=0,l=fields.length;i<l;++i)fields[i].owner=this}AstClassBody.prototype.getMembers=function(classFields,classMethods,classInners){if(this.owner.base)this.owner.base.body.getMembers(classFields,classMethods,classInners);var i,j,l,m;for(i=0,l=this.fields.length;i<l;++i){var fieldNames=this.fields[i].getNames();for(j=0,m=fieldNames.length;j<m;++j)classFields[fieldNames[j]]=this.fields[i]}for(i=0,l=this.methods.length;i<l;++i){var method=this.methods[i];classMethods[method.name]=method}for(i=0,l=this.innerClasses.length;i<l;++i){var innerClass=this.innerClasses[i];classInners[innerClass.name]=innerClass}};AstClassBody.prototype.toString=function(){function getScopeLevel(p){var i=0;while(p){++i;p=p.scope}return i}var scopeLevel=getScopeLevel(this.owner);var selfId="$this_"+scopeLevel;var className=this.name;var result="var "+selfId+" = this;\n";var staticDefinitions="";var metadata="";var thisClassFields={},thisClassMethods={},thisClassInners={};this.getMembers(thisClassFields,thisClassMethods,thisClassInners);var oldContext=replaceContext;replaceContext=function(subject){var name=subject.name;if(name==="this")return subject.callSign||!subject.member?selfId+".$self":selfId;if(thisClassFields.hasOwnProperty(name))return thisClassFields[name].isStatic?className+"."+name:selfId+"."+name;if(thisClassInners.hasOwnProperty(name))return selfId+"."+name;if(thisClassMethods.hasOwnProperty(name))return thisClassMethods[name].isStatic?className+"."+name:selfId+".$self."+name;return oldContext(subject)};var resolvedBaseClassName;if(this.baseClassName){resolvedBaseClassName=oldContext({name:this.baseClassName});result+="var $super = { $upcast: "+selfId+" };\n";result+="function $superCstr(){"+resolvedBaseClassName+".apply($super,arguments);if(!('$self' in $super)) $p.extendClassChain($super)}\n";metadata+=className+".$base = "+resolvedBaseClassName+";\n"}else result+="function $superCstr(){$p.extendClassChain("+selfId+")}\n";if(this.owner.base)staticDefinitions+="$p.extendStaticMembers("+className+", "+resolvedBaseClassName+");\n";var i,l,j,m;if(this.owner.interfaces){var resolvedInterfaces=[],resolvedInterface;for(i=0,l=this.interfacesNames.length;i<l;++i){if(!this.owner.interfaces[i])continue;resolvedInterface=oldContext({name:this.interfacesNames[i]});resolvedInterfaces.push(resolvedInterface);staticDefinitions+="$p.extendInterfaceMembers("+className+", "+resolvedInterface+");\n"}metadata+=className+".$interfaces = ["+resolvedInterfaces.join(", ")+"];\n"}if(this.functions.length>0)result+=this.functions.join("\n")+"\n";sortByWeight(this.innerClasses);for(i=0,l=this.innerClasses.length;i<l;++i){var innerClass=this.innerClasses[i];if(innerClass.isStatic){staticDefinitions+=className+"."+innerClass.name+" = "+innerClass+";\n";result+=selfId+"."+innerClass.name+" = "+className+"."+innerClass.name+";\n"}else result+=selfId+"."+innerClass.name+" = "+innerClass+";\n"}for(i=0,l=this.fields.length;i<l;++i){var field=this.fields[i];if(field.isStatic){staticDefinitions+=className+"."+field.definitions.join(";\n"+className+".")+";\n";for(j=0,m=field.definitions.length;j<m;++j){var fieldName=field.definitions[j].name,staticName=className+"."+fieldName;result+="$p.defineProperty("+selfId+", '"+fieldName+"', {"+"get: function(){return "+staticName+"}, "+"set: function(val){"+staticName+" = val}});\n"}}else result+=selfId+"."+field.definitions.join(";\n"+selfId+".")+";\n"}var methodOverloads={};for(i=0,l=this.methods.length;i<l;++i){var method=this.methods[i];var overload=methodOverloads[method.name];var methodId=method.name+"$"+method.params.params.length;var hasMethodArgs=!!method.params.methodArgsParam;if(overload){++overload;methodId+="_"+overload}else overload=1;method.methodId=methodId;methodOverloads[method.name]=overload;if(method.isStatic){staticDefinitions+=method;staticDefinitions+="$p.addMethod("+className+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n";result+="$p.addMethod("+selfId+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n"}else{result+=method;result+="$p.addMethod("+selfId+", '"+method.name+"', "+methodId+", "+hasMethodArgs+");\n"}}result+=trim(this.misc.tail);if(this.cstrs.length>0)result+=this.cstrs.join("\n")+"\n";result+="function $constr() {\n";var cstrsIfs=[];for(i=0,l=this.cstrs.length;i<l;++i){var paramsLength=this.cstrs[i].params.params.length;var methodArgsPresent=!!this.cstrs[i].params.methodArgsParam;cstrsIfs.push("if(arguments.length "+(methodArgsPresent?">=":"===")+" "+paramsLength+") { "+"$constr_"+paramsLength+".apply("+selfId+", arguments); }")}if(cstrsIfs.length>0)result+=cstrsIfs.join(" else ")+" else ";result+="$superCstr();\n}\n";result+="$constr.apply(null, arguments);\n";replaceContext=oldContext;return"(function() {\n"+"function "+className+"() {\n"+result+"}\n"+staticDefinitions+metadata+"return "+className+";\n"+"})()"};transformClassBody=function(body,name,baseName,interfaces){var declarations=body.substring(1,body.length-1);declarations=extractClassesAndMethods(declarations);declarations=extractConstructors(declarations,name);var methods=[],classes=[],cstrs=[],functions=[];declarations=declarations.replace(/"([DEGH])(\d+)"/g,function(all,type,index){if(type==="D")methods.push(index);else if(type==="E")classes.push(index);else if(type==="H")functions.push(index);else cstrs.push(index);return""});var fields=declarations.replace(/^(?:\s*;)+/,"").split(/;(?:\s*;)*/g);var baseClassName,interfacesNames;var i;if(baseName!==undef)baseClassName=baseName.replace(/^\s*extends\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*$/g,"$1");if(interfaces!==undef)interfacesNames=interfaces.replace(/^\s*implements\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g);for(i=0;i<functions.length;++i)functions[i]=transformFunction(atoms[functions[i]]);for(i=0;i<methods.length;++i)methods[i]=transformClassMethod(atoms[methods[i]]);for(i=0;i<fields.length-1;++i){var field=trimSpaces(fields[i]);fields[i]=transformClassField(field.middle)}var tail=fields.pop();for(i=0;i<cstrs.length;++i)cstrs[i]=transformConstructor(atoms[cstrs[i]]);for(i=0;i<classes.length;++i)classes[i]=transformInnerClass(atoms[classes[i]]);return new AstClassBody(name,baseClassName,interfacesNames,functions,methods,fields,cstrs,classes,{tail:tail})};function AstInterface(name,body){this.name=name;this.body=body;body.owner=this}AstInterface.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n"+"$p."+this.name+" = "+this.name+";\n"};function AstClass(name,body){this.name=name;this.body=body;body.owner=this}AstClass.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n"+"$p."+this.name+" = "+this.name+";\n"};function transformGlobalClass(class_){var m=classesRegex.exec(class_);classesRegex.lastIndex=0;var body=atoms[getAtomIndex(m[6])];var oldClassId=currentClassId,newClassId=generateClassId();
currentClassId=newClassId;var globalClass;if(m[2]==="interface")globalClass=new AstInterface(m[3],transformInterfaceBody(body,m[3],m[4]));else globalClass=new AstClass(m[3],transformClassBody(body,m[3],m[4],m[5]));appendClass(globalClass,newClassId,oldClassId);currentClassId=oldClassId;return globalClass}function AstMethod(name,params,body){this.name=name;this.params=params;this.body=body}AstMethod.prototype.toString=function(){var paramNames=appendToLookupTable({},this.params.getNames());var oldContext=replaceContext;replaceContext=function(subject){return paramNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var body=this.params.prependMethodArgs(this.body.toString());var result="function "+this.name+this.params+" "+body+"\n"+"$p."+this.name+" = "+this.name+";";replaceContext=oldContext;return result};function transformGlobalMethod(method){var m=methodsRegex.exec(method);var result=methodsRegex.lastIndex=0;return new AstMethod(m[3],transformParams(atoms[getAtomIndex(m[4])]),transformStatementsBlock(atoms[getAtomIndex(m[6])]))}function preStatementsTransform(statements){var s=statements;s=s.replace(/\b(catch\s*"B\d+"\s*"A\d+")(\s*catch\s*"B\d+"\s*"A\d+")+/g,"$1");return s}function AstForStatement(argument,misc){this.argument=argument;this.misc=misc}AstForStatement.prototype.toString=function(){return this.misc.prefix+this.argument.toString()};function AstCatchStatement(argument,misc){this.argument=argument;this.misc=misc}AstCatchStatement.prototype.toString=function(){return this.misc.prefix+this.argument.toString()};function AstPrefixStatement(name,argument,misc){this.name=name;this.argument=argument;this.misc=misc}AstPrefixStatement.prototype.toString=function(){var result=this.misc.prefix;if(this.argument!==undef)result+=this.argument.toString();return result};function AstSwitchCase(expr){this.expr=expr}AstSwitchCase.prototype.toString=function(){return"case "+this.expr+":"};function AstLabel(label){this.label=label}AstLabel.prototype.toString=function(){return this.label};transformStatements=function(statements,transformMethod,transformClass){var nextStatement=new RegExp(/\b(catch|for|if|switch|while|with)\s*"B(\d+)"|\b(do|else|finally|return|throw|try|break|continue)\b|("[ADEH](\d+)")|\b(case)\s+([^:]+):|\b([A-Za-z_$][\w$]*\s*:)|(;)/g);var res=[];statements=preStatementsTransform(statements);var lastIndex=0,m,space;while((m=nextStatement.exec(statements))!==null){if(m[1]!==undef){var i=statements.lastIndexOf('"B',nextStatement.lastIndex);var statementsPrefix=statements.substring(lastIndex,i);if(m[1]==="for")res.push(new AstForStatement(transformForExpression(atoms[m[2]]),{prefix:statementsPrefix}));else if(m[1]==="catch")res.push(new AstCatchStatement(transformParams(atoms[m[2]]),{prefix:statementsPrefix}));else res.push(new AstPrefixStatement(m[1],transformExpression(atoms[m[2]]),{prefix:statementsPrefix}))}else if(m[3]!==undef)res.push(new AstPrefixStatement(m[3],undef,{prefix:statements.substring(lastIndex,nextStatement.lastIndex)}));else if(m[4]!==undef){space=statements.substring(lastIndex,nextStatement.lastIndex-m[4].length);if(trim(space).length!==0)continue;res.push(space);var kind=m[4].charAt(1),atomIndex=m[5];if(kind==="D")res.push(transformMethod(atoms[atomIndex]));else if(kind==="E")res.push(transformClass(atoms[atomIndex]));else if(kind==="H")res.push(transformFunction(atoms[atomIndex]));else res.push(transformStatementsBlock(atoms[atomIndex]))}else if(m[6]!==undef)res.push(new AstSwitchCase(transformExpression(trim(m[7]))));else if(m[8]!==undef){space=statements.substring(lastIndex,nextStatement.lastIndex-m[8].length);if(trim(space).length!==0)continue;res.push(new AstLabel(statements.substring(lastIndex,nextStatement.lastIndex)))}else{var statement=trimSpaces(statements.substring(lastIndex,nextStatement.lastIndex-1));res.push(statement.left);res.push(transformStatement(statement.middle));res.push(statement.right+";")}lastIndex=nextStatement.lastIndex}var statementsTail=trimSpaces(statements.substring(lastIndex));res.push(statementsTail.left);if(statementsTail.middle!==""){res.push(transformStatement(statementsTail.middle));res.push(";"+statementsTail.right)}return res};function getLocalNames(statements){var localNames=[];for(var i=0,l=statements.length;i<l;++i){var statement=statements[i];if(statement instanceof AstVar)localNames=localNames.concat(statement.getNames());else if(statement instanceof AstForStatement&&statement.argument.initStatement instanceof AstVar)localNames=localNames.concat(statement.argument.initStatement.getNames());else if(statement instanceof AstInnerInterface||statement instanceof AstInnerClass||statement instanceof AstInterface||statement instanceof AstClass||statement instanceof AstMethod||statement instanceof AstFunction)localNames.push(statement.name)}return appendToLookupTable({},localNames)}function AstStatementsBlock(statements){this.statements=statements}AstStatementsBlock.prototype.toString=function(){var localNames=getLocalNames(this.statements);var oldContext=replaceContext;if(!isLookupTableEmpty(localNames))replaceContext=function(subject){return localNames.hasOwnProperty(subject.name)?subject.name:oldContext(subject)};var result="{\n"+this.statements.join("")+"\n}";replaceContext=oldContext;return result};transformStatementsBlock=function(block){var content=trimSpaces(block.substring(1,block.length-1));return new AstStatementsBlock(transformStatements(content.middle))};function AstRoot(statements){this.statements=statements}AstRoot.prototype.toString=function(){var classes=[],otherStatements=[],statement;for(var i=0,len=this.statements.length;i<len;++i){statement=this.statements[i];if(statement instanceof AstClass||statement instanceof AstInterface)classes.push(statement);else otherStatements.push(statement)}sortByWeight(classes);var localNames=getLocalNames(this.statements);replaceContext=function(subject){var name=subject.name;if(localNames.hasOwnProperty(name))return name;if(globalMembers.hasOwnProperty(name)||PConstants.hasOwnProperty(name)||defaultScope.hasOwnProperty(name))return"$p."+name;return name};var result="// this code was autogenerated from PJS\n"+"(function($p) {\n"+classes.join("")+"\n"+otherStatements.join("")+"\n})";replaceContext=null;return result};transformMain=function(){var statements=extractClassesAndMethods(atoms[0]);statements=statements.replace(/\bimport\s+[^;]+;/g,"");return new AstRoot(transformStatements(statements,transformGlobalMethod,transformGlobalClass))};function generateMetadata(ast){var globalScope={};var id,class_;for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id)){class_=declaredClasses[id];var scopeId=class_.scopeId,name=class_.name;if(scopeId){var scope=declaredClasses[scopeId];class_.scope=scope;if(scope.inScope===undef)scope.inScope={};scope.inScope[name]=class_}else globalScope[name]=class_}function findInScopes(class_,name){var parts=name.split(".");var currentScope=class_.scope,found;while(currentScope){if(currentScope.hasOwnProperty(parts[0])){found=currentScope[parts[0]];break}currentScope=currentScope.scope}if(found===undef)found=globalScope[parts[0]];for(var i=1,l=parts.length;i<l&&found;++i)found=found.inScope[parts[i]];return found}for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id)){class_=declaredClasses[id];var baseClassName=class_.body.baseClassName;if(baseClassName){var parent=findInScopes(class_,baseClassName);if(parent){class_.base=parent;if(!parent.derived)parent.derived=[];parent.derived.push(class_)}}var interfacesNames=class_.body.interfacesNames,interfaces=[],i,l;if(interfacesNames&&interfacesNames.length>0){for(i=0,l=interfacesNames.length;i<l;++i){var interface_=findInScopes(class_,interfacesNames[i]);interfaces.push(interface_);if(!interface_)continue;if(!interface_.derived)interface_.derived=[];interface_.derived.push(class_)}if(interfaces.length>0)class_.interfaces=interfaces}}}function setWeight(ast){var queue=[],tocheck={};var id,scopeId,class_;for(id in declaredClasses)if(declaredClasses.hasOwnProperty(id)){class_=declaredClasses[id];if(!class_.inScope&&!class_.derived){queue.push(id);class_.weight=0}else{var dependsOn=[];if(class_.inScope)for(scopeId in class_.inScope)if(class_.inScope.hasOwnProperty(scopeId))dependsOn.push(class_.inScope[scopeId]);if(class_.derived)dependsOn=dependsOn.concat(class_.derived);tocheck[id]=dependsOn}}function removeDependentAndCheck(targetId,from){var dependsOn=tocheck[targetId];if(!dependsOn)return false;var i=dependsOn.indexOf(from);if(i<0)return false;dependsOn.splice(i,1);if(dependsOn.length>0)return false;delete tocheck[targetId];return true}while(queue.length>0){id=queue.shift();class_=declaredClasses[id];if(class_.scopeId&&removeDependentAndCheck(class_.scopeId,class_)){queue.push(class_.scopeId);declaredClasses[class_.scopeId].weight=class_.weight+1}if(class_.base&&removeDependentAndCheck(class_.base.classId,class_)){queue.push(class_.base.classId);class_.base.weight=class_.weight+1}if(class_.interfaces){var i,l;for(i=0,l=class_.interfaces.length;i<l;++i){if(!class_.interfaces[i]||!removeDependentAndCheck(class_.interfaces[i].classId,class_))continue;queue.push(class_.interfaces[i].classId);class_.interfaces[i].weight=class_.weight+1}}}}var transformed=transformMain();generateMetadata(transformed);setWeight(transformed);var redendered=transformed.toString();redendered=redendered.replace(/\s*\n(?:[\t ]*\n)+/g,"\n\n");redendered=redendered.replace(/__x([0-9A-F]{4})/g,function(all,hexCode){return String.fromCharCode(parseInt(hexCode,16))});return injectStrings(redendered,strings)}function preprocessCode(aCode,sketch){var dm=new RegExp(/\/\*\s*@pjs\s+((?:[^\*]|\*+[^\*\/])*)\*\//g).exec(aCode);if(dm&&dm.length===2){var jsonItems=[],directives=dm.splice(1,2)[0].replace(/\{([\s\S]*?)\}/g,function(){return function(all,item){jsonItems.push(item);return"{"+(jsonItems.length-1)+"}"}}()).replace("\n","").replace("\r","").split(";");var clean=function(s){return s.replace(/^\s*["']?/,"").replace(/["']?\s*$/,"")};for(var i=0,dl=directives.length;i<dl;i++){var pair=directives[i].split("=");if(pair&&pair.length===2){var key=clean(pair[0]),value=clean(pair[1]),list=[];if(key==="preload"){list=value.split(",");for(var j=0,jl=list.length;j<jl;j++){var imageName=clean(list[j]);sketch.imageCache.add(imageName)}}else if(key==="font"){list=value.split(",");for(var x=0,xl=list.length;x<xl;x++){var fontName=clean(list[x]),index=/^\{(\d*?)\}$/.exec(fontName);PFont.preloading.add(index?JSON.parse("{"+jsonItems[index[1]]+"}"):fontName)}}else if(key==="pauseOnBlur")sketch.options.pauseOnBlur=value==="true";else if(key==="globalKeyEvents")sketch.options.globalKeyEvents=value==="true";else if(key.substring(0,6)==="param-")sketch.params[key.substring(6)]=value;else sketch.options[key]=value}}}return aCode}Processing.compile=function(pdeCode){var sketch=new Processing.Sketch;var code=preprocessCode(pdeCode,sketch);var compiledPde=parseProcessing(code);sketch.sourceCode=compiledPde;return sketch};var tinylogLite=function(){var tinylogLite={},undef="undefined",func="function",False=!1,True=!0,logLimit=512,log="log";if(typeof tinylog!==undef&&typeof tinylog[log]===func)tinylogLite[log]=tinylog[log];else if(typeof document!==undef&&!document.fake)(function(){var doc=document,$div="div",$style="style",$title="title",containerStyles={zIndex:1e4,position:"fixed",bottom:"0px",width:"100%",height:"15%",fontFamily:"sans-serif",color:"#ccc",backgroundColor:"black"},outputStyles={position:"relative",fontFamily:"monospace",overflow:"auto",height:"100%",paddingTop:"5px"},resizerStyles={height:"5px",marginTop:"-5px",cursor:"n-resize",backgroundColor:"darkgrey"},closeButtonStyles={position:"absolute",top:"5px",right:"20px",color:"#111",MozBorderRadius:"4px",webkitBorderRadius:"4px",borderRadius:"4px",cursor:"pointer",fontWeight:"normal",textAlign:"center",padding:"3px 5px",backgroundColor:"#333",fontSize:"12px"},entryStyles={minHeight:"16px"},entryTextStyles={fontSize:"12px",margin:"0 8px 0 8px",maxWidth:"100%",whiteSpace:"pre-wrap",overflow:"auto"},view=doc.defaultView,docElem=doc.documentElement,docElemStyle=docElem[$style],setStyles=function(){var i=arguments.length,elemStyle,styles,style;while(i--){styles=arguments[i--];elemStyle=arguments[i][$style];for(style in styles)if(styles.hasOwnProperty(style))elemStyle[style]=styles[style]}},observer=function(obj,event,handler){if(obj.addEventListener)obj.addEventListener(event,handler,False);else if(obj.attachEvent)obj.attachEvent("on"+event,handler);return[obj,event,handler]},unobserve=function(obj,event,handler){if(obj.removeEventListener)obj.removeEventListener(event,handler,False);else if(obj.detachEvent)obj.detachEvent("on"+event,handler)},clearChildren=function(node){var children=node.childNodes,child=children.length;while(child--)node.removeChild(children.item(0))},append=function(to,elem){return to.appendChild(elem)},createElement=function(localName){return doc.createElement(localName)},createTextNode=function(text){return doc.createTextNode(text)},createLog=tinylogLite[log]=function(message){var uninit,originalPadding=docElemStyle.paddingBottom,container=createElement($div),containerStyle=container[$style],resizer=append(container,createElement($div)),output=append(container,createElement($div)),closeButton=append(container,createElement($div)),resizingLog=False,previousHeight=False,previousScrollTop=False,messages=0,updateSafetyMargin=function(){docElemStyle.paddingBottom=container.clientHeight+"px"},setContainerHeight=function(height){var viewHeight=view.innerHeight,resizerHeight=resizer.clientHeight;if(height<0)height=0;else if(height+resizerHeight>viewHeight)height=viewHeight-resizerHeight;containerStyle.height=height/viewHeight*100+"%";updateSafetyMargin()},observers=[observer(doc,"mousemove",function(evt){if(resizingLog){setContainerHeight(view.innerHeight-evt.clientY);output.scrollTop=previousScrollTop}}),observer(doc,"mouseup",function(){if(resizingLog)resizingLog=previousScrollTop=False}),observer(resizer,"dblclick",function(evt){evt.preventDefault();if(previousHeight){setContainerHeight(previousHeight);previousHeight=False}else{previousHeight=container.clientHeight;containerStyle.height="0px"}}),observer(resizer,"mousedown",function(evt){evt.preventDefault();resizingLog=True;previousScrollTop=output.scrollTop}),observer(resizer,"contextmenu",function(){resizingLog=False}),observer(closeButton,"click",function(){uninit()})];uninit=function(){var i=observers.length;while(i--)unobserve.apply(tinylogLite,observers[i]);docElem.removeChild(container);docElemStyle.paddingBottom=originalPadding;clearChildren(output);clearChildren(container);tinylogLite[log]=createLog};setStyles(container,containerStyles,output,outputStyles,resizer,resizerStyles,closeButton,closeButtonStyles);closeButton[$title]="Close Log";append(closeButton,createTextNode("✖"));resizer[$title]="Double-click to toggle log minimization";docElem.insertBefore(container,docElem.firstChild);tinylogLite[log]=function(message){if(messages===logLimit)output.removeChild(output.firstChild);else messages++;var entry=append(output,createElement($div)),entryText=append(entry,createElement($div));entry[$title]=(new Date).toLocaleTimeString();setStyles(entry,entryStyles,entryText,entryTextStyles);append(entryText,createTextNode(message));output.scrollTop=output.scrollHeight};tinylogLite[log](message);updateSafetyMargin()}})();else if(typeof print===func)tinylogLite[log]=print;return tinylogLite}();Processing.logger=tinylogLite;Processing.version="1.4.1";Processing.lib={};Processing.registerLibrary=function(name,desc){Processing.lib[name]=desc;if(desc.hasOwnProperty("init"))desc.init(defaultScope)};Processing.instances=processingInstances;Processing.getInstanceById=function(name){return processingInstances[processingInstanceIds[name]]};Processing.Sketch=function(attachFunction){this.attachFunction=attachFunction;this.options={pauseOnBlur:false,globalKeyEvents:false};this.onLoad=nop;this.onSetup=nop;this.onPause=nop;this.onLoop=nop;this.onFrameStart=nop;this.onFrameEnd=nop;this.onExit=nop;this.params={};this.imageCache={pending:0,images:{},operaCache:{},add:function(href,img){if(this.images[href])return;if(!isDOMPresent)this.images[href]=null;if(!img){img=new Image;img.onload=function(owner){return function(){owner.pending--}}(this);this.pending++;img.src=href}this.images[href]=img;if(window.opera){var div=document.createElement("div");div.appendChild(img);div.style.position="absolute";div.style.opacity=0;div.style.width="1px";div.style.height="1px";if(!this.operaCache[href]){document.body.appendChild(div);this.operaCache[href]=div}}}};this.sourceCode=undefined;this.attach=function(processing){if(typeof this.attachFunction==="function")this.attachFunction(processing);else if(this.sourceCode){var func=new Function("return ("+this.sourceCode+");")();func(processing);this.attachFunction=func}else throw"Unable to attach sketch to the processing instance"};this.toString=function(){var i;var code="((function(Sketch) {\n";code+="var sketch = new Sketch(\n"+this.sourceCode+");\n";for(i in this.options)if(this.options.hasOwnProperty(i)){var value=this.options[i];code+="sketch.options."+i+" = "+(typeof value==="string"?'"'+value+'"':""+value)+";\n"}for(i in this.imageCache)if(this.options.hasOwnProperty(i))code+='sketch.imageCache.add("'+i+'");\n';code+="return sketch;\n})(Processing.Sketch))";return code}};var loadSketchFromSources=function(canvas,sources){var code=[],errors=[],sourcesCount=sources.length,loaded=0;function ajaxAsync(url,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState===4){var error;if(xhr.status!==200&&xhr.status!==0)error="Invalid XHR status "+xhr.status;else if(xhr.responseText==="")if("withCredentials"in new XMLHttpRequest&&(new XMLHttpRequest).withCredentials===false&&window.location.protocol==="file:")error="XMLHttpRequest failure, possibly due to a same-origin policy violation. You can try loading this page in another browser, or load it from http://localhost using a local webserver. See the Processing.js README for a more detailed explanation of this problem and solutions.";else error="File is empty.";callback(xhr.responseText,error)}};xhr.open("GET",url,true);if(xhr.overrideMimeType)xhr.overrideMimeType("application/json");xhr.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT");xhr.send(null)}function loadBlock(index,filename){function callback(block,error){code[index]=block;++loaded;if(error)errors.push(filename+" ==> "+error);if(loaded===sourcesCount)if(errors.length===0)try{return new Processing(canvas,code.join("\n"))}catch(e){throw"Processing.js: Unable to execute pjs sketch: "+e}else throw"Processing.js: Unable to load pjs sketch files: "+errors.join("\n")}if(filename.charAt(0)==="#"){var scriptElement=document.getElementById(filename.substring(1));if(scriptElement)callback(scriptElement.text||scriptElement.textContent);else callback("","Unable to load pjs sketch: element with id '"+filename.substring(1)+"' was not found");return}ajaxAsync(filename,callback)}for(var i=0;i<sourcesCount;++i)loadBlock(i,sources[i])};var init=function(){document.removeEventListener("DOMContentLoaded",init,false);processingInstances=[];var canvas=document.getElementsByTagName("canvas"),filenames;for(var i=0,l=canvas.length;i<l;i++){var processingSources=canvas[i].getAttribute("data-processing-sources");if(processingSources===null){processingSources=canvas[i].getAttribute("data-src");if(processingSources===null)processingSources=canvas[i].getAttribute("datasrc")}if(processingSources){filenames=processingSources.split(/\s+/g);for(var j=0;j<filenames.length;)if(filenames[j])j++;else filenames.splice(j,1);loadSketchFromSources(canvas[i],filenames)}}var s,last,source,instance,nodelist=document.getElementsByTagName("script"),scripts=[];for(s=nodelist.length-1;s>=0;s--)scripts.push(nodelist[s]);for(s=0,last=scripts.length;s<last;s++){var script=scripts[s];if(!script.getAttribute)continue;var type=script.getAttribute("type");if(type&&(type.toLowerCase()==="text/processing"||type.toLowerCase()==="application/processing")){var target=script.getAttribute("data-processing-target");canvas=undef;if(target)canvas=document.getElementById(target);else{var nextSibling=script.nextSibling;while(nextSibling&&nextSibling.nodeType!==1)nextSibling=nextSibling.nextSibling;if(nextSibling&&nextSibling.nodeName.toLowerCase()==="canvas")canvas=nextSibling}if(canvas){if(script.getAttribute("src")){filenames=script.getAttribute("src").split(/\s+/);loadSketchFromSources(canvas,filenames);continue}source=script.textContent||script.text;instance=new Processing(canvas,source)}}}};Processing.reload=function(){if(processingInstances.length>0)for(var i=processingInstances.length-1;i>=0;i--)if(processingInstances[i])processingInstances[i].exit();init()};Processing.loadSketchFromSources=loadSketchFromSources;Processing.disableInit=function(){if(isDOMPresent)document.removeEventListener("DOMContentLoaded",init,false)};if(isDOMPresent){window["Processing"]=Processing;document.addEventListener("DOMContentLoaded",init,false)}else this.Processing=Processing})(window,window.document,Math)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../node_modules/processing.js","/../node_modules")},{__browserify_process:1,__browserify_buffer:2}],6:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var buzz,names,sounds,res$,i$,len$,name,current_bg_music,this$=this;buzz=require("buzz");names=["1up","beam_in","dead","disappearing_block","enemy_hit","health","hurt","land","pause","power_up","shoot","shot_blocked","title","hardman","stage_select"];res$={};for(i$=0,len$=names.length;i$<len$;++i$){name=names[i$];res$[name]=new buzz.sound("sound/"+name,{formats:["wav","mp3"]})}sounds=res$;global.play=function(sound){var x$;x$=sounds[sound];x$.play();x$.setTime(0);return x$};current_bg_music=void 8;global.bg_music=function(sound){if(current_bg_music!=null){current_bg_music.stop()}current_bg_music=play(sound).loop().setVolume(40);return log(current_bg_music)}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/sound/sound.js","/sound")},{viclib:5,buzz:3,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],8:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.get_around=function(x,y){return tree.get(x-16/2,y-16/2,x+16/2,y+16/2)};global.has_solid=function(x,y){return!empty(filter(function(it){return it.solid},get_around(x,y)))};global.has_stair=function(x,y){return!empty(filter(function(it){return it.is_stair},get_around(x,y)))};global.object=mixin(function(){var ref$,this$=this;defer(function(){return tree.add(this$,this$.pos.x,this$.pos.y)});return{dir:void 8,size:(ref$=this.size)!=null?ref$:v3(16,16,0),pos:(ref$=this.pos)!=null?ref$:v3(0,0,0),vel:(ref$=this.vel)!=null?ref$:v3(0,0,0),hp:(ref$=this.hp)!=null?ref$:24,dynamic:true,solid:false,ghost:false,floats:false,is_immune:just(false),type:"missingty",side:(ref$=this.side)!=null?ref$:"bad",draw:function(screen){var spr;global.drw++;if(this$.is_immune()&&blink(.2)){return}if(this$.sprite!=null){spr=sprite("objects/"+this$.type+"/sprites/"+this$.sprite+(this$.dir!=null&&this$.dir===1?"_r":"")+".png");return draw_sprite(spr,this$.pos.x,this$.pos.y)}else{screen.fill(222,222,222);return screen.rect(this$.pos.x-this$.size.x/2,this$.pos.y-this$.size.y/2,this$.size.x,this$.size.y)}},destroy:function(){return defer(function(){return tree.remove(this$)})},tick:function(dt){var near_objects,i$,len$,near;if(this$.hp<=0){return this$.destroy()}this$.pos.x+=this$.vel.x*dt;this$.pos.y+=this$.vel.y*dt;if(!this$.floats){this$.pos.y+=.5*G*dt*dt;this$.vel.y+=G*dt}this$.is_grounded=just(false);near_objects=tree.get(this$.pos.x-16*2,this$.pos.y-16*2,this$.pos.x+16*2,this$.pos.y+16*2);for(i$=0,len$=near_objects.length;i$<len$;++i$){near=near_objects[i$];if(near!==this$&&(near.dynamic||near.solid)){this$.check_collision(near)}}if(this$.pos.x!==this$.old_pos.x||this$.pos.y!==this$.old_pos.y){tree.add(this$,this$.pos.x,this$.pos.y)}this$.old_pos.x=this$.pos.x;return this$.old_pos.y=this$.pos.y},check_collision:function(b){var a,abs,ax,aw,axi,axf,ay,ah,ayi,ayf,bx,bw,bxi,bxf,by,bh,byi,byf,dx,dy,av,avx,avy;a=this$;abs=Math.abs;ax=a.pos.x;aw=a.size.x/2;axi=ax-aw;axf=ax+aw;ay=a.pos.y;ah=a.size.y/2;ayi=ay-ah;ayf=ay+ah;bx=b.pos.x;bw=b.size.x/2;bxi=bx-bw;bxf=bx+bw;by=b.pos.y;bh=b.size.y/2;byi=by-bh;byf=by+bh;dx=abs(bx-ax)-(aw+bw);dy=abs(by-ay)-(ah+bh);if(dx>=0||dy>=0){return false}if(!this$.ghost&&b.solid){av=a.vel;avx=av.x;avy=av.y;if(dx>dy){if(bxi<axi&&axi<bxf&&avx<=0){a.pos.x+=bxf-axi;a.vel.x=0}if(bxi<axf&&axf<bxf&&avx>=0){a.pos.x+=bxi-axf;a.vel.x=0}}else{if(byi<ayi&&ayi<byf&&avy<=0){a.pos.y+=-dy;a.vel.y=0}if(byi<ayf&&ayf<byf&&avy>=0){a.pos.y+=dy;a.vel.y=0;this$.is_grounded=just(true)}}}if(typeof a.collide==="function"){a.collide(b)}return true},collide:function(it){if(it.dmg!=null&&it.side!==this$.side&&it.dmg>0){return this$.hurt(it.dmg)}},hurt:function(dmg){if(!this$.is_immune()){this$.hp-=dmg}if(this$!==hero){return play("enemy_hit")}},shot:function(type,attrs){var ref$;return type((ref$=import$({pos:v3(this$.pos.x+16*this$.dir,this$.pos.y,0)},attrs),ref$.side=this$.side,ref$.owner=this$,ref$))},age:chronometer(),old_pos:v3(0,0,0),dir_to:function(it){return v3(it.x-this$.pos.x,it.y-this$.pos.y,0).normalize()}}});function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/object.js","/objects")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],23:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.stage=mixin(function(){var this$=this;return{stage_map:["................................................","..........o...o..o....ooo......o...o............","..........o...o......o.........o...o............","..........o...o..o..o..........o...o............","..........o...o..o..o.......o.........o.........","...........o.o...o...o.......oo.....oo..........","............o....o....ooo......ooooo............","................................................","................................................","................................................","................................................","................................................","......................M.........................","oooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooo"],music:"hardman",objects:{o:ground,M:mememan,B:bee_queen,X:bar,h:stair,T:trapdoor,m:macer,H:stair},create:function(){var stage_map,objects_at,has_at,i$,to$,y,lresult$,j$,to1$,x,lresult1$,k$,ref$,len$,obj,border_type,results$=[];log(this$);bg_music(this$.music);stage_map=map(function(it){return it.split("")},this$.stage_map);objects_at=function(x,y){var obj,ref$;obj=this$.objects[(ref$=stage_map[y])!=null?ref$[x]:void 8];if(obj!=null){return[].concat(obj)}else{return[]}};has_at=function(type,x,y){return in$(type,objects_at(x,y))};for(i$=0,to$=stage_map.length;i$<to$;++i$){y=i$;lresult$=[];for(j$=0,to1$=stage_map[y].length;j$<to1$;++j$){x=j$;lresult1$=[];for(k$=0,len$=(ref$=objects_at(x,y)).length;k$<len$;++k$){obj=ref$[k$];border_type=!has_at(obj,x+1,y)&&!has_at(obj,x+1,y-1)&&!has_at(obj,x,y-1)?"TopRight":!has_at(obj,x,y-1)&&!has_at(obj,x-1,y-1)&&!has_at(obj,x-1,y)?"TopLeft":!has_at(obj,x-1,y)&&!has_at(obj,x-1,y+1)&&!has_at(obj,x,y+1)?"BottomLeft":!has_at(obj,x,y+1)&&!has_at(obj,x+1,y+1)&&!has_at(obj,x+1,y)?"BottomRight":!has_at(obj,x+1,y)?"Right"+y%2:!has_at(obj,x,y-1)?"Top"+(x+1+y%2)%2:!has_at(obj,x-1,y)?"Left"+y%2:!has_at(obj,x,y+1)?"Bottom"+x%2:"Center"+(x%2+y%2*2);lresult1$.push(typeof obj==="function"?obj({border_type:border_type},{pos:v3(x*B,y*B,0)}):void 8)}lresult$.push(lresult1$)}results$.push(lresult$)}return results$}}});function in$(x,arr){var i=-1,l=arr.length>>>0;while(++i<l)if(x===arr[i]&&i in arr)return true;return false}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/stages/stage.js","/stages")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],28:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var $,processingjs,REFRESH_ELEMENTS,was_removed,track,fns,slice$=[].slice;$=require("jquery-browserify");processingjs=require("processing");window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(it){return setTimeout(it,1e3/60)};REFRESH_ELEMENTS=[];window.body=$("body");window.mousex=0;window.mousey=0;window.scrw=window.innerWidth;window.scrh=window.innerHeight;was_removed=function(element){return!$.contains(document.documentElement,element[0])};track=function(obj){var x$;if(!in$(obj,REFRESH_ELEMENTS)){x$=obj;x$.css({position:"fixed"});x$.data("box",{});return REFRESH_ELEMENTS.splice(0,0,obj)}};$("*").css({margin:0,padding:0});$.refresh_boxes=function(){var untrack_indexes,index,ref$,obj,parent,parent_x,ref1$,parent_y,obj_box,box,key,val,results$=[];untrack_indexes=[];for(index in ref$=REFRESH_ELEMENTS){obj=ref$[index];if(was_removed(obj)){untrack_indexes=untrack_indexes.concat(index)}parent=obj.parent();parent_x=parent!=null?(ref1$=parent.position())!=null?ref1$.left:void 8:void 8;parent_y=parent!=null?(ref1$=parent.position())!=null?ref1$.top:void 8:void 8;obj_box=typeof obj_box==="function"?obj.data("box").apply(obj):obj.data("box");box={};for(key in obj_box){val=obj_box[key];box[key]=typeof obj_box[key]==="function"?obj_box[key].apply(obj):obj_box[key]}if(box.x!=null){obj.css({left:parent_x+box.x})}if(box.X!=null){obj.css({width:parent_x+box.X-obj.x()})}if(box.y!=null){obj.css({top:parent_y+box.y})}if(box.Y!=null){obj.css({height:parent_y+box.Y-obj.y()})}if(box.w!=null){obj.css({width:box.w})}if(box.h!=null){results$.push(obj.css({height:box.h}))}}return results$};$(window).mousemove(function(it){window.mousex=it.pageX;return window.mousey=it.pageY});$(window).resize(function(){window.SCRW=window.innerWidth;return window.SCRH=window.innerHeight});setTimeout($.refresh_boxes,10);setTimeout($.refresh_boxes,200);$(window).resize($.refresh_boxes);fns={x:function(it){return it.offset().left},X:function(it){return it.offset().left+it.outerWidth()},y:function(it){return it.offset().top},Y:function(it){return it.offset().top+it.outerHeight()},w:function(it){return it.outerWidth()},h:function(it){return it.outerHeight()}};iter(fns,function(fn,key){return $.fn[key]=function(new_val){track(this);if(new_val==null){return fn(this)}this.data("box")[key]=new_val;return this}});each(function(tag){return window[tag]=function(){var children,id,attrs,ret,key,val;children=slice$.call(arguments);id=typeof children[0]==="string"&&children[0][0]==="#"?children.shift().slice(1):void 8;attrs=children[0].toString()==="[object Object]"?children.shift():{};ret=$("<"+tag+">");for(key in attrs){val=attrs[key];if(key=="click"||key=="keypress"||key=="mousedown"||key=="mouseup"||key=="resize"||key=="select"||key=="submit"||key=="val"||key=="x"||key=="X"||key=="y"||key=="Y"||key=="w"||key=="h"||key=="addClass"||key=="html"||key=="class"||key=="id"||key=="href"||key=="target"){ret[key](val)}else if(in$(key,["class"])){ret.addClass(val)}else if(key=="src"||key=="id"||key=="href"||key=="target"){ret.attr(key,val)
}else{ret.css(key,val)}}if(id!=null){ret.attr("id",id)}each(bind$(ret,"append"),children);return ret}})(["div","span","img","canvas"]);window.processing=function(w,h,fns){var canvas;canvas=$("<canvas/>");fns=typeof fns==="function"?{draw:fns}:fns;new Processing(canvas.get(0),function(processing){processing.setup=function(){processing.size(w,h);return fns.setup.call(processing)};return processing.draw=fns.draw.bind(processing)});return canvas[0]};module.exports=$;function in$(x,arr){var i=-1,l=arr.length>>>0;while(++i<l)if(x===arr[i]&&i in arr)return true;return false}function bind$(obj,key,target){return function(){return(target||obj)[key].apply(obj,arguments)}}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../node_modules/boxes.js","/../node_modules")},{viclib:34,processing:33,"prelude-ls":35,"jquery-browserify":36,__browserify_process:1,__browserify_buffer:2}],29:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){jQuery=require("jquery-browserify");global.key=module.exports=function(){var KEYCODES={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,space:32,page_up:33,"page down":34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"left_window key":91,"right_window key":92,select_key:93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,equal_sign:187,comma:188,dash:189,period:190,forward_slash:191,grave_accent:192,open_bracket:219,backslash:220,closebracket:221,single_quote:222,mouse1:"mouse1",mouse2:"mouse2",mouse3:"mouse3"};var KEYSTRINGS={};for(key in KEYCODES)KEYSTRINGS[KEYCODES[key]]=key;var keydown={};var keypressEvents={};var keyreleaseEvents={};var keydownEvents={};jQuery(document).keydown(function(e){pressKeyProcedure(e)});jQuery(document).keyup(function(e){releaseKeyProcedure(e)});jQuery(document).mousedown(function(e){pressKeyProcedure({keyCode:"mouse"+e.which})});jQuery(document).mouseup(function(e){releaseKeyProcedure({keyCode:"mouse"+e.which})});function releaseKeyProcedure(e){if(keydown[e.keyCode])if(typeof keyreleaseEvents[e.keyCode]!="undefined")keyreleaseEvents[e.keyCode].forEach(function(releaseEvent){releaseEvent(e)});keydown[e.keyCode]=false}function pressKeyProcedure(e){if(!keydown[e.keyCode])if(typeof keypressEvents[e.keyCode]!="undefined")keypressEvents[e.keyCode].forEach(function(pressEvent){pressEvent(e)});keydown[e.keyCode]=true}var mouse_pos=[0,0];jQuery(document).mousemove(function(e){mouse_pos=[e.pageX,e.pageY]});function press(keyCode_or_keyString,callback){var keyCode=keyCode_or_keyString;if(typeof keyCode_or_keyString=="string")keyCode=KEYCODES[keyCode_or_keyString];if(typeof keypressEvents[keyCode]=="undefined")keypressEvents[keyCode]=[];keypressEvents[keyCode].push(callback)}function release(keyCode_or_keyString,callback){var keyCode=keyCode_or_keyString;if(typeof keyCode_or_keyString=="string")keyCode=KEYCODES[keyCode_or_keyString];if(typeof keyreleaseEvents[keyCode]=="undefined")keyreleaseEvents[keyCode]=[];keyreleaseEvents[keyCode].push(callback)}return{release:release,press:press,down:function(key){return keydown[KEYCODES[key]]},up:function(key){return!keydown[KEYCODES[key]]},mouse_pos:function(){return mouse_pos},mouse_x:function(){return mouse_pos[0]},mouse_y:function(){return mouse_pos[1]}}}()})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../node_modules/key.js","/../node_modules")},{"jquery-browserify":36,__browserify_process:1,__browserify_buffer:2}],7:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.camera=mixin(function(){var this$=this;return{pos:v3(0,0,0),scale:window.innerHeight/(16*16),target_y:void 8,width:16*16*window.innerWidth/window.innerHeight,height:16*16,center:v3(8*16,8*16*window.innerWidth/window.innerHeight,0),visible_objects:function(){var c;c=this$.center;return tree.get(c.x-20*B,c.y-10*B,c.x+20*B,c.y+10*B)},tick:function(dt){var ref$;this$.scale=window.innerHeight/(16*16);this$.width=window.innerWidth/this$.scale;this$.center=v3(this$.pos.x,this$.pos.y+this$.height/2);this$.offset={x:-this$.pos.x+window.innerWidth/this$.scale/2,y:-this$.pos.y};if(this$.target_y==null&&((ref$=global.hero)!=null?ref$.pos:void 8)!=null){this$.pos.y=hero.pos.y-16*16;this$.target_y=floor(global.hero.pos.y/(16*16))*16*16}this$.pos.x=global.hero.pos.x;if((typeof hero!="undefined"&&hero!==null?hero.pos.y:void 8)<this$.target_y){this$.target_y-=16*B}if((typeof hero!="undefined"&&hero!==null?hero.pos.y:void 8)>this$.target_y+16*16){this$.target_y+=16*B}if(abs(this$.pos.y-this$.target_y)>8){return this$.pos.y+=(this$.target_y-this$.pos.y)/abs(this$.target_y-this$.pos.y)*12*16*dt}else{return this$.pos.y=this$.target_y}}}})()}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/camera/camera.js","/objects/camera")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],9:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var key;key=require("key");global.enabled_weapons=["normal","poke"];global.mememan=mixin(object,function(){var this$=this;global.hero=this;this.weapons=[{name:"normal",tag:"P",shot:function(){return this$.shot(shot,{dmg:2,side:this$.side,vel:v3(22*16*this$.dir,0,0)})}},{name:"poke",tag:"PM",charge:24,cost:1,shot:function(){this$.shot(pokeball,{pokemon:this$.pokemon,dmg:3,vel:v3(12*16*(this$.dir+this$.pad.x),12*16*(-1+this$.pad.y*1.5),0)});return this$.pokemon=void 8}},{name:"punch",tag:"HM",charge:24,cost:3,shot:function(){return this$.shot(punch,{vel:v3(8*16*this$.dir,6*16*this$.pad.y,0)})}},{name:"",tag:"-"},{name:"",tag:"-"}];return{weapon:this.weapons[0],type:"mememan",sprite:"standing0",floats:false,dynamic:true,lives:3,hp:24,maxhp:24,depth:-1,size:v3(16,25,0),vel:v3(0,0,0),key_a:function(){},climb:function(dir){this$.is_climbing=just(true);this$.just_climbed=true_for(.4);this$.ghost=this$.floats=true;return this$.vel.y=16*4.5*(dir==="down"?1:-1)},fire_weapon:function(){if(this$.is_walking()||this$.is_jumping()||this$.is_climbing()||this$.is_shooting()){global.play("shoot");if(!this$.weapon.cost||this$.weapon.charge>=this$.weapon.cost){this$.weapon.shot();if(this$.weapon.charge!=null){this$.weapon.charge-=this$.weapon.cost}}return this$.is_shooting=true_for(.3)}},stop_jump:function(){if(this$.is_jumping()){return this$.vel.y=0}},slide:function(){if(!this$.is_sliding()){return this$.is_sliding=true_for(.35)}},jump:function(){if(!this$.is_jumping()){if(this$.is_grounded()){this$.vel.y=-23*16}if(this$.is_climbing()){return this$.is_climbing=just(false)}}},hurt:after(this.hurt,function(){if(this$.is_immune()){return}play("hurt");this$.vel.y+=3*16;this$.just_hurt=true_for(.5);return this$.is_immune=true_for(1.2)}),pad:v3(0,0,0),tick:after(this.tick,function(dt){var align;if(this$.pad.x!==0){this$.dir=this$.pad.x}this$.vel.x=function(){switch(false){case!this.just_hurt():return-this.dir*2*16;case!this.is_climbing():return 0;case!this.is_sliding():return this.dir*12*16;case!key.down(key_right):return 16*4.4;case!key.down(key_left):return-16*4.4;default:return 0}}.call(this$);if(this$.is_climbing()){if(!this$.just_climbed()){this$.vel.y=this$.pad.y*16*3}if(this$.pad.x===0&&!this$.is_shooting()){this$.dir=-1+floor(this$.pos.y/16%2)*2}}this$.ghost=this$.floats=this$.is_climbing();if(this$.is_climbing()&&(align=filter(function(it){return it.is_stair},get_around(this$.pos.x,this$.pos.y))[0])){this$.pos.x=align.pos.x}if(this$.is_sliding()&&!this$.has_solid_ahead()&&this$.vel.y===0&&this$.has_solid_over()){this$.ghost=this$.floats=true;this$.is_sliding=true_for(.04)}if(!this$.is_climbing()&&!this$.is_sliding()){if(key.down(key_down)&&has_stair(this$.pos.x,this$.pos.y+16)){this$.climb("down")}else if(key.down(key_up)&&has_stair(this$.pos.x,this$.pos.y-16)){this$.climb("up")}}else if(this$.is_climbing()&&!this$.just_climbed()&&!has_stair(this$.pos.x,this$.pos.y+16/4)){this$.is_climbing=just(false)}this$.sprite=function(){switch(false){case!this.just_hurt():return"hurt";case!this.is_climbing():if(this.is_almost_climbing()){return"climbed"}else{return"climbing"+(this.is_shooting()?"_shooting":"")}break;case!this.is_sliding():return"sliding";case!this.is_standing():if(this.is_shooting()){return"standing_shoot"}else{return"standing"+cycle([0,0,0,0,0,0,0,0,0,1],4)}break;case!this.is_grounded():return(this.is_shooting()?"walking_shoot":"walking")+cycle([0,1,2,1],.5);default:if(this.is_shooting()){return"jumping_shoot"}else{return"jumping"}}}.call(this$);return this$.sprite=this$.weapon.name+"/"+this$.sprite}),dir:1,side:"good",is_sliding:just(false),is_shooting:just(false),is_climbing:just(false),is_digging:just(false),just_hurt:just(false),just_climbed:just(false),is_almost_climbing:function(){return this$.is_climbing()&&!has_stair(this$.pos.x,this$.pos.y-16/4)&&has_stair(this$.pos.x,this$.pos.y+16/4)},is_jumping:function(){return this$.vel.y<0&&!this$.is_climbing()},is_walking:function(){return!this$.is_jumping()&&!this$.is_climbing()&&!this$.is_shooting()},is_stopped:function(){return this$.vel.x===0&&this$.vel.y===0},is_standing:function(){return this$.is_grounded()&&this$.is_stopped()},has_solid_ahead:function(){return has_solid(this$.pos.x+this$.dir*16,this$.pos.y)},has_solid_over:function(){return!empty(filter(function(it){return it.solid},tree.get(this$.pos.x-this$.dir*16*1.1,this$.pos.y-16*1.5,this$.pos.x+this$.dir*16*1.1,this$.pos.y-16*.5)))}}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/mememan/mememan.js","/objects/mememan")},{viclib:5,key:29,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],10:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.macer=mixin(object,function(){var this$=this;return{type:"macer",sprite:"standing0",floats:false,size:v3(24,24,0),hp:18,dmg:4,tick:after(this.tick,function(dt){this$.dir=hero.pos.x>this$.pos.x?1:-1;this$.sprite="standing"+cycle([0,1,2,3],.5);if(Math.random()<.02){return this$.shot(shot,{dmg:2,pos:v3(this$.pos.x+B*this$.dir,this$.pos.y,0),vel:v3(22*B*this$.dir,0,0)})}})}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/macer/macer.js","/objects/macer")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],11:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.bee_queen=mixin(object,function(){var this$=this;return{type:"bee_queen",sprite:"holding",floats:true,deploy_x:void 8,size:v3(24,24,0),hp:32,dmg:4,state_time:chronometer(),state:"waiting_hero",tick:after(this.tick,function(dt){switch(this$.state){case"waiting_hero":if(global.hero!=null){this$.deploy_x=global.hero.pos.x+8*B;this$.state="positioning";return this$.state_time=chronometer()}break;case"positioning":this$.sprite="holding";this$.vel.x=signum(this$.deploy_x-this$.pos.x)*8*B;this$.dir=signum(this$.vel.x);if(abs(this$.deploy_x-this$.pos.x)<4||this$.state_time()>2.2){this$.state="laying";setTimeout(function(){return this$.destroy()},2500);return this$.state_time=chronometer()}break;case"laying":this$.sprite="holding";this$.vel.x=0;if(this$.state_time()>1.5){this$.state="layed";bee({pos:v3(this$.pos.x,this$.pos.y,0),side:this$.side});bee({pos:v3(this$.pos.x-B,this$.pos.y,0),side:this$.side});bee({pos:v3(this$.pos.x+B,this$.pos.y,0),side:this$.side});bee({pos:v3(this$.pos.x,this$.pos.y-B,0),side:this$.side});bee({pos:v3(this$.pos.x,this$.pos.y+B,0),side:this$.side});this$.state_time=chronometer()}return this$.dir=-1;case"layed":this$.sprite="free";if(this$.state_time>1.5){return this$.destroy()}}})}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/bee_queen/bee_queen.js","/objects/bee_queen")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],12:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.bee=mixin(object,function(){var this$=this;return{type:"bee",sprite:"bee",floats:true,deploy_x:void 8,size:v3(12,8,0),hp:2,dmg:3,tick:after(this.tick,function(dt){this$.vel.add(global.hero.pos.clone().sub(this$.pos).multiplyScalar(.1));return this$.vel.normalize().multiplyScalar(6*B)})}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/bee/bee.js","/objects/bee")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],13:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.trapdoor=mixin(object,function(){var this$=this;defer(function(){return this$.pos.x+=.5*B});return{type:"trapdoor",sprite:"trapdoor",side:"bad",floats:true,solid:true,size:v3(2*B,B,0),hp:999,dmg:0,exhausted:just(false),tick:after(this.tick,function(dt){if(abs(hero.pos.x-this$.pos.x)<B&&!this$.exhausted()){trapbite({pos:this$.pos.clone(),side:this$.side});return this$.exhausted=true_for(1)}})}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/trapdoor/trapdoor.js","/objects/trapdoor")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],15:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.hardman=mixin(object,function(){var this$=this;return{type:"hardman",sprite:"holding",deploy_x:void 8,size:v3(26,36,0),hp:200,maxhp:200,dmg:12,state_time:chronometer(),state:"standing",exhausted:just(false),set_state:function(it){this$.state=it;return this$.state_time=chronometer()},draw:after(this.draw,function(){return draw_healthbar(this$.hp/this$.maxhp,30,8,"down",[255,0,0])}),tick:after(this.tick,function(dt){var rnd;this$.dir=signum(hero.pos.x-this$.pos.x);if(this$.hp<=0){enabled_weapons.push("punch");stage_select_mode()}switch(this$.state){case"standing":this$.sprite="standing"+cycle([0,1,2],.6);rnd=Math.random();if(this$.state_time()>.8){if((rnd-=.08)<0){return this$.set_state("shooting")}else if((rnd-=.04)<0){return this$.set_state("soaring")}}break;case"shooting":this$.sprite="shooting"+cycle([0,1,2,3,4],.6);if(!this$.exhausted()){this$.shot(punch,{vel:this$.dir_to(hero.pos).multiplyScalar(12*B)});this$.exhausted=true_for(1.2)}if(Math.random()<.005||this$.state_time()>4){return this$.set_state("standing")}break;case"soaring":this$.sprite="soaring";this$.vel.y=-26*B;if(has_solid(this$.pos.x,this$.pos.y-24)||has_solid(this$.pos.x-24,this$.pos.y-24)){this$.vel.y=0}this$.vel.x=signum(hero.pos.x-this$.pos.x)*168;if(abs(this$.pos.x-hero.pos.x)<B/2){return this$.set_state("turning")}break;case"turning":this$.vel.x=0;if(this$.state_time()<.15){this$.vel.y=0;return this$.sprite="turning0"}else if(this$.state_time()<.3){this$.vel.y=0;return this$.sprite="turning1"}else{this$.vel.y=36*8;return this$.set_state("diving")}break;case"diving":this$.sprite="diving";if(this$.is_grounded()){this$.set_state("buried");if(hero.is_grounded()){log("poxa");log(hero.vel.y);hero.vel.y-=12*B;hero.pos.y-=6;setTimeout(function(){return hero.hurt(6)},100);log(hero.vel.y)}return camera.pos.y-=16}break;case"buried":if(this$.state_time()<.6){return this$.sprite="buried0"}else if(this$.state_time()<2.4){return this$.sprite="buried1"}else{return this$.set_state("standing")}}})}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/hardman/hardman.js","/objects/hardman")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],14:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.trapbite=mixin(object,function(){var this$=this;return{type:"trapbite",sprite:"open",life_time:chronometer(),tick:after(this.tick,function(){if(this$.life_time()>.1){this$.sprite="closed"}if(this$.life_time()>.2){return this$.destroy()}}),vel:v3(0,-8*B,0),size:v3(12,10,0),floats:true,ghost:true,collides:true,depth:1,hp:12,dmg:3}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/trapbite/trapbite.js","/objects/trapbite")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],16:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.rock=mixin(object,function(){return{type:"rock",sprite:"rock",dynamic:false,solid:false}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/rock/rock.js","/objects/rock")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],18:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.pokeball=mixin(object,function(){var this$=this;return{type:"pokeball",sprite:"pokeball",size:v3(8,8,0),is_shot:true,hp:30,locked:false,tick:after(this.tick,function(){if(this$.age()>1.2&&this$.pokemon==null){return this$.destroy()}}),collide:function(it){var key$;if(this$.pokemon!=null){if(it===this$.owner){it.pokemon=this$.pokemon;return this$.destroy()}else if(!this$.locked){(typeof global[key$=this$.pokemon]==="function"?global[key$]({pos:this$.pos.clone().add(v3(0,0,0)),owner:this$.owner}):void 8).side="good";this$.pokemon=void 8;return this$.destroy()}}else if(it.dynamic&&!it.is_shot&&it!==this$.owner){it.destroy();this$.pokemon=it.type;this$.locked=true;log("captured",this$.pokemon);return this$.vel=v3(0,0,0)}}}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/pokeball/pokeball.js","/objects/pokeball")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],17:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.shot=mixin(object,function(){var ref$,this$=this;return{type:"shot",sprite:"shot",tick:after(this.tick,function(){if(this$.age()>1.2){return this$.destroy()}}),is_shot:true,side:(ref$=this.side)!=null?ref$:"bad",size:v3(4,4,0),floats:true,collide:function(it){if(!it.is_shot&&it.side!==this$.side){this$.hp=0}return log(this$.hp)},hp:1,dmg:(ref$=this.dmg)!=null?ref$:2}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/shot/shot.js","/objects/shot")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],19:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.ground=mixin(object,function(){return{type:"ground",sprite:this.border_type,floats:true,solid:true,dynamic:false}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/ground/ground.js","/objects/ground")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],20:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.bar=mixin(object,function(){return{type:"bar",sprite:"bar",dynamic:false,solid:true}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/bar/bar.js","/objects/bar")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],21:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.stair=mixin(object,function(){var this$=this;defer(function(){if(!has_stair(this$.pos.x,this$.pos.y-B)){return this$.solid=true}});return{type:"stair",sprite:"stair",solid:false,dynamic:false,is_stair:true}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/stair/stair.js","/objects/stair")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],22:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.punch=mixin(object,function(){var ref$,this$=this;return{type:"punch",sprite:"punch",tick:after(this.tick,function(){if(this$.age()>1.1){this$.vel=this$.dir_to(this$.owner.pos).multiplyScalar(8*B);if(abs(this$.pos.x-this$.owner.pos.x)<8){this$.destroy()}}if(this$.age()>8){this$.destroy()}return this$.dir=signum(this$.vel.x)}),side:(ref$=this.side)!=null?ref$:"bad",size:v3(6,6,0),floats:true,hp:5,dmg:(ref$=this.dmg)!=null?ref$:3}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/objects/punch/punch.js","/objects/punch")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],24:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var this$=this;global.hardstage=mixin(stage,function(){return{music:"hardman",background:function(){var ref$;if(100<(ref$=camera.pos.y)&&ref$<1700){return sprite("stages/hardstage/sprites/cavern.png")}else{return sprite("stages/hardstage/sprites/mountains.png")}},objects:{o:ground,M:mememan,b:bee_queen,X:bar,h:stair,T:trapdoor,m:macer,H:stair,B:hardman},stage_map:["...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo........................b.....................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..............................................ooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo..T.T.T.T.T.....T.T...T.......T.T......m......oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooo..ooooT.ooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooHoooooooooooooT.ooooooooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooo,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooHoooo,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooH,oooooooooXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooH,oooooooooXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooH,oooooooooXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................oooooooooooooooooooooooooooooooooH,oooooooooXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,oXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,oXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooo,,,,m,,,,,oXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooo,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooo,,B,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","...........................................................................................................................................................................ooooooooooooooooooooooooooooooooooooooooooHoXoHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,XX,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooHoXoHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,XX,,,,,,,,,,,,,,,ooooooooooooooooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,XX,,,,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,XX,,,,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,XX,,,,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,,,,,,,,,,m,,,,,,,,oX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,oooooooooooooooooooX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,,,,,,,,,,,,,,oooooooooooooooooooo,,,,,,,,,,,oooooooooooooooooooX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooX,Hooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,b,,,,,,,,,ooooooooooooooooooooooX,,ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,,,,,,m,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooX,,ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,XX,,,oooooooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooX,,ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooo,,,,,,,,,ooooooooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,m,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooXoooooXoooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,H,oooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,H,oooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,,,,,,,,H,oooooooooooooooooooooooooooooooooo","..........................................................................................................ooooooooooooooooooooooooooooooooo,,,m,,,,,,H,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","..........................................................................................................oooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooH,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooo,,,,,,,,,,oooooooooooooooo,,ooooooooooooooo,,ooH,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooo,,,,,,,,,,ooooooooooo,,,,,,,,,,,,,,,,oooo,,,,,,H,oooooooooooooooooooooooooooooooooo","....................................................................oooooooooooooooooooooooooooooooooo,,,,,,,,,,,,,,,oo,,,,,,,,,,,,,,,,,,,,,,oo,,,,,,H,oooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHooooo,,,,,,,,,,,,,,,b,,,,,,,,,,,,,b,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHooooooo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,m,,,,,,,oooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooooo,,,,,,,,,,,,,,,,,,,,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHooooooooo,,,,,,,,,,,,,m,,,,,oooooooooooooooooooooooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","....................................................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooHoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,,,,,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,,m,,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,oooooH,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooH,,oooooH,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................oooooooooooooooooooooooooooooooooo,,,oooooH,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................oooooooooooooooooooooooooooooooooo,,,oooooH,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................oooooooooooooooooooooooooooooooooo,,,ooo,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................oooooooooooooooooooooooooooooooooo,,,ooo,,,,,,oooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooo.............................................ooooooooooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooX.X..........................................ooooooooooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooX.X..........................................ooooooooooooooooooooooooooooooooooooooooHooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooX.X....................................................................ooooooo,,,,,,,H,,,,ooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooX........................................................................oooo,,,,,,,,,,,,ooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooo.........................................................................oooo,,,,,,,,,,,,ooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooX.........................................................................ooo,,,,,,,,,,,,ooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooX........................................................b................ooo,*,,,,,,,,,,ooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooX..........................................................................ooooT,T,T,oooHooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooo...........................................................................oooooooooooooHooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooXX.................................b............ooooo........oo..............oooooooooooHooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooX...........................................ooooooooo......oooo..............oooooooooooHooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooXX..........................oo.............ooooooooooooo...oooooo.......ooo....oooooo....ooooooooooooooooooooooooooooooooooo","ooooooooooooooooooooooooxx....M..................T.oooo............oooooooooooooo..ooooooT.T.T.oooo..............ooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo","oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo"]}
})()}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/stages/hardstage/hardstage.js","/stages/hardstage")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],26:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var quadtree;quadtree=require("quadtree");global.game_mode=mixin(function(){var refresh_pad,this$=this;global.mode=this;global.tree=quadtree({width:128,height:128});stage.create();camera.pos=hero.pos.clone().add(v3(0,-200,0));key.press(key_down,function(){if(mode===this$){if(this$.paused){return this$.move_cursor(1)}}});key.press(key_a,function(){if(mode===this$){if(this$.paused){play("pause");return this$.paused=false}else{if(key.down(key_down)){return hero.slide()}else{return hero.jump()}}}});refresh_pad=function(){return hero.pad={x:(key.down(key_right)?1:0)+(key.down(key_left)?-1:0),y:(key.down(key_down)?1:0)+(key.down(key_up)?-1:0)}};each(function(it){key.press(it,function(){if(mode===this$&&!this$.paused){return defer(refresh_pad)}});return key.release(it,function(){if(mode===this$&&!this$.paused){return defer(refresh_pad)}})},[key_right,key_left,key_down,key_up]);key.release(key_a,function(){if(mode===this$){if(!this$.paused){return hero.stop_jump()}}});key.press(key_b,function(){if(mode===this$){if(!this$.paused){return hero.fire_weapon()}}});key.press(key_up,function(){if(mode===this$){if(this$.paused){return this$.move_cursor(-1)}}});key.press(key_start,function(){if(mode===this$){play("pause");return this$.paused=!this$.paused}});return{cursor:0,move_cursor:function(it){var ref$;if(this$.paused){return this$.cursor=((this$.cursor+it)%(ref$=hero.weapons.length)+ref$)%ref$}},paused:false,draw:function(screen){var ref$,x,y,X,Y,i,i$,len$,wpn,wpn_x,wpn_y,ref1$,bg,j$,j,visible_objects,dt,obj,dynamic_objects;if(this$.paused){screen.fill(107,8,0);ref$=[0,camera.height*3/4,camera.width,camera.height],x=ref$[0],y=ref$[1],X=ref$[2],Y=ref$[3];screen.rect(0,camera.height*3/4,camera.width,camera.height*1/4);screen.fill(255,255,255);screen.textFont(courier_new);screen.textSize(8);screen.text("Paused!",x+10,y+10);screen.text("Lives: "+hero.lives,X-44,y+10);screen.text("Stuff: "+0,X-44,y+20);i=0;for(i$=0,len$=(ref$=hero.weapons).length;i$<len$;++i$){wpn=ref$[i$];if(in$(wpn.name,enabled_weapons)){wpn_x=x+10+80*floor(i/3);wpn_y=y+20+14*(i%3);if(this$.cursor!==i||blink(.5)){draw_healthbar(((ref1$=wpn.charge)!=null?ref1$:hero.hp)/hero.maxhp,wpn_x+12,wpn_y,"right");screen.fill(255,255,255);screen.text(wpn.tag,wpn_x,wpn_y+7)}if(this$.cursor===i){hero.weapon=wpn}++i}}return}screen.background(222,222,222);bg=stage.background();for(i$=-1;i$<=3;++i$){i=i$;for(j$=-1;j$<=3;++j$){j=j$;screen.image(bg,bg.width*i-hero.pos.x%bg.width,bg.height*j)}}visible_objects=camera.visible_objects();dt=min(now()-global.last_tick,.03);camera.tick(dt);for(i$=0,len$=visible_objects.length;i$<len$;++i$){obj=visible_objects[i$];if(obj.dynamic){obj.tick(dt)}}global.last_tick=now();dynamic_objects=[];for(i$=0,len$=visible_objects.length;i$<len$;++i$){obj=visible_objects[i$];if(!obj.dynamic){obj.draw(screen)}else{dynamic_objects.push(obj)}}for(i$=0,len$=dynamic_objects.length;i$<len$;++i$){obj=dynamic_objects[i$];obj.draw(screen)}draw_healthbar(hero.hp/hero.maxhp,8,8,"down");if(hero.weapon.charge!=null){return draw_healthbar(hero.weapon.charge/hero.maxhp,18,8,"down",[0,0,255])}}}});function in$(x,arr){var i=-1,l=arr.length>>>0;while(++i<l)if(x===arr[i]&&i in arr)return true;return false}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/modes/game_mode/game_mode.js","/modes/game_mode")},{viclib:5,quadtree:37,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],25:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.stage_select_mode=mixin(function(){var select,this$=this;global.mode=this;bg_music("stage_select");this.hero=void 8;select=function(){var stage_info;if(global.mode!==this$){return}stage_info=this$.stages[""+this$.cursor.x+this$.cursor.y];global.stage=stage_info.stage;return game_mode()};key.press(key_a,select);key.press(key_start,select);key.press(key_down,function(){if(global.mode===this$){return log("af",this$.cursor.y++)}});key.press(key_up,function(){if(global.mode===this$){return this$.cursor.y--}});key.press(key_left,function(){if(global.mode===this$){return this$.cursor.x--}});key.press(key_right,function(){if(global.mode===this$){return this$.cursor.x++}});return{stages:{"00":{name:"sparkman",stage:hardstage},10:{name:"snakeman",stage:hardstage},20:{name:"needleman",stage:hardstage},"01":{name:"hardman",stage:hardstage},11:{name:"",stage:hardstage},21:{name:"topman",stage:hardstage},"02":{name:"geminiman",stage:hardstage},12:{name:"magnetman",stage:hardstage},22:{name:"shadowman",stage:hardstage}},cursor:v3(1,1,0),cursor_pos:v3(0,0,0),draw:function(screen){var ref$,ref1$,color,i$,x,lresult$,j$,y,results$=[];this$.cursor.x=(ref$=0>(ref1$=this$.cursor.x)?0:ref1$)<2?ref$:2;this$.cursor.y=(ref$=0>(ref1$=this$.cursor.y)?0:ref1$)<2?ref$:2;this$.pos=v3(camera.width/2-title.width/2,0);this$.cursor_pos=v3(this$.pos.x+18+80*this$.cursor.x,this$.pos.y+32+64*this$.cursor.y);screen.background(44,101,248);screen.background(0,0,0);color=now()%.25<.125?"red":"blue";screen.image(sprite("modes/stage_select_mode/sprites/background.png"),this$.pos.x,this$.pos.y);screen.image(sprite("modes/stage_select_mode/sprites/"+color+"_cursor.png"),this$.cursor_pos.x,this$.cursor_pos.y);screen.image(sprite("modes/stage_select_mode/sprites/look_"+this$.cursor.x+this$.cursor.y+".png"),this$.pos.x+18+10+80*1,this$.pos.y+8+32+64*1);for(i$=0;i$<=2;++i$){x=i$;lresult$=[];for(j$=0;j$<=2;++j$){y=j$;lresult$.push(screen.image(sprite("modes/stage_select_mode/sprites/"+this$.stages[""+x+y].name+".png"),this$.pos.x+18+10+80*x,this$.pos.y+8+32+64*y))}results$.push(lresult$)}return results$}}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/modes/stage_select_mode/stage_select_mode.js","/modes/stage_select_mode")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],27:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){global.title_mode=mixin(function(){var preload,i$,ref$,len$,wpn,spr,this$=this;global.mode=this;bg_music("title");key.press(key_down,function(){if(global.mode===this$){return this$.option="password"}});key.press(key_up,function(){if(global.mode===this$){return this$.option="gamestart"}});key.press(key_start,function(){if(global.mode===this$){return stage_select_mode()}});log("Loading sprites...");preload=map(function(it){return"modes/stage_select_mode/sprites/"+it},["look_00","look_01","look_02","look_10","look_11","look_12","look_20","look_21","look_22"]);for(i$=0,len$=(ref$=["normal","poke"]).length;i$<len$;++i$){wpn=ref$[i$];preload=preload.concat(map(fn$,["climbed","climbed_shooting","climbing","hurt","jumping","jumping_shoot","sliding","standing_shoot","standing0","standing1","walking_shoot0","walking_shoot1","walking_shoot2","walking0","walking1","walking2"]))}preload=preload.concat(map(function(it){return"objects/trapbite/sprites/"+it},["closed","open"]));preload=preload.concat(map(function(it){return"objects/trapdoor/sprites/"+it},["trapdoor"]));preload=preload.concat(map(function(it){return"objects/ground/sprites/"+it},["Bottom0","Bottom1","BottomLeft","BottomRight","Center0","Center1","Center2","Center3","Left0","Left1","Right0","Right1","Top0","Top1","TopLeft","TopRight"]));preload=preload.concat(map(function(it){return"objects/bar/sprites/"+it},["bar"]));preload=preload.concat(map(function(it){return"objects/bee/sprites/"+it},["bee"]));preload=preload.concat(map(function(it){return"objects/bee/sprites/"+it},["free","holding"]));preload=preload.concat(map(function(it){return"objects/macer/sprites/"+it},["standing0","standing1","standing2","standing3","throwing"]));preload=preload.concat(map(function(it){return"objects/macer/sprites/"+it},["standing0","standing1","standing2","standing3","throwing"]));preload=preload.concat(map(function(it){return"objects/rock/sprites/"+it},["rock"]));preload=preload.concat(map(function(it){return"objects/shot/sprites/"+it},["shot"]));preload=preload.concat(map(function(it){return"objects/stair/sprites/"+it},["stair"]));preload=preload.concat(map(function(it){return"modes/stage_select_mode/sprites/"+it},["background","look_00","look_01","look_02","look_10","look_11","look_12","look_20","look_21","look_22","geminiman","hardman","magnetman","needleman","shadowman","snakeman","sparkman","topman","wtfisdisguy"]));for(i$=0,len$=preload.length;i$<len$;++i$){spr=preload[i$];sprite(spr+".png");sprite(spr+"_r.png")}return{draw:function(screen){screen.background(0,0,0);global.title=sprite("modes/title_mode/sprites/background.png");screen.image(title,camera.width/2-title.width/2,0);screen.fill(255,255,255);screen.textFont(courier_new);screen.textSize(4);screen.text("Loading prototype. Press start when the main screen shows up.",0,5);return screen.text("Keys: A/S/D/W = directions, J = jump/select, K = slide, L = start",0,10)}};function fn$(it){return"objects/mememan/sprites/"+wpn+"/"+it}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/modes/title_mode/title_mode.js","/modes/title_mode")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}],35:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){var objToFunc,each,map,filter,reject,partition,find,first,head,tail,last,initial,empty,values,keys,length,cons,append,join,reverse,foldl,fold,foldl1,fold1,foldr,foldr1,unfoldr,andList,orList,any,all,unique,sort,sortBy,compare,sum,product,average,mean,concat,concatMap,listToObj,maximum,minimum,scanl,scan,scanl1,scan1,scanr,scanr1,replicate,take,drop,splitAt,takeWhile,dropWhile,span,breakIt,zip,zipWith,zipAll,zipAllWith,compose,curry,id,flip,fix,lines,unlines,words,unwords,max,min,negate,abs,signum,quot,rem,div,mod,recip,pi,tau,exp,sqrt,ln,pow,sin,tan,cos,asin,acos,atan,atan2,truncate,round,ceiling,floor,isItNaN,even,odd,gcd,lcm,toString$={}.toString,slice$=[].slice;exports.objToFunc=objToFunc=function(obj){return function(key){return obj[key]}};exports.each=each=curry$(function(f,xs){var i$,x,len$;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];f(x)}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];f(x)}}return xs});exports.map=map=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];results$[key]=f(x)}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];res$.push(f(x))}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.filter=filter=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];if(f(x)){results$[key]=x}}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(f(x)){res$.push(x)}}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.reject=reject=curry$(function(f,xs){var type,key,x,res$,i$,len$,result,results$={};if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){for(key in xs){x=xs[key];if(!f(x)){results$[key]=x}}return results$}else{res$=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!f(x)){res$.push(x)}}result=res$;if(type==="String"){return result.join("")}else{return result}}});exports.partition=partition=curry$(function(f,xs){var type,passed,failed,key,x,i$,len$;if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}type=toString$.call(xs).slice(8,-1);if(type==="Object"){passed={};failed={};for(key in xs){x=xs[key];(f(x)?passed:failed)[key]=x}}else{passed=[];failed=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];(f(x)?passed:failed).push(x)}if(type==="String"){passed=passed.join("");failed=failed.join("")}}return[passed,failed]});exports.find=find=curry$(function(f,xs){var i$,x,len$;if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];if(f(x)){return x}}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(f(x)){return x}}}});exports.head=head=exports.first=first=function(xs){if(!xs.length){return}return xs[0]};exports.tail=tail=function(xs){if(!xs.length){return}return xs.slice(1)};exports.last=last=function(xs){if(!xs.length){return}return xs[xs.length-1]};exports.initial=initial=function(xs){if(!xs.length){return}return xs.slice(0,xs.length-1)};exports.empty=empty=function(xs){var x;if(toString$.call(xs).slice(8,-1)==="Object"){for(x in xs){return false}return true}return!xs.length};exports.values=values=function(obj){var i$,x,results$=[];for(i$ in obj){x=obj[i$];results$.push(x)}return results$};exports.keys=keys=function(obj){var x,results$=[];for(x in obj){results$.push(x)}return results$};exports.length=length=function(xs){if(toString$.call(xs).slice(8,-1)==="Object"){xs=values(xs)}return xs.length};exports.cons=cons=curry$(function(x,xs){if(toString$.call(xs).slice(8,-1)==="String"){return x+xs}else{return[x].concat(xs)}});exports.append=append=curry$(function(xs,ys){if(toString$.call(ys).slice(8,-1)==="String"){return xs+ys}else{return xs.concat(ys)}});exports.join=join=curry$(function(sep,xs){if(toString$.call(xs).slice(8,-1)==="Object"){xs=values(xs)}return xs.join(sep)});exports.reverse=reverse=function(xs){if(toString$.call(xs).slice(8,-1)==="String"){return xs.split("").reverse().join("")}else{return xs.slice().reverse()}};exports.fold=fold=exports.foldl=foldl=curry$(function(f,memo,xs){var i$,x,len$;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];memo=f(memo,x)}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];memo=f(memo,x)}}return memo});exports.fold1=fold1=exports.foldl1=foldl1=curry$(function(f,xs){return fold(f,xs[0],xs.slice(1))});exports.foldr=foldr=curry$(function(f,memo,xs){return fold(f,memo,xs.reverse())});exports.foldr1=foldr1=curry$(function(f,xs){xs.reverse();return fold(f,xs[0],xs.slice(1))});exports.unfoldr=exports.unfold=unfoldr=curry$(function(f,b){var that;if((that=f(b))!=null){return[that[0]].concat(unfoldr(f,that[1]))}else{return[]}});exports.andList=andList=function(xs){return fold(function(memo,x){return memo&&x},true,xs)};exports.orList=orList=function(xs){return fold(function(memo,x){return memo||x},false,xs)};exports.any=any=curry$(function(f,xs){if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}return fold(function(memo,x){return memo||f(x)},false,xs)});exports.all=all=curry$(function(f,xs){if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}return fold(function(memo,x){return memo&&f(x)},true,xs)});exports.unique=unique=function(xs){var result,i$,x,len$;result=[];if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];if(!in$(x,result)){result.push(x)}}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!in$(x,result)){result.push(x)}}}if(toString$.call(xs).slice(8,-1)==="String"){return result.join("")}else{return result}};exports.sort=sort=function(xs){return xs.concat().sort(function(x,y){switch(false){case!(x>y):return 1;case!(x<y):return-1;default:return 0}})};exports.sortBy=sortBy=curry$(function(f,xs){if(!xs.length){return[]}return xs.concat().sort(f)});exports.compare=compare=curry$(function(f,x,y){switch(false){case!(f(x)>f(y)):return 1;case!(f(x)<f(y)):return-1;default:return 0}});exports.sum=sum=function(xs){var result,i$,x,len$;result=0;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];result+=x}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result+=x}}return result};exports.product=product=function(xs){var result,i$,x,len$;result=1;if(toString$.call(xs).slice(8,-1)==="Object"){for(i$ in xs){x=xs[i$];result*=x}}else{for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result*=x}}return result};exports.mean=mean=exports.average=average=function(xs){return sum(xs)/length(xs)};exports.concat=concat=function(xss){return fold(append,[],xss)};exports.concatMap=concatMap=curry$(function(f,xs){return concat(map(f,xs))});exports.listToObj=listToObj=function(xs){var result,i$,len$,x;result={};for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];result[x[0]]=x[1]}return result};exports.maximum=maximum=function(xs){return fold1(max,xs)};exports.minimum=minimum=function(xs){return fold1(min,xs)};exports.scan=scan=exports.scanl=scanl=curry$(function(f,memo,xs){var last,x;last=memo;if(toString$.call(xs).slice(8,-1)==="Object"){return[memo].concat(function(){var i$,ref$,results$=[];for(i$ in ref$=xs){x=ref$[i$];results$.push(last=f(last,x))}return results$}())}else{return[memo].concat(function(){var i$,ref$,len$,results$=[];for(i$=0,len$=(ref$=xs).length;i$<len$;++i$){x=ref$[i$];results$.push(last=f(last,x))}return results$}())}});exports.scan1=scan1=exports.scanl1=scanl1=curry$(function(f,xs){return scan(f,xs[0],xs.slice(1))});exports.scanr=scanr=curry$(function(f,memo,xs){xs.reverse();return scan(f,memo,xs).reverse()});exports.scanr1=scanr1=curry$(function(f,xs){xs.reverse();return scan(f,xs[0],xs.slice(1)).reverse()});exports.replicate=replicate=curry$(function(n,x){var result,i;result=[];i=0;for(;i<n;++i){result.push(x)}return result});exports.take=take=curry$(function(n,xs){switch(false){case!(n<=0):if(toString$.call(xs).slice(8,-1)==="String"){return""}else{return[]}break;case!!xs.length:return xs;default:return xs.slice(0,n)}});exports.drop=drop=curry$(function(n,xs){switch(false){case!(n<=0):return xs;case!!xs.length:return xs;default:return xs.slice(n)}});exports.splitAt=splitAt=curry$(function(n,xs){return[take(n,xs),drop(n,xs)]});exports.takeWhile=takeWhile=curry$(function(p,xs){var result,i$,len$,x;if(!xs.length){return xs}if(toString$.call(p).slice(8,-1)!=="Function"){p=objToFunc(p)}result=[];for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!p(x)){break}result.push(x)}if(toString$.call(xs).slice(8,-1)==="String"){return result.join("")}else{return result}});exports.dropWhile=dropWhile=curry$(function(p,xs){var i,i$,len$,x;if(!xs.length){return xs}if(toString$.call(p).slice(8,-1)!=="Function"){p=objToFunc(p)}i=0;for(i$=0,len$=xs.length;i$<len$;++i$){x=xs[i$];if(!p(x)){break}++i}return drop(i,xs)});exports.span=span=curry$(function(p,xs){return[takeWhile(p,xs),dropWhile(p,xs)]});exports.breakIt=breakIt=curry$(function(p,xs){return span(compose$([not$,p]),xs)});exports.zip=zip=curry$(function(xs,ys){var result,i,ref$,len$,zs,j,len1$,z,ref1$;result=[];for(i=0,len$=(ref$=[xs,ys]).length;i<len$;++i){zs=ref$[i];for(j=0,len1$=zs.length;j<len1$;++j){z=zs[j];if(i===0){result.push([])}if((ref1$=result[j])!=null){ref1$.push(z)}}}return result});exports.zipWith=zipWith=curry$(function(f,xs,ys){var i$,ref$,len$,zs,results$=[];if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(!xs.length||!ys.length){return[]}else{for(i$=0,len$=(ref$=zip.call(this,xs,ys)).length;i$<len$;++i$){zs=ref$[i$];results$.push(f.apply(this,zs))}return results$}});exports.zipAll=zipAll=function(){var xss,result,i,len$,xs,j,len1$,x,ref$;xss=slice$.call(arguments);result=[];for(i=0,len$=xss.length;i<len$;++i){xs=xss[i];for(j=0,len1$=xs.length;j<len1$;++j){x=xs[j];if(i===0){result.push([])}if((ref$=result[j])!=null){ref$.push(x)}}}return result};exports.zipAllWith=zipAllWith=function(f){var xss,i$,ref$,len$,xs,results$=[];xss=slice$.call(arguments,1);if(toString$.call(f).slice(8,-1)!=="Function"){f=objToFunc(f)}if(!xss[0].length||!xss[1].length){return[]}else{for(i$=0,len$=(ref$=zipAll.apply(this,xss)).length;i$<len$;++i$){xs=ref$[i$];results$.push(f.apply(this,xs))}return results$}};exports.compose=compose=function(){var funcs;funcs=slice$.call(arguments);return function(){var args,i$,ref$,len$,f;args=arguments;for(i$=0,len$=(ref$=funcs).length;i$<len$;++i$){f=ref$[i$];args=[f.apply(this,args)]}return args[0]}};exports.curry=curry=function(f){return curry$(f)};exports.id=id=function(x){return x};exports.flip=flip=curry$(function(f,x,y){return f(y,x)});exports.fix=fix=function(f){return function(g,x){return function(){return f(g(g)).apply(null,arguments)}}(function(g,x){return function(){return f(g(g)).apply(null,arguments)}})};exports.lines=lines=function(str){if(!str.length){return[]}return str.split("\n")};exports.unlines=unlines=function(strs){return strs.join("\n")};exports.words=words=function(str){if(!str.length){return[]}return str.split(/[ ]+/)};exports.unwords=unwords=function(strs){return strs.join(" ")};exports.max=max=curry$(function(x,y){if(x>y){return x}else{return y}});exports.min=min=curry$(function(x,y){if(x>y){return y}else{return x}});exports.negate=negate=function(x){return-x};exports.abs=abs=Math.abs;exports.signum=signum=function(x){switch(false){case!(x<0):return-1;case!(x>0):return 1;default:return 0}};exports.quot=quot=curry$(function(x,y){return~~(x/y)});exports.rem=rem=curry$(function(x,y){return x%y});exports.div=div=curry$(function(x,y){return Math.floor(x/y)});exports.mod=mod=curry$(function(x,y){var ref$;return(x%(ref$=y)+ref$)%ref$});exports.recip=recip=function(x){return 1/x};exports.pi=pi=Math.PI;exports.tau=tau=pi*2;exports.exp=exp=Math.exp;exports.sqrt=sqrt=Math.sqrt;exports.ln=ln=Math.log;exports.pow=pow=curry$(function(x,y){return Math.pow(x,y)});exports.sin=sin=Math.sin;exports.tan=tan=Math.tan;exports.cos=cos=Math.cos;exports.asin=asin=Math.asin;exports.acos=acos=Math.acos;exports.atan=atan=Math.atan;exports.atan2=atan2=curry$(function(x,y){return Math.atan2(x,y)});exports.truncate=truncate=function(x){return~~x};exports.round=round=Math.round;exports.ceiling=ceiling=Math.ceil;exports.floor=floor=Math.floor;exports.isItNaN=isItNaN=function(x){return x!==x};exports.even=even=function(x){return x%2===0};exports.odd=odd=function(x){return x%2!==0};exports.gcd=gcd=curry$(function(x,y){var z;x=Math.abs(x);y=Math.abs(y);while(y!==0){z=x%y;x=y;y=z}return x});exports.lcm=lcm=curry$(function(x,y){return Math.abs(Math.floor(x/gcd(x,y)*y))});exports.installPrelude=function(target){var ref$;if(!((ref$=target.prelude)!=null&&ref$.isInstalled)){import$(target,exports);target.prelude.isInstalled=true}};exports.prelude=exports;function curry$(f,args){return f.length>1?function(){var params=args?args.concat():[];return params.push.apply(params,arguments)<f.length&&arguments.length?curry$.call(this,f,params):f.apply(this,params)}:f}function in$(x,arr){var i=0,l=arr.length>>>0;while(i<l)if(x===arr[i++])return true;return false}function compose$(fs){return function(){var i,args=arguments;for(i=fs.length;i>0;--i){args=[fs[i-1].apply(this,args)]}return args[0]}}function not$(x){return!x}function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../../node_modules/prelude-ls/prelude.js","/../../node_modules/prelude-ls")},{__browserify_process:1,__browserify_buffer:2}],36:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){(function(root,factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define([],factory)}else{root.returnExports=factory()}})(this,function(){return function(window,undefined){var rootjQuery,readyList,document=window.document,location=window.location,navigator=window.navigator,_jQuery=window.jQuery,_$=window.$,core_push=Array.prototype.push,core_slice=Array.prototype.slice,core_indexOf=Array.prototype.indexOf,core_toString=Object.prototype.toString,core_hasOwn=Object.prototype.hasOwnProperty,core_trim=String.prototype.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,core_rnotwhite=/\S/,core_rspace=/\s+/,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return(letter+"").toUpperCase()},DOMContentLoaded=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready()}else if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}},class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector){return this}if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;doc=context&&context.nodeType?context.ownerDocument||context:document;selector=jQuery.parseHTML(match[1],doc,true);if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){this.attr.call(selector,context,true)}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return core_slice.call(this)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems,name,selector){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;if(name==="find"){ret.selector=this.selector+(this.selector?" ":"")+selector}else if(name){ret.selector=this.selector+"."+name+"("+selector+")"}return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.ready.promise().done(fn);return this},eq:function(i){i=+i;return i===-1?this.slice(i):this.slice(i,i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(core_slice.apply(this,arguments),"slice",core_slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}if(!document.body){return setTimeout(jQuery.ready,1)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return obj==null?String(obj):class2type[core_toString.call(obj)]||"object"},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}var key;for(key in obj){}return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,scripts){var parsed;if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){scripts=context;context=0}context=context||document;if(parsed=rsingleTag.exec(data)){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts?null:[]);return jQuery.merge([],(parsed.cacheable?jQuery.clone(parsed.fragment):parsed.fragment).childNodes)},parseJSON:function(data){if(!data||typeof data!=="string"){return null}data=jQuery.trim(data);if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return new Function("return "+data)()}jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&core_rnotwhite.test(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(obj,callback,args){var name,i=0,length=obj.length,isObj=length===undefined||jQuery.isFunction(obj);if(args){if(isObj){for(name in obj){if(callback.apply(obj[name],args)===false){break}}}else{for(;i<length;){if(callback.apply(obj[i++],args)===false){break}}}}else{if(isObj){for(name in obj){if(callback.call(obj[name],name,obj[name])===false){break}}}else{for(;i<length;){if(callback.call(obj[i],i,obj[i++])===false){break}}}}return obj},trim:core_trim&&!core_trim.call("﻿ ")?function(text){return text==null?"":core_trim.call(text)}:function(text){return text==null?"":text.toString().replace(rtrim,"")},makeArray:function(arr,results){var type,ret=results||[];if(arr!=null){type=jQuery.type(arr);if(arr.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(arr)){core_push.call(ret,arr)
}else{jQuery.merge(ret,arr)}}return ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf){return core_indexOf.call(arr,elem,i)}len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i}}}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if(typeof l==="number"){for(;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;inv=!!inv;for(;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&(length>0&&elems[0]&&elems[length-1]||length===0||jQuery.isArray(elems));if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(key in elems){value=callback(elems[key],key,arg);if(value!=null){ret[ret.length]=value}}}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=core_slice.call(arguments,2);proxy=function(){return fn.apply(context,args.concat(core_slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,fn,key,value,chainable,emptyGet,pass){var exec,bulk=key==null,i=0,length=elems.length;if(key&&typeof key==="object"){for(i in key){jQuery.access(elems,fn,i,key[i],1,emptyGet,value)}chainable=1}else if(value!==undefined){exec=pass===undefined&&jQuery.isFunction(value);if(bulk){if(exec){exec=fn;fn=function(elem,key,value){return exec.call(jQuery(elem),value)}}else{fn.call(elems,value);fn=null}}if(fn){for(;i<length;i++){fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass)}}chainable=1}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready,1)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else{document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);var top=false;try{top=window.frameElement==null&&document.documentElement}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}jQuery.ready()}})()}}}return readyList.promise(obj)};jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});rootjQuery=jQuery(document);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.split(core_rspace),function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"&&(!options.unique||!self.has(arg))){list.push(arg)}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return jQuery.inArray(fn,list)>-1},empty:function(){list=[];return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){args=args||[];args=[context,args.slice?args.slice():args];if(list&&(!fired||stack)){if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=fns[i];deferred[tuple[1]](jQuery.isFunction(fn)?function(){var returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[action+"With"](this===deferred?newDefer:this,[returned])}}:newDefer[action])});fns=null}).promise()},promise:function(obj){return typeof obj==="object"?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=list.fire;deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?core_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!--remaining){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});jQuery.support=function(){var support,all,a,select,opt,input,fragment,eventName,i,isSupported,clickFn,div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];a.style.cssText="top:1px;float:left;opacity:.5";if(!all||!all.length||!a){return{}}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:div.firstChild.nodeType===3,tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:a.getAttribute("href")==="/a",opacity:/^0.5/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:input.value==="on",optSelected:opt.selected,getSetAttribute:div.className!=="t",enctype:!!document.createElement("form").enctype,html5Clone:document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:document.compatMode==="CSS1Compat",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",clickFn=function(){support.noCloneEvent=false});div.cloneNode(true).fireEvent("onclick");div.detachEvent("onclick",clickFn)}input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.lastChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;support.appendChecked=input.checked;fragment.removeChild(input);fragment.appendChild(div);if(div.attachEvent){for(i in{submit:true,change:true,focusin:true}){eventName="on"+i;isSupported=eventName in div;if(!isSupported){div.setAttribute(eventName,"return;");isSupported=typeof div[eventName]==="function"}support[i+"Bubbles"]=isSupported}}jQuery(function(){var container,div,tds,marginDiv,divReset="padding:0;margin:0;border:0;display:block;overflow:hidden;",body=document.getElementsByTagName("body")[0];if(!body){return}container=document.createElement("div");container.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";body.insertBefore(container,body.firstChild);div=document.createElement("div");container.appendChild(div);div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");tds[0].style.cssText="padding:0;margin:0;border:0;display:none";isSupported=tds[0].offsetHeight===0;tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&tds[0].offsetHeight===0;div.innerHTML="";div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";support.boxSizing=div.offsetWidth===4;support.doesNotIncludeMarginInBodyOffset=body.offsetTop!==1;if(window.getComputedStyle){support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";support.boxSizingReliable=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";marginDiv=document.createElement("div");marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";div.appendChild(marginDiv);support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)}if(typeof div.style.zoom!=="undefined"){div.innerHTML="";div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1";support.inlineBlockNeedsLayout=div.offsetWidth===3;div.style.display="block";div.style.overflow="visible";div.innerHTML="<div></div>";div.firstChild.style.width="5px";support.shrinkWrapBlocks=div.offsetWidth!==3;container.style.zoom=1}body.removeChild(container);container=div=tds=marginDiv=null});fragment.removeChild(div);all=a=select=opt=input=fragment=div=null;return support}();var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||!pvt&&!cache[id].data)&&getByName&&data===undefined){return}if(!id){if(isNode){elem[internalKey]=id=jQuery.deletedIds.pop()||++jQuery.uuid}else{id=internalKey}}if(!cache[id]){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(getByName){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,i,l,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}for(i=0,l=name.length;i<l;i++){delete thisCache[name[i]]}if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache)){return}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}if(isNode){jQuery.cleanData([elem],true)}else if(jQuery.support.deleteExpando||cache!=cache.window){delete cache[id]}else{cache[id]=null}},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==true&&elem.getAttribute("classid")===noData}});jQuery.fn.extend({data:function(key,value){var parts,part,attr,name,l,elem=this[0],i=0,data=null;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){attr=elem.attributes;for(l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(elem,name,data[name])}}jQuery._data(elem,"parsedAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}parts=key.split(".",2);parts[1]=parts[1]?"."+parts[1]:"";part=parts[1]+"!";return jQuery.access(this,function(value){if(value===undefined){data=this.triggerHandler("getData"+part,[parts[0]]);if(data===undefined&&elem){data=jQuery.data(elem,key);data=dataAttr(elem,key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}parts[1]=value;this.each(function(){var self=jQuery(this);self.triggerHandler("setData"+part,parts);jQuery.data(this,key,value);self.triggerHandler("changeData"+part,parts)})},null,value,arguments.length>1,null,false)},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery.removeData(elem,type+"queue",true);jQuery.removeData(elem,key,true)})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var nodeHook,boolHook,fixSpecified,rclass=/[\t\r\n]/g,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea|)$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classNames,i,l,elem,setClass,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(value&&typeof value==="string"){classNames=value.split(core_rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1){if(!elem.className&&classNames.length===1){elem.className=value}else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++){if(!~setClass.indexOf(" "+classNames[c]+" ")){setClass+=classNames[c]+" "}}elem.className=jQuery.trim(setClass)}}}}return this},removeClass:function(value){var removes,className,elem,c,cl,i,l;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(value&&typeof value==="string"||value===undefined){removes=(value||"").split(core_rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=removes.length;c<cl;c++){while(className.indexOf(" "+removes[c]+" ")>-1){className=className.replace(" "+removes[c]+" "," ")}}elem.className=value?jQuery.trim(className):""}}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(core_rspace);while(className=classNames[i++]){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className)}}else if(type==="undefined"||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1){return true}}return false},val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val,self=jQuery(this);if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,self.val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,i,max,option,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0){return null}i=one?index:0;max=one?index+1:options.length;for(;i<max;i++){option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}if(one&&!values.length&&options.length){return jQuery(options[index]).val()}return values},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length){elem.selectedIndex=-1}return values}}},attrFn:{},attr:function(elem,name,value,pass){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(pass&&jQuery.isFunction(jQuery.fn[name])){return jQuery(elem)[name](value)}if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value)}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return}else if(hooks&&"set"in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,""+value);return value}}else if(hooks&&"get"in hooks&&notxml&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=elem.getAttribute(name);return ret===null?undefined:ret}},removeAttr:function(elem,value){var propName,attrNames,name,isBool,i=0;if(value&&elem.nodeType===1){attrNames=value.split(core_rspace);for(;i<attrNames.length;i++){name=attrNames[i];if(name){propName=jQuery.propFix[name]||name;isBool=rboolean.test(name);if(!isBool){jQuery.attr(elem,name,"")}elem.removeAttribute(getSetAttribute?name:propName);if(isBool&&propName in elem){elem[propName]=false}}}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode){jQuery.error("type property can't be changed")}else if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}},value:{get:function(elem,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.get(elem,name)}return name in elem?elem.value:null},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.set(elem,value,name)}elem.value=value}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{return elem[name]=value}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{return elem[name]}}},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}});boolHook={get:function(elem,name){var attrNode,property=jQuery.prop(elem,name);return property===true||typeof property!=="boolean"&&(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false){jQuery.removeAttr(elem,name)}else{propName=jQuery.propFix[name]||name;if(propName in elem){elem[propName]=true}elem.setAttribute(name,name.toLowerCase())}return name}};if(!getSetAttribute){fixSpecified={name:true,id:true,coords:true};nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&(fixSpecified[name]?ret.value!=="":ret.specified)?ret.value:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret)}return ret.value=value+""}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})});jQuery.attrHooks.contenteditable={get:nodeHook.get,set:function(elem,value,name){if(value===""){value="false"}nodeHook.set(elem,value,name)}}}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||undefined},set:function(elem,value){return elem.style.cssText=""+value}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}})}if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding"}if(!jQuery.support.checkOn){jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}})}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}})});var rformElems=/^(?:textarea|input|select)$/i,rtypenamespace=/^([^\.]*|)(?:\.(.+)|)$/,rhoverHack=/(?:^|\s)hover(\.\S+|)\b/,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,hoverHack=function(events){return jQuery.event.special.hover?events:events.replace(rhoverHack,"mouseenter$1 mouseleave$1")};jQuery.event={add:function(elem,types,handler,data,selector){var elemData,eventHandle,events,t,tns,type,namespaces,handleObj,handleObjIn,handlers,special;if(elem.nodeType===3||elem.nodeType===8||!types||!handler||!(elemData=jQuery._data(elem))){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}events=elemData.events;if(!events){elemData.events=events={}}eventHandle=elemData.handle;if(!eventHandle){elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=jQuery.trim(hoverHack(types)).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=tns[1];namespaces=(tns[2]||"").split(".").sort();special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:tns[1],data:data,handler:handler,guid:handler.guid,selector:selector,namespace:namespaces.join(".")},handleObjIn);handlers=events[type];if(!handlers){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,selector,mappedTypes){var t,tns,type,origType,namespaces,origCount,j,events,special,eventType,handleObj,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return}types=jQuery.trim(hoverHack(types||"")).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=origType=tns[1];namespaces=tns[2];if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;eventType=events[type]||[];origCount=eventType.length;namespaces=namespaces?new RegExp("(^|\\.)"+namespaces.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(j=0;j<eventType.length;j++){handleObj=eventType[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!namespaces||namespaces.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){eventType.splice(j--,1);if(handleObj.selector){eventType.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(eventType.length===0&&origCount!==eventType.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery.removeData(elem,"events",true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(event,data,elem,onlyHandlers){if(elem&&(elem.nodeType===3||elem.nodeType===8)){return}var cache,exclusive,i,cur,old,ontype,special,handle,eventPath,bubbleType,type=event.type||event,namespaces=[];if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type]){return}event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.isTrigger=true;event.exclusive=exclusive;event.namespace=namespaces.join(".");
event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;ontype=type.indexOf(":")<0?"on"+type:"";if(!elem){cache=jQuery.cache;for(i in cache){if(cache[i].events&&cache[i].events[type]){jQuery.event.trigger(event,data,cache[i].handle.elem,true)}}return}event.result=undefined;if(!event.target){event.target=elem}data=data!=null?jQuery.makeArray(data):[];data.unshift(event);special=jQuery.event.special[type]||{};if(special.trigger&&special.trigger.apply(elem,data)===false){return}eventPath=[[elem,special.bindType||type]];if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;cur=rfocusMorph.test(bubbleType+type)?elem:elem.parentNode;for(old=elem;cur;cur=cur.parentNode){eventPath.push([cur,bubbleType]);old=cur}if(old===(elem.ownerDocument||document)){eventPath.push([old.defaultView||old.parentWindow||window,bubbleType])}}for(i=0;i<eventPath.length&&!event.isPropagationStopped();i++){cur=eventPath[i][0];event.type=eventPath[i][1];handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(elem.ownerDocument,data)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&(type!=="focus"&&type!=="blur"||event.target.offsetWidth!==0)&&!jQuery.isWindow(elem)){old=elem[ontype];if(old){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(old){elem[ontype]=old}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event||window.event);var i,j,cur,ret,selMatch,matched,matches,handleObj,sel,related,handlers=(jQuery._data(this,"events")||{})[event.type]||[],delegateCount=handlers.delegateCount,args=[].slice.call(arguments),run_all=!event.exclusive&&!event.namespace,special=jQuery.event.special[event.type]||{},handlerQueue=[];args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}if(delegateCount&&!(event.button&&event.type==="click")){for(cur=event.target;cur!=this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){selMatch={};matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector;if(selMatch[sel]===undefined){selMatch[sel]=jQuery(sel,this).index(cur)>=0}if(selMatch[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,matches:matches})}}}}if(handlers.length>delegateCount){handlerQueue.push({elem:this,matches:handlers.slice(delegateCount)})}for(i=0;i<handlerQueue.length&&!event.isPropagationStopped();i++){matched=handlerQueue[i];event.currentTarget=matched.elem;for(j=0;j<matched.matches.length&&!event.isImmediatePropagationStopped();j++){handleObj=matched.matches[j];if(run_all||!event.namespace&&!handleObj.namespace||event.namespace_re&&event.namespace_re.test(handleObj.namespace)){event.data=handleObj.data;event.handleObj=handleObj;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,originalEvent=event,fixHook=jQuery.event.fixHooks[event.type]||{},copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=jQuery.Event(originalEvent);for(i=copy.length;i;){prop=copy[--i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this)){this.onbeforeunload=eventHandle}},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle){this.onbeforeunload=null}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.event.handle=jQuery.event.dispatch;jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]==="undefined"){elem[name]=null}elem.detachEvent(name,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj,selector=handleObj.selector;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"_submit_attached")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true});jQuery._data(form,"_submit_attached",true)}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false}jQuery.event.simulate("change",this,event,true)})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"_change_attached")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});jQuery._data(elem,"_change_attached",true)}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||elem.type!=="radio"&&elem.type!=="checkbox"){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName)}}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},live:function(types,data,fn){jQuery(this.context).on(types,this.selector,data,fn);return this},die:function(types,fn){jQuery(this.context).off(types,this.selector||"**",fn);return this},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length==1?this.off(selector,"**"):this.off(types,selector||"**",fn)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0]){return jQuery.event.trigger(type,data,this[0],true)}},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery._data(this,"lastToggle"+fn.guid)||0)%i;jQuery._data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length){args[i++].guid=guid}return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)};if(rkeyEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.keyHooks}if(rmouseEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.mouseHooks}});(function(window,undefined){var dirruns,cachedruns,assertGetIdNotName,Expr,getText,isXML,contains,compile,sortOrder,hasDuplicate,baseHasDuplicate=true,strundefined="undefined",expando=("sizcache"+Math.random()).replace(".",""),document=window.document,docElem=document.documentElement,done=0,slice=[].slice,push=[].push,markFunction=function(fn,value){fn[expando]=value||true;return fn},createCache=function(){var cache={},keys=[];return markFunction(function(key,value){if(keys.push(key)>Expr.cacheLength){delete cache[keys.shift()]}return cache[key]=value},cache)},classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),operators="([*^$|!~]?=)",attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:"+operators+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+attributes+")|[^:]|\\\\.)*|.*))\\)|)",pos=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([\\x20\\t\\r\\n\\f>+~])"+whitespace+"*"),rpseudo=new RegExp(pseudos),rquickExpr=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rnot=/^:not/,rsibling=/[\x20\t\r\n\f]*[+~]/,rendsWithNot=/:not\($/,rheader=/h\d/i,rinputs=/input|select|textarea|button/i,rbackslash=/\\(?!\\)/g,matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),NAME:new RegExp("^\\[name=['\"]?("+characterEncoding+")['\"]?\\]"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),POS:new RegExp(pos,"ig"),needsContext:new RegExp("^"+whitespace+"*[>+~]|"+pos,"i")},assert=function(fn){var div=document.createElement("div");try{return fn(div)}catch(e){return false}finally{div=null}},assertTagNameNoComments=assert(function(div){div.appendChild(document.createComment(""));return!div.getElementsByTagName("*").length}),assertHrefNotNormalized=assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild&&typeof div.firstChild.getAttribute!==strundefined&&div.firstChild.getAttribute("href")==="#"}),assertAttributes=assert(function(div){div.innerHTML="<select></select>";var type=typeof div.lastChild.getAttribute("multiple");return type!=="boolean"&&type!=="string"}),assertUsableClassName=assert(function(div){div.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!div.getElementsByClassName||!div.getElementsByClassName("e").length){return false}div.lastChild.className="e";return div.getElementsByClassName("e").length===2}),assertUsableName=assert(function(div){div.id=expando+0;div.innerHTML="<a name='"+expando+"'></a><div name='"+expando+"'></div>";docElem.insertBefore(div,docElem.firstChild);var pass=document.getElementsByName&&document.getElementsByName(expando).length===2+document.getElementsByName(expando+0).length;assertGetIdNotName=!document.getElementById(expando);docElem.removeChild(div);return pass});try{slice.call(docElem.childNodes,0)[0].nodeType}catch(e){slice=function(i){var elem,results=[];for(;elem=this[i];i++){results.push(elem)}return results}}function Sizzle(selector,context,results,seed){results=results||[];context=context||document;var match,elem,xml,m,nodeType=context.nodeType;if(nodeType!==1&&nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}xml=isXML(context);if(!xml&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,slice.call(context.getElementsByTagName(selector),0));return results}else if((m=match[3])&&assertUsableClassName&&context.getElementsByClassName){push.apply(results,slice.call(context.getElementsByClassName(m),0));return results}}}return select(selector,context,results,seed,xml)}Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){return Sizzle(expr,null,null,[elem]).length>0};function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}}else{for(;node=elem[i];i++){ret+=getText(node)}}return ret};isXML=Sizzle.isXML=function isXML(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};contains=Sizzle.contains=docElem.contains?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&adown.contains&&adown.contains(bup))}:docElem.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){while(b=b.parentNode){if(b===a){return true}}return false};Sizzle.attr=function(elem,name){var attr,xml=isXML(elem);if(!xml){name=name.toLowerCase()}if(Expr.attrHandle[name]){return Expr.attrHandle[name](elem)}if(assertAttributes||xml){return elem.getAttribute(name)}attr=elem.getAttributeNode(name);return attr?typeof elem[name]==="boolean"?elem[name]?name:null:attr.specified?attr.value:null:null};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,order:new RegExp("ID|TAG"+(assertUsableName?"|NAME":"")+(assertUsableClassName?"|CLASS":"")),attrHandle:assertHrefNotNormalized?{}:{href:function(elem){return elem.getAttribute("href",2)},type:function(elem){return elem.getAttribute("type")}},find:{ID:assertGetIdNotName?function(id,context,xml){if(typeof context.getElementById!==strundefined&&!xml){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}}:function(id,context,xml){if(typeof context.getElementById!==strundefined&&!xml){var m=context.getElementById(id);return m?m.id===id||typeof m.getAttributeNode!==strundefined&&m.getAttributeNode("id").value===id?[m]:undefined:[]}},TAG:assertTagNameNoComments?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var results=context.getElementsByTagName(tag);if(tag==="*"){var elem,tmp=[],i=0;for(;elem=results[i];i++){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results},NAME:function(tag,context){if(typeof context.getElementsByName!==strundefined){return context.getElementsByName(name)}},CLASS:function(className,context,xml){if(typeof context.getElementsByClassName!==strundefined&&!xml){return context.getElementsByClassName(className)}}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(rbackslash,"");match[3]=(match[4]||match[5]||"").replace(rbackslash,"");if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0])}match[3]=+(match[3]?match[4]+(match[5]||1):2*(match[2]==="even"||match[2]==="odd"));match[4]=+(match[6]+match[7]||match[2]==="odd")}else if(match[2]){Sizzle.error(match[0])}return match},PSEUDO:function(match,context,xml){var unquoted,excess;if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[3]}else if(unquoted=match[4]){if(rpseudo.test(unquoted)&&(excess=tokenize(unquoted,context,xml,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){unquoted=unquoted.slice(0,excess);match[0]=match[0].slice(0,excess)}match[2]=unquoted}return match.slice(0,3)}},filter:{ID:assertGetIdNotName?function(id){id=id.replace(rbackslash,"");return function(elem){return elem.getAttribute("id")===id}}:function(id){id=id.replace(rbackslash,"");return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===id}},TAG:function(nodeName){if(nodeName==="*"){return function(){return true}}nodeName=nodeName.replace(rbackslash,"").toLowerCase();return function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[expando][className];if(!pattern){pattern=classCache(className,new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))}return function(elem){return pattern.test(elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")}},ATTR:function(name,operator,check){if(!operator){return function(elem){return Sizzle.attr(elem,name)!=null}}return function(elem){var result=Sizzle.attr(elem,name),value=result+"";if(result==null){return operator==="!="}switch(operator){case"=":return value===check;case"!=":return value!==check;case"^=":return check&&value.indexOf(check)===0;case"*=":return check&&value.indexOf(check)>-1;case"$=":return check&&value.substr(value.length-check.length)===check;case"~=":return(" "+value+" ").indexOf(check)>-1;case"|=":return value===check||value.substr(0,check.length+1)===check+"-"}}},CHILD:function(type,argument,first,last){if(type==="nth"){var doneName=done++;return function(elem){var parent,diff,count=0,node=elem;if(first===1&&last===0){return true}parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.sizset)){for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.sizset=++count;if(node===elem){break}}}parent[expando]=doneName}diff=elem.sizset-last;if(first===0){return diff===0}else{return diff%first===0&&diff/first>=0}}}return function(elem){var node=elem;switch(type){case"only":case"first":while(node=node.previousSibling){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while(node=node.nextSibling){if(node.nodeType===1){return false}}return true}}},PSEUDO:function(pseudo,argument,context,xml){var args,fn=Expr.pseudos[pseudo]||Expr.pseudos[pseudo.toLowerCase()];if(!fn){Sizzle.error("unsupported pseudo: "+pseudo)}if(!fn[expando]){if(fn.length>1){args=[pseudo,pseudo,"",argument];return function(elem){return fn(elem,0,args)}}return fn}return fn(argument,context,xml)}},pseudos:{not:markFunction(function(selector,context,xml){var matcher=compile(selector.replace(rtrim,"$1"),context,xml);return function(elem){return!matcher(elem)}}),enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},parent:function(elem){return!Expr.pseudos["empty"](elem)},empty:function(elem){var nodeType;elem=elem.firstChild;while(elem){if(elem.nodeName>"@"||(nodeType=elem.nodeType)===3||nodeType===4){return false}elem=elem.nextSibling}return true},contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),header:function(elem){return rheader.test(elem.nodeName)},text:function(elem){var type,attr;return elem.nodeName.toLowerCase()==="input"&&(type=elem.type)==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===type)},radio:createInputPseudo("radio"),checkbox:createInputPseudo("checkbox"),file:createInputPseudo("file"),password:createInputPseudo("password"),image:createInputPseudo("image"),submit:createButtonPseudo("submit"),reset:createButtonPseudo("reset"),button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},input:function(elem){return rinputs.test(elem.nodeName)},focus:function(elem){var doc=elem.ownerDocument;return elem===doc.activeElement&&(!doc.hasFocus||doc.hasFocus())&&!!(elem.type||elem.href)},active:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elements,argument,not){return not?elements.slice(1):[elements[0]]},last:function(elements,argument,not){var elem=elements.pop();return not?elements:[elem]},even:function(elements,argument,not){var results=[],i=not?1:0,len=elements.length;for(;i<len;i=i+2){results.push(elements[i])}return results},odd:function(elements,argument,not){var results=[],i=not?0:1,len=elements.length;for(;i<len;i=i+2){results.push(elements[i])}return results},lt:function(elements,argument,not){return not?elements.slice(+argument):elements.slice(0,+argument)},gt:function(elements,argument,not){return not?elements.slice(0,+argument+1):elements.slice(+argument+1)},eq:function(elements,argument,not){var elem=elements.splice(+argument,1);return not?elements:elem}}};function siblingCheck(a,b,ret){if(a===b){return ret}var cur=a.nextSibling;while(cur){if(cur===b){return-1}cur=cur.nextSibling}return 1}sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b){hasDuplicate=true;return 0}return(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b)}else if(!aup){return-1}else if(!bup){return 1}while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i])}}return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};[0,0].sort(sortOrder);baseHasDuplicate=!hasDuplicate;Sizzle.uniqueSort=function(results){var elem,i=1;hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(;elem=results[i];i++){if(elem===results[i-1]){results.splice(i--,1)}}}return results};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};function tokenize(selector,context,xml,parseOnly){var matched,match,tokens,type,soFar,groups,group,i,preFilters,filters,checkContext=!xml&&context!==document,key=(checkContext?"<s>":"")+selector.replace(rtrim,"$1<s>"),cached=tokenCache[expando][key];if(cached){return parseOnly?0:slice.call(cached,0)}soFar=selector;groups=[];i=0;preFilters=Expr.preFilter;filters=Expr.filter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length);tokens.selector=group}groups.push(tokens=[]);group="";if(checkContext){soFar=" "+soFar}}matched=false;if(match=rcombinators.exec(soFar)){group+=match[0];soFar=soFar.slice(match[0].length);matched=tokens.push({part:match.pop().replace(rtrim," "),string:match[0],captures:match})}for(type in filters){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match,context,xml)))){group+=match[0];soFar=soFar.slice(match[0].length);matched=tokens.push({part:type,string:match.shift(),captures:match})}}if(!matched){break}}if(group){tokens.selector=group}return parseOnly?soFar.length:soFar?Sizzle.error(selector):slice.call(tokenCache(key,groups),0)}function addCombinator(matcher,combinator,context,xml){var dir=combinator.dir,doneName=done++;if(!matcher){matcher=function(elem){return elem===context}}return combinator.first?function(elem){while(elem=elem[dir]){if(elem.nodeType===1){return matcher(elem)&&elem}}}:xml?function(elem){while(elem=elem[dir]){if(elem.nodeType===1){if(matcher(elem)){return elem}}}}:function(elem){var cache,dirkey=doneName+"."+dirruns,cachedkey=dirkey+"."+cachedruns;while(elem=elem[dir]){if(elem.nodeType===1){if((cache=elem[expando])===cachedkey){return elem.sizset}else if(typeof cache==="string"&&cache.indexOf(dirkey)===0){if(elem.sizset){return elem}}else{elem[expando]=cachedkey;if(matcher(elem)){elem.sizset=true;return elem}elem.sizset=false}}}}}function addMatcher(higher,deeper){return higher?function(elem){var result=deeper(elem);return result&&higher(result===true?elem:result)}:deeper}function matcherFromTokens(tokens,context,xml){var token,matcher,i=0;for(;token=tokens[i];i++){if(Expr.relative[token.part]){matcher=addCombinator(matcher,Expr.relative[token.part],context,xml)}else{matcher=addMatcher(matcher,Expr.filter[token.part].apply(null,token.captures.concat(context,xml)))}}return matcher}function matcherFromGroupMatchers(matchers){return function(elem){var matcher,j=0;for(;matcher=matchers[j];j++){if(matcher(elem)){return true}}return false}}compile=Sizzle.compile=function(selector,context,xml){var group,i,len,cached=compilerCache[expando][selector];if(cached&&cached.context===context){return cached}group=tokenize(selector,context,xml);for(i=0,len=group.length;i<len;i++){group[i]=matcherFromTokens(group[i],context,xml)}cached=compilerCache(selector,matcherFromGroupMatchers(group));cached.context=context;cached.runs=cached.dirruns=0;return cached};function multipleContexts(selector,contexts,results,seed){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results,seed)}}function handlePOSGroup(selector,posfilter,argument,contexts,seed,not){var results,fn=Expr.setFilters[posfilter.toLowerCase()];if(!fn){Sizzle.error(posfilter)}if(selector||!(results=seed)){multipleContexts(selector||"*",contexts,results=[],seed)}return results.length>0?fn(results,argument,not):[]}function handlePOS(groups,context,results,seed){var group,part,j,groupLen,token,selector,anchor,elements,match,matched,lastIndex,currentContexts,not,i=0,len=groups.length,rpos=matchExpr["POS"],rposgroups=new RegExp("^"+rpos.source+"(?!"+whitespace+")","i"),setUndefined=function(){var i=1,len=arguments.length-2;for(;i<len;i++){if(arguments[i]===undefined){match[i]=undefined}}};for(;i<len;i++){group=groups[i];part="";elements=seed;for(j=0,groupLen=group.length;j<groupLen;j++){token=group[j];selector=token.string;
if(token.part==="PSEUDO"){rpos.exec("");anchor=0;while(match=rpos.exec(selector)){matched=true;lastIndex=rpos.lastIndex=match.index+match[0].length;if(lastIndex>anchor){part+=selector.slice(anchor,match.index);anchor=lastIndex;currentContexts=[context];if(rcombinators.test(part)){if(elements){currentContexts=elements}elements=seed}if(not=rendsWithNot.test(part)){part=part.slice(0,-5).replace(rcombinators,"$&*");anchor++}if(match.length>1){match[0].replace(rposgroups,setUndefined)}elements=handlePOSGroup(part,match[1],match[2],currentContexts,elements,not)}part=""}}if(!matched){part+=selector}matched=false}if(part){if(rcombinators.test(part)){multipleContexts(part,elements||[context],results,seed)}else{Sizzle(part,context,results,seed?seed.concat(elements):elements)}}else{push.apply(results,elements)}}return len===1?results:Sizzle.uniqueSort(results)}function select(selector,context,results,seed,xml){selector=selector.replace(rtrim,"$1");var elements,matcher,cached,elem,i,tokens,token,lastToken,findContext,type,match=tokenize(selector,context,xml),contextNodeType=context.nodeType;if(matchExpr["POS"].test(selector)){return handlePOS(match,context,results,seed)}if(seed){elements=slice.call(seed,0)}else if(match.length===1){if((tokens=slice.call(match[0],0)).length>2&&(token=tokens[0]).part==="ID"&&contextNodeType===9&&!xml&&Expr.relative[tokens[1].part]){context=Expr.find["ID"](token.captures[0].replace(rbackslash,""),context,xml)[0];if(!context){return results}selector=selector.slice(tokens.shift().string.length)}findContext=(match=rsibling.exec(tokens[0].string))&&!match.index&&context.parentNode||context;lastToken="";for(i=tokens.length-1;i>=0;i--){token=tokens[i];type=token.part;lastToken=token.string+lastToken;if(Expr.relative[type]){break}if(Expr.order.test(type)){elements=Expr.find[type](token.captures[0].replace(rbackslash,""),findContext,xml);if(elements==null){continue}else{selector=selector.slice(0,selector.length-lastToken.length)+lastToken.replace(matchExpr[type],"");if(!selector){push.apply(results,slice.call(elements,0))}break}}}}if(selector){matcher=compile(selector,context,xml);dirruns=matcher.dirruns++;if(elements==null){elements=Expr.find["TAG"]("*",rsibling.test(selector)&&context.parentNode||context)}for(i=0;elem=elements[i];i++){cachedruns=matcher.runs++;if(matcher(elem)){results.push(elem)}}}return results}if(document.querySelectorAll){(function(){var disconnectedMatch,oldSelect=select,rescape=/'|\\/g,rattributeQuotes=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,rbuggyQSA=[],rbuggyMatches=[":active"],matches=docElem.matchesSelector||docElem.mozMatchesSelector||docElem.webkitMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector;assert(function(div){div.innerHTML="<select><option selected=''></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){div.innerHTML="<p test=''></p>";if(div.querySelectorAll("[test^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:\"\"|'')")}div.innerHTML="<input type='hidden'/>";if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}});rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));select=function(selector,context,results,seed,xml){if(!seed&&!xml&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(context.nodeType===9){try{push.apply(results,slice.call(context.querySelectorAll(selector),0));return results}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var groups,i,len,old=context.getAttribute("id"),nid=old||expando,newContext=rsibling.test(selector)&&context.parentNode||context;if(old){nid=nid.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}groups=tokenize(selector,context,xml);nid="[id='"+nid+"']";for(i=0,len=groups.length;i<len;i++){groups[i]=nid+groups[i].selector}try{push.apply(results,slice.call(newContext.querySelectorAll(groups.join(",")),0));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}return oldSelect(selector,context,results,seed,xml)};if(matches){assert(function(div){disconnectedMatch=matches.call(div,"div");try{matches.call(div,"[test!='']:sizzle");rbuggyMatches.push(matchExpr["PSEUDO"].source,matchExpr["POS"].source,"!=")}catch(e){}});rbuggyMatches=new RegExp(rbuggyMatches.join("|"));Sizzle.matchesSelector=function(elem,expr){expr=expr.replace(rattributeQuotes,"='$1']");if(!isXML(elem)&&!rbuggyMatches.test(expr)&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,null,null,[elem]).length>0}}})()}Expr.setFilters["nth"]=Expr.setFilters["eq"];Expr.filters=Expr.pseudos;Sizzle.attr=jQuery.attr;jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})(window);var runtil=/Until$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,isSimple=/^.[^:#\[\.,]*$/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var i,l,length,n,r,ret,self=this;if(typeof selector!=="string"){return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++){if(jQuery.contains(self[i],this)){return true}}})}ret=this.pushStack("","find",selector);for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0){for(n=length;n<ret.length;n++){for(r=0;r<length;r++){if(ret[r]===ret[n]){ret.splice(n--,1);break}}}}}return ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector)},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return!!selector&&(typeof selector==="string"?rneedsContext.test(selector)?jQuery(selector,this.context).index(this[0])>=0:jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){cur=this[i];while(cur&&cur.ownerDocument&&cur!==context&&cur.nodeType!==11){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}cur=cur.parentNode}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});jQuery.fn.andSelf=jQuery.fn.addBack;function isDisconnected(node){return!node||!node.parentNode||node.parentNode.nodeType===11}function sibling(cur,dir){do{cur=cur[dir]}while(cur&&cur.nodeType!==1);return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(!runtil.test(name)){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if(this.length>1&&rparentsprev.test(name)){ret=ret.reverse()}return this.pushStack(ret,name,core_slice.call(arguments).join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not){expr=":not("+expr+")"}return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep})}else if(qualifier.nodeType){return jQuery.grep(elements,function(elem,i){return elem===qualifier===keep})}else if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier)){return jQuery.filter(qualifier,filtered,!keep)}else{qualifier=jQuery.filter(qualifier,filtered)}}return jQuery.grep(elements,function(elem,i){return jQuery.inArray(elem,qualifier)>=0===keep})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rnocache=/<(?:script|object|embed|option|style)/i,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rcheckableType=/^(?:checkbox|radio)$/,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize){wrapMap._default=[1,"X<div>","</div>"]}jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1||this.nodeType===11){this.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1||this.nodeType===11){this.insertBefore(elem,this.firstChild)}})},before:function(){if(!isDisconnected(this[0])){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)})}if(arguments.length){var set=jQuery.clean(arguments);return this.pushStack(jQuery.merge(set,this),"before",this.selector)}},after:function(){if(!isDisconnected(this[0])){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)})}if(arguments.length){var set=jQuery.clean(arguments);return this.pushStack(jQuery.merge(this,set),"after",this.selector)}},remove:function(selector,keepData){var elem,i=0;for(;(elem=this[i])!=null;i++){if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode){elem.parentNode.removeChild(elem)}}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"))}while(elem.firstChild){elem.removeChild(elem.firstChild)}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(value){if(!isDisconnected(this[0])){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))})}if(typeof value!=="string"){value=jQuery(value).detach()}return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next){jQuery(next).before(value)}else{jQuery(parent).append(value)}})}return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,callback){args=[].concat.apply([],args);var results,first,fragment,iNoClone,i=0,value=args[0],scripts=[],l=this.length;if(!jQuery.support.checkClone&&l>1&&typeof value==="string"&&rchecked.test(value)){return this.each(function(){jQuery(this).domManip(args,table,callback)})}if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)})}if(this[0]){results=jQuery.buildFragment(args,this,scripts);fragment=results.fragment;first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){table=table&&jQuery.nodeName(first,"tr");for(iNoClone=results.cacheable||l-1;i<l;i++){callback.call(table&&jQuery.nodeName(this[i],"table")?findOrAppend(this[i],"tbody"):this[i],i===iNoClone?fragment:jQuery.clone(fragment,true,true))}}fragment=first=null;if(scripts.length){jQuery.each(scripts,function(i,elem){if(elem.src){if(jQuery.ajax){jQuery.ajax({url:elem.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})}else{jQuery.error("no ajax")}}else{jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,""))}if(elem.parentNode){elem.parentNode.removeChild(elem)}})}}return this}});function findOrAppend(elem,tag){return elem.getElementsByTagName(tag)[0]||elem.appendChild(elem.ownerDocument.createElement(tag))}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1){return}if(dest.clearAttributes){dest.clearAttributes()}if(dest.mergeAttributes){dest.mergeAttributes(src)}nodeName=dest.nodeName.toLowerCase();if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML}if(jQuery.support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)){dest.innerHTML=src.innerHTML}}else if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value}}else if(nodeName==="option"){dest.selected=src.defaultSelected}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}else if(nodeName==="script"&&dest.text!==src.text){dest.text=src.text}dest.removeAttribute(jQuery.expando)}jQuery.buildFragment=function(args,context,scripts){var fragment,cacheable,cachehit,first=args[0];context=context||document;context=!context.nodeType&&context[0]||context;context=context.ownerDocument||context;if(args.length===1&&typeof first==="string"&&first.length<512&&context===document&&first.charAt(0)==="<"&&!rnocache.test(first)&&(jQuery.support.checkClone||!rchecked.test(first))&&(jQuery.support.html5Clone||!rnoshimcache.test(first))){cacheable=true;fragment=jQuery.fragments[first];cachehit=fragment!==undefined}if(!fragment){fragment=context.createDocumentFragment();jQuery.clean(args,context,fragment,scripts);if(cacheable){jQuery.fragments[first]=cachehit&&fragment}}return{fragment:fragment,cacheable:cacheable}};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),l=insert.length,parent=this.length===1&&this[0].parentNode;if((parent==null||parent&&parent.nodeType===11&&parent.childNodes.length===1)&&l===1){insert[original](this[0]);return this}else{for(;i<l;i++){elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if(typeof elem.getElementsByTagName!=="undefined"){return elem.getElementsByTagName("*")}else if(typeof elem.querySelectorAll!=="undefined"){return elem.querySelectorAll("*")}else{return[]}}function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var srcElements,destElements,i,clone;if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true)}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild)}if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){if(destElements[i]){cloneFixAttributes(srcElements[i],destElements[i])}}}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneCopyEvent(srcElements[i],destElements[i])}}}srcElements=destElements=null;return clone},clean:function(elems,context,fragment,scripts){var i,j,elem,tag,wrap,depth,div,hasBody,tbody,len,handleScript,jsTags,safe=context===document&&safeFragment,ret=[];if(!context||typeof context.createDocumentFragment==="undefined"){context=document}for(i=0;(elem=elems[i])!=null;i++){if(typeof elem==="number"){elem+=""}if(!elem){continue}if(typeof elem==="string"){if(!rhtml.test(elem)){elem=context.createTextNode(elem)}else{safe=safe||createSafeFragment(context);div=context.createElement("div");safe.appendChild(div);elem=elem.replace(rxhtmlTag,"<$1></$2>");tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;depth=wrap[0];div.innerHTML=wrap[1]+elem+wrap[2];while(depth--){div=div.lastChild}if(!jQuery.support.tbody){hasBody=rtbody.test(elem);tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j){if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length){tbody[j].parentNode.removeChild(tbody[j])}}}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild)}elem=div.childNodes;div.parentNode.removeChild(div)}}if(elem.nodeType){ret.push(elem)}else{jQuery.merge(ret,elem)}}if(div){elem=div=safe=null}if(!jQuery.support.appendChecked){for(i=0;(elem=ret[i])!=null;i++){if(jQuery.nodeName(elem,"input")){fixDefaultChecked(elem)}else if(typeof elem.getElementsByTagName!=="undefined"){jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}}}if(fragment){handleScript=function(elem){if(!elem.type||rscriptType.test(elem.type)){return scripts?scripts.push(elem.parentNode?elem.parentNode.removeChild(elem):elem):fragment.appendChild(elem)}};for(i=0;(elem=ret[i])!=null;i++){if(!(jQuery.nodeName(elem,"script")&&handleScript(elem))){fragment.appendChild(elem);if(typeof elem.getElementsByTagName!=="undefined"){jsTags=jQuery.grep(jQuery.merge([],elem.getElementsByTagName("script")),handleScript);ret.splice.apply(ret,[i+1,0].concat(jsTags));i+=jsTags.length}}}}return ret},cleanData:function(elems,acceptData){var data,id,elem,type,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey]}else if(elem.removeAttribute){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}jQuery.deletedIds.push(id)}}}}}});(function(){var matched,browser;jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else if(browser.webkit){browser.safari=true}jQuery.browser=browser;jQuery.sub=function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context)}return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub}})();var curCSS,iframe,iframeDoc,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([-+])=("+core_pnum+")","i"),elemdisplay={},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"],eventsToggle=jQuery.fn.toggle;function vendorPropName(style,name){if(name in style){return name}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){var elem,display,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=jQuery._data(elem,"olddisplay");if(show){if(!values[index]&&elem.style.display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName))}}else{display=curCSS(elem,"display");if(!values[index]&&display!=="none"){jQuery._data(elem,"olddisplay",display)}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state,fn2){var bool=typeof state==="boolean";if(jQuery.isFunction(state)&&jQuery.isFunction(fn2)){return eventsToggle.apply(this,arguments)}return this.each(function(){if(bool?state:isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,numeric,extra){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(numeric||extra!==undefined){num=parseFloat(val);return numeric||jQuery.isNumeric(num)?num||0:val}return val},swap:function(elem,options,callback){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.call(elem);for(name in options){elem.style[name]=old[name]}return ret}});if(window.getComputedStyle){curCSS=function(elem,name){var ret,width,minWidth,maxWidth,computed=window.getComputedStyle(elem,null),style=elem.style;if(computed){ret=computed[name];if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret}}else if(document.documentElement.currentStyle){curCSS=function(elem,name){var left,rsLeft,ret=elem.currentStyle&&elem.currentStyle[name],style=elem.style;if(ret==null&&style&&style[name]){ret=style[name]}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rsLeft=elem.runtimeStyle&&elem.runtimeStyle.left;if(rsLeft){elem.runtimeStyle.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){elem.runtimeStyle.left=rsLeft}}return ret===""?"auto":ret}}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true)}if(isBorderBox){if(extra==="content"){val-=parseFloat(curCSS(elem,"padding"+cssExpand[i]))||0}if(extra!=="margin"){val-=parseFloat(curCSS(elem,"border"+cssExpand[i]+"Width"))||0}}else{val+=parseFloat(curCSS(elem,"padding"+cssExpand[i]))||0;if(extra!=="padding"){val+=parseFloat(curCSS(elem,"border"+cssExpand[i]+"Width"))||0}}}return val}function getWidthOrHeight(elem,name,extra){var val=name==="width"?elem.offsetWidth:elem.offsetHeight,valueIsBorderBox=true,isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing")==="border-box";if(val<=0||val==null){val=curCSS(elem,name);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox)+"px"}function css_defaultDisplay(nodeName){if(elemdisplay[nodeName]){return elemdisplay[nodeName]}var elem=jQuery("<"+nodeName+">").appendTo(document.body),display=elem.css("display");elem.remove();if(display==="none"||display===""){iframe=document.body.appendChild(iframe||jQuery.extend(document.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write("<!doctype html><html><body>");iframeDoc.close()}elem=iframeDoc.body.appendChild(iframeDoc.createElement(nodeName));display=curCSS(elem,"display");document.body.removeChild(iframe)}elemdisplay[nodeName]=display;
return display}jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){if(elem.offsetWidth===0&&rdisplayswap.test(curCSS(elem,"display"))){return jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)})}else{return getWidthOrHeight(elem,name,extra)}}},set:function(elem,value,extra){return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing")==="border-box"):0)}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter){return}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){return jQuery.swap(elem,{display:"inline-block"},function(){if(computed){return curCSS(elem,"marginRight")}})}}}if(!jQuery.support.pixelPosition&&jQuery.fn.position){jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){if(computed){var ret=curCSS(elem,prop);return rnumnonpx.test(ret)?jQuery(elem).position()[prop]+"px":ret}}}})}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth===0&&elem.offsetHeight===0||!jQuery.support.reliableHiddenOffsets&&(elem.style&&elem.style.display||curCSS(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}}jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i,parts=typeof value==="string"?value.split(" "):[value],expanded={};for(i=0;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rselectTextarea=/^(?:select|textarea)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}var ajaxLocation,ajaxLocParts,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes=["*/"]+["*"];try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,list,placeBefore,dataTypes=dataTypeExpression.toLowerCase().split(core_rspace),i=0,length=dataTypes.length;if(jQuery.isFunction(func)){for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore){dataType=dataType.substr(1)||"*"}list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var selection,list=structure[dataType],i=0,length=list?list.length:0,executeOnly=structure===prefilters;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string"){if(!executeOnly||inspected[selection]){selection=undefined}else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}}if((executeOnly||!selection)&&!inspected["*"]){selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected)}return selection}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}}jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}if(!this.length){return this}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status){if(callback){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}}}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText)});return this};jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.on(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,settings){if(settings){ajaxExtend(target,jQuery.ajaxSettings)}else{settings=target;target=jQuery.ajaxSettings}ajaxExtend(target,settings);return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var ifModifiedKey,responseHeadersString,responseHeaders,transport,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},abort:function(statusText){statusText=statusText||strAbort;if(transport){transport.abort(statusText)}done(0,statusText);return this}};function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}if(status>=200&&status<300||status===304){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[ifModifiedKey]=modified}modified=jqXHR.getResponseHeader("Etag");if(modified){jQuery.etag[ifModifiedKey]=modified}}if(status===304){statusText="notmodified";isSuccess=true}else{isSuccess=ajaxConvert(s,response);statusText=isSuccess.state;success=isSuccess.data;error=isSuccess.error;isSuccess=!error}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.add;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2){for(tmp in map){statusCode[tmp]=[statusCode[tmp],map[tmp]]}}else{tmp=map[jqXHR.status];jqXHR.always(tmp)}}return this};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(core_rspace);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data;delete s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+(ret===s.url?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey])}if(jQuery.etag[ifModifiedKey]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey])}}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}return jqXHR},active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields;for(type in responseFields){if(type in responses){jqXHR[responseFields[type]]=responses[type]}}while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("content-type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response){var conv,conv2,current,tmp,dataTypes=s.dataTypes.slice(),prev=dataTypes[0],converters={},i=0;if(s.dataFilter){response=s.dataFilter(response,s.dataType)}if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}for(;current=dataTypes[++i];){if(current!=="*"){if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.splice(i--,0,current)}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}prev=current}}return{state:"success",data:response}}var oldCallbacks=[],rquestion=/\?/,rjsonp=/(=)\?(?=&|$)|\?\?/,nonce=jQuery.now();jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,data=s.data,url=s.url,hasCallback=s.jsonp!==false,replaceInUrl=hasCallback&&rjsonp.test(url),replaceInData=hasCallback&&!replaceInUrl&&typeof data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(data);if(s.dataTypes[0]==="jsonp"||replaceInUrl||replaceInData){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;overwritten=window[callbackName];if(replaceInUrl){s.url=url.replace(rjsonp,"$1"+callbackName)}else if(replaceInData){s.data=data.replace(rjsonp,"$1"+callbackName)}else if(hasCallback){s.url+=(rquestion.test(url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}script=undefined;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(0,1)}}}}});var xhrCallbacks,xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks){xhrCallbacks[key](0,1)}}:false,xhrId=0;function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&"withCredentials"in xhr})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(_){}xhr.send(s.hasContent&&s.data||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement){responses.xml=xml}try{responses.text=xhr.responseText}catch(_){}try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else if(status===1223){status=204}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async){callback()}else if(xhr.readyState===4){setTimeout(callback,0)}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback){callback(0,1)}}}}})}var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([-+])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var end,unit,prevScale,tween=this.createTween(prop,value),parts=rfxnum.exec(value),target=tween.cur(),start=+target||0,scale=1;if(parts){end=+parts[2];unit=parts[3]||(jQuery.cssNumber[prop]?"":"px");if(unit!=="px"&&start){start=jQuery.css(tween.elem,prop,true)||end||1;do{prevScale=scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit);scale=tween.cur()/target}while(scale!==1&&scale!==prevScale)}tween.unit=unit;tween.start=start;tween.end=parts[1]?start+(parts[1]+1)*end:end}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined},0);return fxNow=jQuery.now()}function createTweens(animation,props){jQuery.each(props,function(prop,value){var collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(collection[index].call(animation,prop,value)){return}}})}function Animation(elem,properties,options){var result,index=0,tweenerIndex=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),percent=1-(remaining/animation.duration||0),index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end,easing){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}createTweens(animation,props);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{anim:animation,queue:animation.opts.queue,elem:elem}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});function defaultPrefilter(elem,props,opts){var index,prop,value,length,dataShow,tween,hooks,oldfire,anim=this,style=elem.style,orig={},handled=[],hidden=elem.nodeType&&isHidden(elem);if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];if(jQuery.css(elem,"display")==="inline"&&jQuery.css(elem,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||css_defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block"}else{style.zoom=1}}}if(opts.overflow){style.overflow="hidden";if(!jQuery.support.shrinkWrapBlocks){anim.done(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}}for(index in props){value=props[index];if(rfxtypes.exec(value)){delete props[index];if(value===(hidden?"hide":"show")){continue}handled.push(index)}}length=handled.length;if(length){dataShow=jQuery._data(elem,"fxshow")||jQuery._data(elem,"fxshow",{});if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;jQuery.removeData(elem,"fxshow",true);for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(index=0;index<length;index++){prop=handled[index];tween=anim.createTween(prop,hidden?dataShow[prop]:0);orig[prop]=dataShow[prop]||jQuery.style(elem,prop);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,false,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"||!i&&jQuery.isFunction(speed)&&jQuery.isFunction(easing)?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty){anim.stop(true)}};return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})}});function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}};jQuery.timers=[];jQuery.fx=Tween.prototype.init;jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}};jQuery.fx.timer=function(timer){if(timer()&&jQuery.timers.push(timer)&&!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.interval=13;jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fx.step={};if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}var rroot=/^(?:body|html)$/i;jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var box,docElem,body,win,clientTop,clientLeft,scrollTop,scrollLeft,top,left,elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return}if((body=doc.body)===elem){return jQuery.offset.bodyOffset(elem)}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return{top:0,left:0}}box=elem.getBoundingClientRect();win=getWindow(doc);clientTop=docElem.clientTop||body.clientTop||0;clientLeft=docElem.clientLeft||body.clientLeft||0;scrollTop=win.pageYOffset||docElem.scrollTop;scrollLeft=win.pageXOffset||docElem.scrollLeft;top=box.top+scrollTop-clientTop;
left=box.left+scrollLeft-clientLeft;return{top:top,left:left}};jQuery.offset={bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;if(jQuery.support.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return}var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent}return offsetParent||document.body})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,value,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return jQuery})}return jQuery}(window)})})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../../node_modules/jquery-browserify/lib/jquery.js","/../../node_modules/jquery-browserify/lib")},{__browserify_process:1,__browserify_buffer:2}],34:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);(function(){var viclib,ref$,slice$=[].slice;viclib=(ref$=function(){return import$(typeof global!="undefined"&&global!==null?global:window,viclib)},ref$.mixin=function(){var i$,fns,constructor;fns=0<(i$=arguments.length-1)?slice$.call(arguments,0,i$):(i$=0,[]),constructor=arguments[i$];return function(self,init){var this$=this;self==null&&(self={});init==null&&(init={});each(function(it){return it(self)},fns);return import$(import$(self,constructor.call(self)),init)}},ref$.install=function(lib){lib==null&&(lib=viclib);return import$(typeof global!="undefined"&&global!==null?global:window,lib)},ref$.log=function(){return console.log.apply(console,arguments)},ref$.iter=curry$(function(list,fn){var key,val,results$=[];for(key in list){val=list[key];results$.push(fn(val,key))}return results$}),ref$.ends_with=curry$(function(str,prefix){return deepEq$(str.slice(-prefix.length),prefix,"===")}),ref$.extend=curry$(function(super_fn,fn){return function(){return fn.call(this,super_fn,arguments)}}),ref$.after=curry$(function(super_fn,fn){return function(){super_fn.apply(this,arguments);return fn.apply(this,arguments)}}),ref$.before=curry$(function(super_fn,fn){return function(){fn.apply(this,arguments);return super_fn.apply(this,arguments)}}),ref$.defer=function(fn){return setTimeout(fn,1)},ref$.make_id=function(next_id){return function(it){if(it.id==null){if(Object.defineProperty!=null){Object.defineProperty(it,"id",{value:next_id++})}else{it.id=next_id++}}return it}}.call(this,0),ref$.remove=function(array,obj){var index;if((index=array.indexOf(obj))!==-1){return array.splice(index,1)}},ref$);module.exports=viclib;viclib();function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}function curry$(f,bound){var context,_curry=function(args){return f.length>1?function(){var params=args?args.concat():[];context=bound?context||this:this;return params.push.apply(params,arguments)<f.length&&arguments.length?_curry.call(context,params):f.apply(context,params)}:f};return _curry()}function deepEq$(x,y,type){var toString={}.toString,hasOwnProperty={}.hasOwnProperty,has=function(obj,key){return hasOwnProperty.call(obj,key)};first=true;return eq(x,y,[]);function eq(a,b,stack){var className,length,size,result,alength,blength,r,key,ref,sizeB;if(a==null||b==null){return a===b}if(a.__placeholder__||b.__placeholder__){return true}if(a===b){return a!==0||1/a==1/b}className=toString.call(a);if(toString.call(b)!=className){return false}switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object"){return false}length=stack.length;while(length--){if(stack[length]==a){return true}}stack.push(a);size=0;result=true;if(className=="[object Array]"){alength=a.length;blength=b.length;if(first){switch(type){case"===":result=alength===blength;break;case"<==":result=alength<=blength;break;case"<<=":result=alength<blength;break}size=alength;first=false}else{result=alength===blength;size=alength}if(result){while(size--){if(!(result=size in a==size in b&&eq(a[size],b[size],stack))){break}}}}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor){return false}for(key in a){if(has(a,key)){size++;if(!(result=has(b,key)&&eq(a[key],b[key],stack))){break}}}if(result){sizeB=0;for(key in b){if(has(b,key)){++sizeB}}if(first){if(type==="<<="){result=size<sizeB}else if(type==="<=="){result=size<=sizeB}else{result=size===sizeB}}else{first=false;result=size===sizeB}}}stack.pop();return result}}}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/../node_modules/viclib.js","/../node_modules")},{"prelude-ls":35,__browserify_process:1,__browserify_buffer:2}],37:[function(require,module,exports){(function(process,Buffer,global,__filename,__dirname){require("prelude-ls").installPrelude(global);require("viclib")();(function(){var btree;module.exports=btree=mixin(function(){var tree,pos_of,bucket,index,projx,projy,ref$,this$=this;tree={};pos_of={};bucket=function(x,y){return{x:floor(x/this$.width),y:floor(y/this$.height)}};index=function(pos){return bucket.x+","+bucket.y};projx=function(x){return floor(x/this$.width)};projy=function(y){return floor(y/this$.height)};return{width:(ref$=this.width)!=null?ref$:100,height:(ref$=this.height)!=null?ref$:100,add:function(it,x,y){var new_bucket_x,new_bucket_y,new_index,it_pos,it_bucket_x,it_bucket_y,it_index,ref$;make_id(it);new_bucket_x=projx(x);new_bucket_y=projy(y);new_index=new_bucket_x+","+new_bucket_y;if((it_pos=pos_of[it.id])!=null){it_bucket_x=projx(it_pos.x);it_bucket_y=projy(it_pos.y);it_index=it_bucket_x+","+it_bucket_y;if(it_index===new_index){it_pos.x=x;it_pos.y=y;return}remove(tree[it_index],it)}tree[new_index]=(ref$=tree[new_index])!=null?ref$:[];tree[new_index].push(it);return pos_of[it.id]={x:x,y:y}},remove:function(it){var it_pos,ref$;it_pos=pos_of[it.id];if(it_pos!=null){remove(tree[projx(it_pos.x)+","+projy(it_pos.y)],it);return ref$=pos_of[it],delete pos_of[it],ref$}},clear:function(){var key,ref$,results$=[];for(key in tree){delete tree[key]}for(key in pos_of){results$.push((ref$=pos_of[key],delete pos_of[key],ref$))}return results$},get:function(xa,ya,xb,yb){var x,X,y,Y,result,i$,to$,i,j$,to1$,j,index,bucket,k$,len$,it,it_pos,ref$;x=xa<xb?xa:xb;X=xa>xb?xa:xb;y=ya<yb?ya:yb;Y=ya>yb?ya:yb;result=[];for(i$=projx(x),to$=projx(X);i$<=to$;++i$){i=i$;for(j$=projy(y),to1$=projy(Y);j$<=to1$;++j$){j=j$;index=i+","+j;if((bucket=tree[index])!=null){for(k$=0,len$=bucket.length;k$<len$;++k$){it=bucket[k$];it_pos=pos_of[it.id];if(x<=(ref$=it_pos.x)&&ref$<X&&y<=(ref$=it_pos.y)&&ref$<Y){result.push(it)}}}}}return result},tree:function(){return tree}}})}).call(this)})(require("__browserify_process"),require("__browserify_buffer").Buffer,window,"/node_modules/quadtree.js","/node_modules")},{viclib:5,"prelude-ls":31,__browserify_process:1,__browserify_buffer:2}]},{},[4]);</script></body></html>
